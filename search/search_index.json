{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"GRLS GWAS Tutorial","text":"<p>Golden retrievers are one of the most popular breeds in the world. However, like many pure-bred dogs, golden retrievers are prone to breed specific and non-breed specific health problems. Previous GWAS studies have uncovered the underlying genetics of several disorders but some studies would benefit from replication. There are also many other research questions waiting to be explored!</p> <p>The Golden Retriever Lifetime Study (GRLS) has a vast amount of phenotypic data collected from veterinarian records and owner questionnaires over the years for 3000+ dogs. In addition, the study has genotyped ~ 1.1 million genetic markers using ThermoFisher's Axiom\u2122 Canine Genotyping Array Sets A and B. This repository provides a tutorial for handling the GRLS phenotypic and genotypic data to produce successful GWAS studies. We are building a growing list of resources to support these studies. </p> <p>Morris Animal Foundation\u2019s Golden Retriever Lifetime Study (GRLS) is a longitudinal, prospective study following 3044 golden retrievers over their lifetimes. The Study\u2019s primary purpose is to identify the nutritional, environmental, lifestyle and genetic risk factors for cancer and other diseases. The study has collected over 10 years' worth of phenotypic data from both veterinarian and owner\u2019 questionnaires, as well as biological samples.  </p> <p>A subproject of the Golden Retriever Lifetime Study was The Golden Oldies study. In this project, an additional cohort of golden retrievers that had reached the age of 12 years or older and had not yet been diagnosed with cancer were recruited to provide DNA samples. We anticipated this population could serve as a control group. Only DNA samples were collected from this group of dogs. Because the purpose of this study was to create an additional sample inventory, there is no phenotypic data from questionnaires available. </p> <p>~1.1 million genetic markers from the entire GRLS cohort and 200 of the Golden Oldie\u2019s participants were genotyped using ThermoFisher's Axiom\u2122 Canine Genotyping Array Sets A and B.  </p> <p></p>"},{"location":"#how-to-access-the-grls-data","title":"How to access the GRLS data?","text":""},{"location":"#21-genotyping-data","title":"2.1. Genotyping data","text":"<p>The GRLS genotyping dataset is publicly available in a PLINK file format. More information about this dataset and how to access it can be found here.</p>"},{"location":"#22-phenotype-data","title":"2.2. Phenotype data","text":"<p>Morris Animal Foundation Data Commons provides open access to a growing collection of data provided by participants in the Golden Retriever Lifetime Study. To download the data, you will need to register for an account.</p> <p></p> <p>Let's start the journey &gt;&gt;&gt;</p>"},{"location":"1.install/","title":"1. Environment Setup","text":""},{"location":"1.install/#11-install-conda","title":"1.1. Install conda","text":"<p>Conda will be used to install the software needed to run this tutorial. Here are the steps used to install conda on a 64-bit computer with a Linux system using Mambaforge. For other operating systems, detailed instructions can be found here.</p> <pre><code>wget https://github.com/conda-forge/miniforge/releases/latest/download/Mambaforge-Linux-x86_64.sh\nbash Mambaforge-Linux-x86_64.sh -b -p \"${HOME}/conda\"\n~/conda/bin/mamba init\nsource ~/.bashrc  # if zsh is being used then do `source ~/.zshrc`\n</code></pre>"},{"location":"1.install/#12-create-a-new-environment-and-install-software-packages","title":"1.2. Create a new environment and install software packages","text":"<p><pre><code>mamba create -n grGWAS\nmamba activate grGWAS\nmamba install -c bioconda plink plink2 bcftools gcta\nmamba install -c conda-forge r-base=4.3.1 r-ggplot2=3.4.2 r-gridextra=2.3 r-qqman=0.1.8\n</code></pre> </p>"},{"location":"2.Input_files/","title":"2. Input Description","text":"<p>Important Note: This page will be updated to include the download commands once the data is publicly available</p>"},{"location":"2.Input_files/#21-genotyping-data","title":"2.1. Genotyping data","text":"<ol> <li> <p>The GRLS genotyping data is available in binary PLINK file format for each of two Axiom array sets A and B. The PLINK documentation has more information about this file format. In this tutorial, the data was downloaded to the working directory where:</p> <ul> <li>The files of array A have the prefix <code>output/setA/export_plink/AxiomGT1.bin</code></li> <li>The files of array B have the prefix <code>output/setB/export_plink/AxiomGT1.bin</code></li> </ul> <p>Note: These PLINK files have the gender as predicted by the Axiom genotyping analysis tools which is not always consistent with the gender in the dog records. Check the genotyping analysis notes for details.</p> </li> <li> <p>There is a text file that maps between sample IDs in the genotyping files, biological sample IDs and the public IDs used in phenotype data files. The file includes gender information of the dogs as reported by their owners: <code>map_id_sex.tab</code>.</p> <p>Here is a sample of the file:</p> Family_ID replicate_id public_id Sex GRLS grlsT459F8JJ_1 grlsT459F8JJ 1 GRLS grls9ZOSMBXX_1 grls9ZOSMBXX 2 GRLS grls9ZOSMBXX_2 grls9ZOSMBXX 2 GRLS grls9ZOSMBXX_3 grls9ZOSMBXX 2 PILOT grls1US5SPBB_1 grls1US5SPBB 1 Oldies grlsa5561a48_1 grlsa5561a48 2 <p>Notes: 1.  There are 3 possible variants of \"Family_ID\": PILOT, a small subset of the longitudinal GRLS population that were used as a proof of concept study. GRLS, the remainder of the GRLS cohort. And Oldies, a cohort of 200 golden retrievers from the Golden Oldies subproject. See the GRLS genotyping data description for details. 2.  One sample (e.g. grls9ZOSMBXX) may have multiple duplicates in the genotyping files (e.g. grls9ZOSMBXX_1, grls9ZOSMBXX_2, grls9ZOSMBXX_3). 3.  Sex is encoded where 1 is male and 2 is female.</p> </li> </ol> <p></p>"},{"location":"2.Input_files/#22-phenotype-data","title":"2.2. Phenotype data","text":"<p>The phenotypic data of the Golden Retriever Lifetime Study is organized in modular data tables, covering 11 key subject areas: activity, behavior, dental, disease diagnoses, diet, environment, grooming, geographical locations, medications, physical exams and reproduction. You can learn more about the detailed description of each data table here</p> <p>In this tutorial, the Conditions - Skin dataset will be used as an example. The phenotype table was downloaded locally as <code>phenotypes/conditions_skin.csv</code>.</p> <p></p>"},{"location":"3.prep_arrays/","title":"3. Prep Array Sets","text":"<p>Genotyping data are provided as 2 datasets for Affymetrix (ThermoFisher) Axiom Canine HD Array sets A and B. Both datasets must be merged into one final dataset, but this requires resolving replicate SNPs, known technical replicates and gender conflicts. Finally, sample IDs in the genotyping files must match those in the phenotype files.</p>"},{"location":"3.prep_arrays/#31-replicate-snps","title":"3.1. Replicate SNPs","text":"<p>Both arrays have a number of replicate SNPs which are useful for QC but also require special attention for proper merging of the files. A QC merging mode of PLINK is used to identify mismatching non-missing calls between the 2 arrays.</p> <pre><code>plink --bfile output/setB/export_plink/AxiomGT1.bin --chr-set 38 no-xy --allow-no-sex --allow-extra-chr \\\n      --bmerge output/setA/export_plink/AxiomGT1.bin --merge-mode 7 \\\n      --output-chr 'chrM' --out AxiomGT1.mismatching7\n</code></pre> <p>Here is the output of this command:</p> <p>3339 samples loaded from output/setB/export_plink/AxiomGT1.bin.fam.   3355 samples to be merged from output/setA/export_plink/AxiomGT1.bin.fam.   Of these, 17 are new, while 3338 are present in the base dataset.   547232 markers loaded from output/setB/export_plink/AxiomGT1.bin.bim.   397685 markers to be merged from output/setA/export_plink/AxiomGT1.bin.bim.   Of these, 368215 are new, while 29470 are present in the base dataset.   Warning: Variants 'Affx-206088448' and 'Affx-205939940' have the same position.   Warning: Variants 'Affx-205859745' and 'Affx-205344060' have the same position.   Warning: Variants 'Affx-206706550' and 'Affx-205359377' have the same position.   1460 more same-position warnings: see log file.   Performing 1-pass diff (mode 7), writing results to AxiomGT1.mismatching7.diff   98370860 overlapping calls, 97897061 non-missing in both filesets.   97593330 concordant, for a concordance rate of 0.996897.  </p> <p>The concordance rate of non-missing genotypes is pretty good (99.7%). However, there are still two issues to handle: </p> <ol> <li> <p>Mismatching genotypes: Use the following code to have a closer look at the mismatching genotypes to see if they are uniformly distributed among the samples or not.     <pre><code>tail -n+2 AxiomGT1.mismatching7.diff | awk '{print $2,$3}' | sort | uniq -c | sort -k1,1nr &gt; AxiomGT1.mismatching7.diff.samples\n</code></pre></p> <p>It seems that two samples show exceptional higher rate of mismatching genotypes: <code>GRLS grlsU85RZ2FF_1</code> and <code>GRLS grlsQZAMFHKK_1</code> have 11676 and 11440 mismatches respectively. The latter sample is the only sample that was predicted to be female on Array A and male on Array B according to the genotyping analysis notes. This likely indicates that these samples had something wrong. Therefore, both samples will be excluded from further analysis during the merging step. </p> </li> <li> <p>Variants having the same position: The mismatching analysis reveals 1463 markers that have the same position on both arrays but with different SNP IDs. Further digging in the array annotation shows that most of these markers are identical with minor differences in the flanking sequences. To avoid genotyping errors, these SNPs will be excluded from array B.</p> <pre><code>grep \"Warning: Variants .* have the same position\" AxiomGT1.mismatching7.log | awk -F\"'\" 'BEGIN{OFS=\"\\n\";}{print $2,$4}' &gt; same_pos.arrB.lst\nplink --bfile output/setB/export_plink/AxiomGT1.bin --chr-set 38 no-xy --allow-no-sex --allow-extra-chr \\\n  --exclude same_pos.arrB.lst \\\n  --make-bed --output-chr 'chrM' --out output/setB/export_plink/AxiomGT1.bin_noSamePos\n</code></pre> </li> </ol>"},{"location":"3.prep_arrays/#32-merging-of-array-sets-a-and-b-genotyping-data","title":"3.2. Merging of array sets A and B genotyping data","text":"<p>Now, the genotyping data of both arrays should be merged. For SNPs shared between the arrays, the genotypes of array A will overwrite the non-missing calls in array B. Also, the 2 samples with higher rates of non-concordance will be excluded.</p> <pre><code>echo \"GRLS grlsU85RZ2FF_1|GRLS grlsQZAMFHKK_1\" | tr '|' '\\n' &gt; hiMismatches_samples.lst\nplink --bfile output/setB/export_plink/AxiomGT1.bin_noSamePos --chr-set 38 no-xy --allow-no-sex --allow-extra-chr \\\n      --bmerge output/setA/export_plink/AxiomGT1.bin --merge-mode 3 \\\n      --remove hiMismatches_samples.lst \\\n      --make-bed --output-chr 'chrM' --out AxiomGT1v2.comp_merge\n</code></pre> <p>The output of the merging command provides some useful statistics:</p> <p>...  Warning: 1355 het. haploid genotypes present (see AxiomGT1v2.comp_merge.hh );  Warning: Nonmissing nonmale Y chromosome genotype(s) present;  ...  Total genotyping rate in remaining samples is 0.994631.  913984 variants and 3354 samples pass filters and QC.  ...</p> <p>The first warning is usually caused by male heterozygous calls in the X chromosome pseudo-autosomal region. Looking at <code>AxiomGT1v2.comp_merge.hh</code> shows that all the 1355 heterozygous haploid genotypes belong to sample <code>GRLS grlsJCVWWRMM_1</code>. According to the genotyping analysis notes, this sample is reported as a male in metadata as well as by the genotyping algorithm on array B, but the algorithm failed to predict its gender on array A. This sample will be handled later during the check for gender accuracy.</p> <p>The second warning indicates that some non-male samples have Y chromosome genotypes. Most PLINK commands treat these genotypes as missing. This behavior is intended for safety, however it makes it tricky to identify these markers. Here is a workaround to find these markers:</p> <p><pre><code>mkdir -p temp_nonmale\ncat AxiomGT1v2.comp_merge.fam | awk '{if($5==\"2\")print}' &gt; temp_nonmale/female.lst\nplink --bfile AxiomGT1v2.comp_merge --chr-set 38 no-xy --allow-no-sex --allow-extra-chr \\\n      --keep temp_nonmale/female.lst --chr y \\\n      --recode --output-chr 'chrM' --out temp_nonmale/AxiomGT1v2.comp_merge.fe\n\n## Stats need to be generated but PLINK treats Y genotypes in females as missing. Fake non-Y positions are usedfor these markers       \nsed -i 's/chrY/chr_notY/' temp_nonmale/AxiomGT1v2.comp_merge.fe.map \n\nplink --file temp_nonmale/AxiomGT1v2.comp_merge.fe --chr-set 38 no-y --allow-no-sex --allow-extra-chr \\\n      --freq counts \\\n      --output-chr 'chrM' --out temp_nonmale/AxiomGT1v2.comp_merge.fe.explore\ntail -n+2 temp_nonmale/AxiomGT1v2.comp_merge.fe.explore.frq.counts | awk '{if($5!=0 || $6!=0)print}' | wc -l\n</code></pre> 37 markers non-missing Y chromosome genotypes in females are identified. These markers could be in the pseudo-autosomal region, but unfortunately there are no known boundaries to those regions in dogs. As mentioned above, it is safe to ignore these markers in PLINK. </p>"},{"location":"3.prep_arrays/#33-identification-and-removal-of-duplicate-samples","title":"3.3. Identification and removal of duplicate samples","text":"<p>Plink2 has an efficient function to calculate the KING-robust kinship estimator and filter duplicate samples as well. Duplicate samples have kinship coefficients ~0.5, first-degree relations (parent-child, full siblings) correspond to ~0.25, second-degree relations correspond to ~0.125, etc. The conventional cutoff of ~0.354 (the geometric mean of 0.5 and 0.25) will be used here to identify and filter duplicate samples.</p> <pre><code>plink2 --bfile AxiomGT1v2.comp_merge --chr-set 38 no-xy --allow-no-sex --allow-extra-chr \\\n       --king-cutoff 0.354 \\\n       --out AxiomGT1v2.comp_merge.nodup\n</code></pre> <p>The log file indicates that the input file has 3354 samples while the output of the deduplication step will end up having 3236 samples. Now, the samples selected to be removed by Plink2 kinship are compared to the list of samples planned to run in duplicates as listed in the input metadata file <code>map_id_sex.tab</code>. </p> <p><pre><code>## This code will identify all the samples planned to run in duplicates in `map_id_sex.tab`.\n## Then find the number of replicates remaining after exclusion of those selected by the Plink2 kinship filter.\n## The expectations is that one replicate will remain from each group of replicate samples.\n\nawk 'BEGIN{FS=OFS=\"\\t\"}FNR==NR{a[$3]+=1;next}/^Family_ID/{print}{if(a[$3]&gt;1)print}' map_id_sex.tab map_id_sex.tab &gt; dup_samples.tab\nawk 'BEGIN{FS=OFS=\"\\t\"}FNR==NR{a[$1 FS $2]=1;next}{if(!a[$1 FS $2])print $0}' AxiomGT1v2.comp_merge.nodup.king.cutoff.out.id dup_samples.tab &gt; dup_samples_remain.tab\ntail -n+2 dup_samples_remain.tab | cut -f3 | sort | uniq -c | sort -k1,1nr\n</code></pre> Hear is a list for the count of remaining replicates per sample:</p> <p>2 \u00a0\u00a0\u00a0 grlsFGFIVFXX    1 \u00a0\u00a0\u00a0 grls1XIBPR44    1 \u00a0\u00a0\u00a0 grls3GG6Z3GG    1 \u00a0\u00a0\u00a0 grls4IH8IF22    .    . </p> <p>It seems that 2 duplicates of sample <code>grlsFGFIVFXX</code> are still remaining! Let's try to calculate their KING kinship to see how similar they are. <pre><code>grep grlsFGFIVFXX dup_samples.tab &gt; failed_deDup.lst\nplink2 --bfile AxiomGT1v2.comp_merge --chr-set 38 no-xy --allow-no-sex --allow-extra-chr \\\n       --keep failed_deDup.lst --make-king-table \\\n       --out AxiomGT1v2.comp_merge.failed_deDup\ncat AxiomGT1v2.comp_merge.failed_deDup.kin0\n</code></pre></p> <p>Here is the output:</p> FID1 ID1 FID2 ID2 NSNP HETHET IBS0 KINSHIP GRLS grlsFGFIVFXX_2 GRLS grlsFGFIVFXX_1 879956 0.0645396 0.0414475 -0.0559478 <p>It is obvious that these two samples are unrelated. Therefore, both of them should be excluded with the duplicate samples identified by the Plink2 kinship filter. There are 120 samples included in this total, so there will end up being 3234 samples in the output PLINK file <pre><code>plink2 --bfile AxiomGT1v2.comp_merge --chr-set 38 no-xy --allow-no-sex --allow-extra-chr \\\n       --remove &lt;(cat AxiomGT1v2.comp_merge.nodup.king.cutoff.out.id failed_deDup.lst) \\\n       --make-bed --output-chr 'chrM' --out AxiomGT1v2.comp_merge.deDup\n</code></pre></p>"},{"location":"3.prep_arrays/#34-check-for-gender-accuracy-remove-samples-with-the-incorrect-gender-identities","title":"3.4. Check for gender accuracy &amp; remove samples with the incorrect gender identities","text":"<p>According to the genotyping analysis notes, there are two samples <code>GRLS grlsQZAMFHKK_1</code> and <code>GRLS grlsJCVWWRMM_1</code> that had discordant computed gender on the two arrays. The former was removed already because of the high rate of mismatching genotypes between the 2 arrays (see 3.1. Replicate SNPs). The latter showed high rate of heterozygous haploid genotypes despite being reported as male in metadata (see 3.2. Merging of array sets). Therefore, this sample should be discarded as well from further analysis.</p> <p>There are an additional 9 samples with concordant gender on both arrays but different from the metadata. This information can be reproduced by comparing known gender in metadata file <code>map_id_sex.tab</code> versus the computed gender based on genotyping data in the PLINK files. <pre><code>echo \"Family_ID Individual_ID computed_sex metadata_sex\" | tr ' ' '\\t' &gt; gender_conflict.lst\nawk 'BEGIN{FS=OFS=\"\\t\"}FNR==NR{a[$1 FS $2]=$4;next}{if(a[$1 FS $2] &amp;&amp; a[$1 FS $2]!=$5)print $1,$2,$5,a[$1 FS $2]}' map_id_sex.tab AxiomGT1v2.comp_merge.deDup.fam &gt;&gt; gender_conflict.lst\n</code></pre></p> <p>Incorrect gender could be a mistake in the metadata or an indication for sample swap. Therefore, it is safer to exclude these samples from the genotyping data. <pre><code>echo \"GRLS grlsJCVWWRMM_1\" | tr ' ' '\\t' &gt;&gt; gender_conflict.lst\nplink2 --bfile AxiomGT1v2.comp_merge.deDup --chr-set 38 no-xy --allow-no-sex --allow-extra-chr \\\n       --remove gender_conflict.lst \\\n       --make-bed --output-chr 'chrM' --out AxiomGT1v2.comp_merge.deDup.sexConfirm\n</code></pre> The output of the last PLINK command indicates that the final file has 3224 samples (1615 females, 1609 males; 3224 founders)</p>"},{"location":"3.prep_arrays/#35-update-sample-ids-in-the-genotyping-files-to-match-the-phenotyping-files","title":"3.5. Update sample IDs in the genotyping files to match the phenotyping files","text":"<p>The sample IDs in the genotyping files have a suffix that identify the duplicates of the same sample. The samples have already been deduplicated in the genotyping files (see 3.3. Removal of duplicate samples). Now the IDs need to be updated to exactly match the public_ids (e.g. grlsH764T844) used in phenotypic data files.</p> <pre><code>tail -n+2 map_id_sex.tab | awk 'BEGIN{FS=OFS=\"\\t\"}{print $1,$2,$1,$3}' &gt; public_ids.update.lst \nplink2 --bfile AxiomGT1v2.comp_merge.deDup.sexConfirm --chr-set 38 no-xy --allow-no-sex --allow-extra-chr \\\n       --update-ids public_ids.update.lst \\\n       --make-bed --output-chr 'chrM' --out AxiomGT1v2.comp_merge.deDup.sexConfirm.public_ids\n</code></pre>"},{"location":"4.qc_filter/","title":"4. QC & filtration","text":"<p>Careful QC of genotyping data is an important step towards a successful GWAS.  Samples and/or variants that do not meet quality expectations need to be excluded.</p> <p>Note: Typically, screening and excluding 1st degree relatives is the first step. However, this step will be postponed until the target cases and controls have been defined.  </p>"},{"location":"4.qc_filter/#41-data-exploration","title":"4.1. Data exploration","text":"<p>Plink commands are used to assess heterozygosity, missing genotyping, allele frequency and Hardy-Weinberg equilibrium (HWE). The output are the files ending in \".het\", \".imiss (Per-individual)/.lmiss (per-variant)\", \".frq\" and \".hwe\".</p> <pre><code>mkdir -p inspect\nplink --bfile AxiomGT1v2.comp_merge.deDup.sexConfirm.public_ids --chr-set 38 no-xy --allow-extra-chr \\\n      --het --missing --freq --hardy 'midp'  \\\n      --output-chr 'chrM' --out inspect/AxiomGT1v2.explore\n\n# There are currently:\n# 913984 variants loaded from .bim file.\n# 3224 samples (1609 males, 1615 females) loaded from .fam.\n</code></pre> <p>Note: The 'midp' modifier of the command <code>--hardy</code> applies the mid-p adjustment described here. The mid-p adjustment tends to bring the null rejection rate in line with the nominal p-value and reduces the filter's tendency to favor retention of variants with missing data.</p>"},{"location":"4.qc_filter/#411-extreme-cases-of-heterozygosity","title":"4.1.1. Extreme cases of heterozygosity","text":"<p>The heterozygosity report of Plink compares the expected and observed number of homozygotes. Column #6 in the report is an estimate for their divergence.</p> <p><pre><code>awk -v size=0.02 'BEGIN{OFS=\"\\t\";bmin=bmax=0}{ b=int($6/size); a[b]++; bmax=b&gt;bmax?b:bmax; bmin=b&lt;bmin?b:bmin } END { for(i=bmin;i&lt;=bmax;++i){if(i==0) print -1*size,size,a[i]/1;else if(i&lt;0) print (i-1)*size,i*size,a[i]/1;else print i*size,(i+1)*size,a[i]/1 }}'  &lt;(tail -n+2 inspect/AxiomGT1v2.explore.het) &gt; inspect/AxiomGT1v2.explore.het.histo \n\ncat inspect/AxiomGT1v2.explore.het | awk '{if($6&gt;0.3)print}' &gt;  inspect/AxiomGT1v2.explore.het.highHomo ## high homozygosity (i.e. low heterozygosity)\n\ncat inspect/AxiomGT1v2.explore.het | awk '{if(NR==1)print}{if($6&lt;-0.3)print}' &gt;  inspect/AxiomGT1v2.explore.het.lowHomo ## low homozygosity\n</code></pre> High heterozygosity may indicate sample contamination, however high homozygosity might just indicate higher inbreeding.</p>"},{"location":"4.qc_filter/#412-markers-with-significant-deviation-from-hwe","title":"4.1.2. Markers with significant deviation from HWE","text":"<p>The Hardy-Weinberg equilibrium report reports the results of an exact test comparing the expected and observed heterozygote frequency of each variant. Column #9 in the report is the Hardy-Weinberg equilibrium exact test p-value.</p> <p><pre><code>awk 'BEGIN{OFS=\"\\t\";}{ if($9&lt;1e-50)a[\"1e-50 or less\"]++;\n                       else if($9&lt;1e-40)a[\"1e-40:1e-50\"]++; else if($9&lt;1e-30)a[\"1e-30:1e-40\"]++; \\\n                       else if($9&lt;1e-20)a[\"1e-20:1e-30\"]++; else if($9&lt;1e-10)a[\"1e-10:1e-20\"]++; \\\n                       else if($9&lt;1e-9)a[\"1e-9:1e-10\"]++; else if($9&lt;1e-8)a[\"1e-8:1e-9\"]++; \\\n                       else if($9&lt;1e-7)a[\"1e-7:1e-8\"]++; else if($9&lt;1e-6)a[\"1e-6:1e-7\"]++; \\\n                       else if($9&lt;1e-5)a[\"1e-5:1e-6\"]++; else if($9&lt;1e-4)a[\"1e-4:1e-5\"]++; \\\n                       else if($9&lt;0.001)a[\"1e-3:1e-4\"]++; else if($9&lt;0.01)a[\"1e-2:1e-3\"]++; } \\\n                 END { for(i in a) print i,a[i] }'  &lt;(tail -n+2 inspect/AxiomGT1v2.explore.hwe) | sort -g &gt; inspect/AxiomGT1v2.explore.hwe.histo\n\n## Use this to further explore variants with extreme deviation from HWE:\ncat inspect/AxiomGT1v2.explore.hwe | awk '{if(NR==1)print}{if($9&lt;1e-50)print}' &gt;  inspect/AxiomGT1v2.explore.hwe.lowHWE\n</code></pre> Serious genotyping errors often yield extreme p-values, therefore a cut-off like 1e-50 is usually advised to exclude these variants.</p>"},{"location":"4.qc_filter/#413-genotype-missingness-in-samples-and-variants","title":"4.1.3. Genotype missingness in samples and variants","text":"<p>There are 2 missingness reports. One with the \".imiss\" extension for samples and another one with the \".lmiss\" extension for variants.  Columns #6 and #5 are the missing call rate in both files respectively.</p> <p><pre><code>awk -v size=0.02 'BEGIN{OFS=\"\\t\";bmin=bmax=0}{ b=int($6/size); a[b]++; bmax=b&gt;bmax?b:bmax; bmin=b&lt;bmin?b:bmin } END { for(i=bmin;i&lt;=bmax;++i) print i*size,(i+1)*size,a[i]/1 }'  &lt;(tail -n+2 inspect/AxiomGT1v2.explore.imiss) &gt; inspect/AxiomGT1v2.explore.imiss.histo \n\nawk -v size=0.02 'BEGIN{OFS=\"\\t\";bmin=bmax=0}{ b=int($5/size); a[b]++; bmax=b&gt;bmax?b:bmax; bmin=b&lt;bmin?b:bmin } END { for(i=bmin;i&lt;=bmax;++i) print i*size,(i+1)*size,a[i]/1 }'  &lt;(tail -n+2 inspect/AxiomGT1v2.explore.lmiss) &gt; inspect/AxiomGT1v2.explore.lmiss.histo \n</code></pre> Missingness per individual shows 17 samples with about ~57% missing genotyping rates. These samples were genotyped on array A only. There is also one sample with ~43% missing genotyping rate. This sample was genotyped on array B only. While missingness per variant shows 36 extreme variants with about 50% genotyping rates.</p>"},{"location":"4.qc_filter/#414-variants-with-very-low-maf","title":"4.1.4. Variants with very low MAF","text":"<p>The allele frequency report calculates the minor allele frequencies (MAF) in column #5. </p> <p><pre><code># Here are 2 different resolutions for a histogram of MAF:\n\nawk -v size=0.01 'BEGIN{OFS=\"\\t\";bmin=bmax=0}{ b=int($5/size); a[b]++; bmax=b&gt;bmax?b:bmax; bmin=b&lt;bmin?b:bmin } END { for(i=bmin;i&lt;=bmax;++i) print i*size,(i+1)*size,a[i]/1 }'  &lt;(tail -n+2 inspect/AxiomGT1v2.explore.frq) &gt; inspect/AxiomGT1v2.explore.frq.histo \n\nawk -v size=0.001 'BEGIN{OFS=\"\\t\";bmin=bmax=0}{ b=int($5/size); a[b]++; bmax=b&gt;bmax?b:bmax; bmin=b&lt;bmin?b:bmin } END { for(i=bmin;i&lt;=bmax;++i) print i*size,(i+1)*size,a[i]/1 }'  &lt;(tail -n+2 inspect/AxiomGT1v2.explore.frq) &gt; inspect/AxiomGT1v2.explore.frq.histo2 \n</code></pre> There are 332720 markers that have &lt; 1% MAF, 315835 markers have &lt; 0.5% MAF and 280430 markers have &lt; 0.1% MAF.</p>"},{"location":"4.qc_filter/#42-filter-low-quality-samples-and-variants","title":"4.2. Filter low quality samples and variants","text":"<p><pre><code>echo \"Oldies grls2ef0ebb4\" &gt; het_excess.lst\ntail -n+2 inspect/AxiomGT1v2.explore.het.lowHomo | awk '{print $1,$2}' &gt; het_excess.lst\nplink --bfile AxiomGT1v2.comp_merge.deDup.sexConfirm.public_ids --chr-set 38 no-xy --allow-extra-chr \\\n      --hwe 1e-50 'midp' --geno 0.05 --mind 0.05 --maf 0.01 \\\n      --remove het_excess.lst\\\n      --make-bed --output-chr 'chrM' --out AxiomGT1v2.filtered\n</code></pre> 913984 variants and 3224 samples loaded. 1 sample removed by (--remove). 18 samples removed due to missing genotype data (--mind). 36 variants removed due to missing genotype data (--geno). 1424 variants removed due to Hardy-Weinberg exact test (--hwe). 332753 variants removed due to minor allele threshold(s).</p> <p>Now, there are 579771 variants and 3205 samples that passed filters and QC.</p>"},{"location":"5.pheno/","title":"5. Study design","text":"<p>The phenotype of interest will define the GWAS design. Some phenotypes are quantitative like body mass index or fasting blood glucose while others are qualitative, binary phenotypes (e.g., Case/Control studies). Each type requires special preparation of the input data, proper selection of the statistical tests and mindful interpretation of the final results. This tutorial is an example for a Case/Control study.  </p> <p>To start, the cases and controls must be selected based on the inclusion and exclusion criteria for the project. Accordingly, a subset of the genotypic and phenotypic data should be established. Then, the possible correlation of the phenotype of interest should assessed with the genetic principal components in the studied population.  The possible covariates that might affect the phenotype of interest must also be identified, but that will be done during the assessment of heritability of the phenotype in the studied population. </p>"},{"location":"5.pheno/#51-explore-phenotypes","title":"5.1. Explore phenotypes","text":""},{"location":"5.pheno/#511-what-is-your-phenotype-of-interest","title":"5.1.1. What is your phenotype of interest?","text":"<p>As explained earlier, the GRLS phenotypic data is organized in modular data tables. Many clinical conditions are organized in tables by the affectd tissue. For example, several cutaneous disorders are grouped in a table named \"conditions_skin.csv\". Let us define our target phenotype and its tissure to start our GWAS <pre><code># Define the target phenotype and the affacted tissue\ntarget=\"atopy\"\ntissue=\"skin\"\n\n# Let us explore how the data table looks like\nless phenotypes/conditions_${tissue}.csv\n</code></pre></p>"},{"location":"5.pheno/#512-identify-affected-cases-until-last-year","title":"5.1.2. Identify affected cases until last year","text":"<p>Most of the input files are designed to have 2 rows for each new year of study. The 1st row records the new phenotypes diagnosed only in that study year while the 2nd row records all phenotypes diagnosed from baseline through that study year. The column <code>to_date</code> is encoded 0 for the former and 1 for the latter. More can be read about the design of each table in the Data Commons of Morris Animal Foundation. For this tutorial, we will identify the cases as the dogs that showed the phenotypes at any year of the study.</p> <pre><code># Define and create the GWAS output folder\ngwas=\"gwas_${target}\" &amp;&amp; mkdir -p \"$gwas\"\n\n# Identify the 2nd row of the last year of study for each dog\ncat phenotypes/conditions_${tissue}.csv | awk 'BEGIN{FS=\",\"}\\\n    NR==1{print $0;next}{if ($5==1) {\\\n    if (!($1 in max_year) || $3 &gt; max_year[$1]) {\n        max_year[$1] = $3;\n        line[$1] = $0;\n    }}}END{for (id in line) {print line[id];}}' | tr ',' '\\t' &gt; \"$gwas\"/conditions_${tissue}_lastYear.tab\n</code></pre>"},{"location":"5.pheno/#513-count-the-of-cases-of-each-phenotype","title":"5.1.3. Count the of cases of each phenotype","text":"<pre><code># Get the number of columns in the header.\nnum_columns=$(head -n 1 \"$gwas/conditions_${tissue}_lastYear.tab\" | awk -F\"\\t\" '{print NF}')\n\n# Loop over each column from the third till the last and print the sum.\nfor ((i=7; i&lt;=$num_columns; i++)); do\n    awk -v col=\"$i\" 'BEGIN{FS=OFS=\"\\t\"}NR==1{dis=$col;next}{sum+=$col} END {print dis,sum}' \"$gwas\"/conditions_${tissue}_lastYear.tab\ndone &gt; \"$gwas\"/conditions_${tissue}.no_of_cases\n</code></pre>"},{"location":"5.pheno/#52-sample-selection","title":"5.2. Sample selection","text":""},{"location":"5.pheno/#521-select-cases-of-a-target-phenotype","title":"5.2.1 Select \"cases\" of a target phenotype","text":"<pre><code>Tcol=$(head -n 1 \"$gwas/conditions_${tissue}_lastYear.tab\" | awk -F\"\\t\" -v pheno=\"$target\" '{for (i=7; i&lt;=NF; i++){if($i==pheno)print i}}')\nawk -v Tcol=\"$Tcol\" 'BEGIN{FS=OFS=\"\\t\"}NR==1{print;next}{if($Tcol==\"1\")print}' \"$gwas\"/conditions_${tissue}_lastYear.tab &gt; \"$gwas\"/conditions_${target}_lastYear.tab\n\ntail -n+2 \"$gwas\"/conditions_${target}_lastYear.tab | cut -f1 &gt; \"$gwas\"/${target}_cases.ids\n</code></pre>"},{"location":"5.pheno/#522-check-for-co-existing-conditions","title":"5.2.2 Check for co-existing conditions","text":"<p><pre><code>for ((i=7; i&lt;=$num_columns; i++)); do\n    awk -v col=\"$i\" 'BEGIN{FS=OFS=\"\\t\"}NR==1{dis=$col;next}{sum+=$col} END {if(sum)print dis,sum}' \"$gwas\"/conditions_${target}_lastYear.tab\ndone &gt; \"$gwas\"/conditions_${target}_lastYear_coexist.tab\n</code></pre> For now, no sample will be excluded from cases.</p>"},{"location":"5.pheno/#523-identify-individuals-to-be-excluded-from-controls","title":"5.2.3. Identify individuals to be excluded from controls","text":"<pre><code>grep 'allergic_reaction\\|seasonal_allergy\\|angioedema\\|facial_edema\\|.*_dermatitis\\|r_o_atopy\\|vaccine_reaction' \"$gwas\"/conditions_${tissue}.no_of_cases &gt; \"$gwas\"/${target}.to_be_excluded.lst\nwhile read offTarget;do\n  offTcol=$(head -n 1 \"$gwas\"/conditions_${tissue}_lastYear.tab | awk -F\"\\t\" -v pheno=\"$offTarget\" '{for (i=7; i&lt;=NF; i++){if($i==pheno)print i}}')\n  awk -F\"\\t\" -v Tcol=\"$Tcol\" -v offTcol=\"$offTcol\" 'NR&gt;1{if($Tcol!=\"1\" &amp;&amp; $offTcol==\"1\")print $1}' \"$gwas\"/conditions_${tissue}_lastYear.tab\ndone &lt; &lt;(cut -f1 \"$gwas\"/${target}.to_be_excluded.lst) | sort | uniq &gt; \"$gwas\"/${target}.to_be_excluded.ids\n</code></pre>"},{"location":"5.pheno/#524-remove-the-excluded-samples-from-the-genotyping-dataset-include-the-oldies-if-not-testing-a-phenotype-with-high-mortality-in-young-age","title":"5.2.4. Remove the excluded samples from the genotyping dataset (include the oldies if not testing a phenotype with high mortality in young age)","text":"<p><pre><code>cat \"$gwas\"/${target}.to_be_excluded.ids | grep -Fwf - AxiomGT1v2.filtered.fam &gt; \"$gwas\"/${target}.to_be_excluded.samples\ngrep ^Oldies AxiomGT1v2.filtered.fam &gt;&gt; \"$gwas\"/${target}.to_be_excluded.samples\n\nplink2 --bfile AxiomGT1v2.filtered --chr-set 38 no-xy --allow-extra-chr \\\n       --remove \"$gwas\"/${target}.to_be_excluded.samples --maf 0.01 \\\n       --make-bed --output-chr 'chrM' --out \"$gwas\"/AxiomGT1v2.filtered.${target}\n</code></pre> There are 578651 variants and 2487 samples that passed filters and QC.</p>"},{"location":"5.pheno/#525-exclusion-of-1st-degree-relatives","title":"5.2.5. Exclusion of 1st degree relatives","text":"<p>Again, the genotyping data will be used to assess sample-distances and thus identify sample duplications. 0.177 (the geometric mean of 0.25 and 0.125) will be used as cutoff for the KING kinship coefficients to identify 1st degree relatives.</p> <p><pre><code># First, identify possible related dogs.\nplink2 --bfile \"$gwas\"/AxiomGT1v2.filtered.${target} --chr-set 38 no-xy --allow-extra-chr \\\n       --king-cutoff 0.177 \\\n       --out \"$gwas\"/AxiomGT1v2.filtered.${target}.1st_degree_relatives\n\n# Now, those relatives can be removed to avoid inflation of false associations in the GWAS.\nplink2 --bfile \"$gwas\"/AxiomGT1v2.filtered.${target} --chr-set 38 no-xy --allow-extra-chr \\\n       --remove \"$gwas\"/AxiomGT1v2.filtered.${target}.1st_degree_relatives.king.cutoff.out.id \\\n       --make-bed --output-chr 'chrM' --out \"$gwas\"/AxiomGT1v2.filtered.${target}.noRelatives\n</code></pre> There are 578651 variants and 1989 samples (980 females, 1009 males) that passed filters and QC.</p>"},{"location":"5.pheno/#53-generate-the-phenotype-file","title":"5.3. Generate the phenotype file","text":"<p><pre><code>awk 'FNR==NR{a[$1]=1;next}{if(!a[$2])print $1,$2,\"1\";else print $1,$2,\"2\";}' \"$gwas\"/${target}_cases.ids \"$gwas\"/AxiomGT1v2.filtered.${target}.noRelatives.fam &gt; \"$gwas\"/${target}.pheno\ncat \"$gwas\"/${target}.pheno | cut -d\" \" -f3 | sort | uniq -c\n</code></pre> There are 317 cases and 1672 controls.</p>"},{"location":"5.pheno/#54-linkage-disequilibrium-ld-analysis","title":"5.4. Linkage disequilibrium (LD) analysis","text":""},{"location":"5.pheno/#541-ld-estimation","title":"5.4.1 LD estimation","text":"<ul> <li>--r2 reports squared inter-variant allele count correlations.</li> <li>--ld-window-r2    variant pairs with r2 values &lt; 0.2 are filtered out by default. This option is used to adjust this threshold.</li> </ul> <pre><code>plink --bfile \"$gwas\"/AxiomGT1v2.filtered.${target}.noRelatives --chr-set 38 no-xy --allow-extra-chr \\\n      --r2 --ld-window-r2 0 --ld-window-kb 10000 --ld-window 100 \\\n      --output-chr 'chrM' --out \"$gwas\"/AxiomGT1v2.filtered.${target}.noRelatives.stats\n</code></pre> <p>Generate a histogram of r2. <pre><code>awk -v size=0.01 'BEGIN{OFS=\"\\t\";bmin=bmax=0}{ b=int($7/size); a[b]++; bmax=b&gt;bmax?b:bmax; bmin=b&lt;bmin?b:bmin } END { for(i=bmin;i&lt;=bmax;++i) print i*size,(i+1)*size,a[i]/1 }'  &lt;(tail -n+2 \"$gwas\"/AxiomGT1v2.filtered.${target}.noRelatives.stats.ld) &gt; \"$gwas\"/AxiomGT1v2.filtered.${target}.noRelatives.stats.ld.r2_histo ## 155780 sequential markers have complete linkage\n</code></pre></p> <p>Create an LD Decay Plot. <pre><code>cat \"$gwas\"/AxiomGT1v2.filtered.${target}.noRelatives.stats.ld | awk '/NR==1/{print;next}{x=$5-$2;if(x&lt;100000)print}' &gt; \"$gwas\"/AxiomGT1v2.filtered.${target}.noRelatives.stats.ld2\n\nRscript -e 'args=(commandArgs(TRUE));require(ggplot2);'\\\n'ld_data &lt;- read.table(paste(args[1],\"/AxiomGT1v2.filtered.\",args[2],\".noRelatives.stats.ld2\",sep=\"\"), header = TRUE);'\\\n'ld_data$Distance &lt;- abs(ld_data$BP_B - ld_data$BP_A);'\\\n'average_r2 &lt;- aggregate(R2 ~ Distance, data = ld_data, mean);'\\\n'jpeg(file = paste(args[1],\"/LD_Decay.\",args[2],\".jpg\",sep=\"\"));'\\\n'ggplot(average_r2, aes(x = Distance, y = R2)) + geom_line() + theme_minimal() + labs(x = \"Distance (bp)\", y = \"r2\");'\\\n'dev.off();' \"$gwas\" \"${target}\"\n</code></pre></p>"},{"location":"5.pheno/#542-ld-pruning","title":"5.4.2 LD pruning","text":"<p>For this tutorial, we will prune pairwise SNPs with R2 &gt;\u2009 0.8 (using windows of 100kb and step size of 1 SNP)</p> <pre><code>plink2 --bfile \"$gwas\"/AxiomGT1v2.filtered.${target}.noRelatives --chr-set 38 no-xy --allow-extra-chr \\\n       --indep-pairwise 100kb 0.8 \\\n       --output-chr 'chrM' --out \"$gwas\"/AxiomGT1v2.filtered.${target}.noRelatives.LD_lst ## 397962 of 578651 variants removed\n\nplink2 --bfile \"$gwas\"/AxiomGT1v2.filtered.${target}.noRelatives --chr-set 38 no-xy --allow-extra-chr \\\n       --extract \"$gwas\"/AxiomGT1v2.filtered.${target}.noRelatives.LD_lst.prune.in \\\n       --make-bed --output-chr 'chrM' --out \"$gwas\"/AxiomGT1v2.filtered.${target}.noRelatives.LD_prune ## 180689 variants remaining\n</code></pre>"},{"location":"5.pheno/#543-ld-re-evaluation","title":"5.4.3 LD re-evaluation","text":"<pre><code>plink --bfile \"$gwas\"/AxiomGT1v2.filtered.${target}.noRelatives.LD_prune --chr-set 38 no-xy --allow-extra-chr \\\n      --r2 --ld-window-r2 0 --ld-window-kb 10000 --ld-window 100 \\\n      --output-chr 'chrM' --out \"$gwas\"/AxiomGT1v2.filtered.${target}.noRelatives.LD_prune.stats\n\n\n# New histogram.\nawk -v size=0.01 'BEGIN{OFS=\"\\t\";bmin=bmax=0}{ b=int($7/size); a[b]++; bmax=b&gt;bmax?b:bmax; bmin=b&lt;bmin?b:bmin } END { for(i=bmin;i&lt;=bmax;++i) print i*size,(i+1)*size,a[i]/1 }'  &lt;(tail -n+2 \"$gwas\"/AxiomGT1v2.filtered.${target}.noRelatives.LD_prune.stats.ld) &gt; \"$gwas\"/AxiomGT1v2.filtered.${target}.noRelatives.LD_prune.stats.ld.r2_histo\n\n# Compare the change.\npaste \"$gwas\"/AxiomGT1v2.filtered.${target}.noRelatives.stats.ld.r2_histo \"$gwas\"/AxiomGT1v2.filtered.${target}.noRelatives.LD_prune.stats.ld.r2_histo | less\n</code></pre> <p>How does the LD Decay Plot look? <pre><code>cat \"$gwas\"/AxiomGT1v2.filtered.${target}.noRelatives.LD_prune.stats.ld | awk '/NR==1/{print;next}{x=$5-$2;if(x&lt;100000)print}' &gt; \"$gwas\"/AxiomGT1v2.filtered.${target}.noRelatives.LD_prune.stats.ld2\n\nRscript -e 'args=(commandArgs(TRUE));require(ggplot2);'\\\n'ld_data &lt;- read.table(paste(args[1],\"/AxiomGT1v2.filtered.\",args[2],\".noRelatives.LD_prune.stats.ld2\",sep=\"\"), header = TRUE);'\\\n'ld_data$Distance &lt;- abs(ld_data$BP_B - ld_data$BP_A);'\\\n'average_r2 &lt;- aggregate(R2 ~ Distance, data = ld_data, mean);'\\\n'jpeg(file = paste(args[1],\"/LD_Decay_after_prune.\",args[2],\".jpg\",sep=\"\"));'\\\n'ggplot(average_r2, aes(x = Distance, y = R2)) + geom_line() + theme_minimal() + labs(x = \"Distance (bp)\", y = \"r2\");'\\\n'dev.off();' \"$gwas\" \"${target}\"\n</code></pre></p>"},{"location":"5.pheno/#55-pca-to-identify-population-admixture-and-to-assess-distribution-of-cases","title":"5.5. PCA to identify population admixture and to assess distribution of cases","text":""},{"location":"5.pheno/#551-calculation-of-pca","title":"5.5.1. Calculation of PCA","text":"<p>The <code>--pca</code> function in Plink2 extracts top principal components from the variance-standardized relationship matrix (i.e. genomic relationship matrix). LD pruning is adviced before PCA to reduce the risk of getting PCs based on just a few genomic regions. This behaviour tends to prevent deflation of statistical testing results later.</p> <pre><code>plink2 --bfile \"$gwas\"/AxiomGT1v2.filtered.${target}.noRelatives.LD_prune --chr-set 38 no-xy --allow-extra-chr \\\n       --autosome --pca \\\n       --output-chr 'chrM' --out \"$gwas\"/AxiomGT1v2.filtered.${target}.noRelatives.LD_prune.pca\n</code></pre> <p>The variance can be plotted to identify the principal components that explain most of the variance. <pre><code>Rscript -e 'args=(commandArgs(TRUE));'\\\n'val &lt;- read.table(paste(args[1],\"/AxiomGT1v2.filtered.\",args[2],\".noRelatives.LD_prune.pca.eigenval\",sep=\"\"));'\\\n'val$varPerc &lt;- val$V1/sum(val$V1);'\\\n'jpeg(file = paste(args[1],\"/Var_PCs.jpg\",sep=\"\"));'\\\n'plot( x = seq(1:length(val$varPerc)), y = val$varPerc, type = \"o\",xlab = \"principal Component\", ylab = \"Variance explained in %\");'\\\n'dev.off();' \"$gwas\" \"${target}\"\n</code></pre></p> <p></p>"},{"location":"5.pheno/#552-assess-possible-batch-effect","title":"5.5.2. Assess possible batch effect","text":"<p>Plot the main principal components and color by the study batches: <pre><code>Rscript -e 'args=(commandArgs(TRUE));require(ggplot2);require(gridExtra);'\\\n'eigenvec &lt;- read.table(paste(args[1],\"/AxiomGT1v2.filtered.\",args[2],\".noRelatives.LD_prune.pca.eigenvec\",sep=\"\"), header = TRUE, comment.char=\"\");'\\\n'eigenvec$X.FID &lt;-  as.factor(eigenvec$X.FID);'\\\n'plot1 &lt;- ggplot(eigenvec, aes(x = PC1, y = PC2, col = X.FID)) + geom_point() + labs(title = \"PCA Plot\", x = \"PC1\", y = \"PC2\");'\\\n'plot2 &lt;- ggplot(eigenvec, aes(x = PC3, y = PC4, col = X.FID)) + geom_point() + labs(title = \"PCA Plot\", x = \"PC3\", y = \"PC4\");'\\\n'plot3 &lt;- ggplot(eigenvec, aes(x = PC1, y = PC3, col = X.FID)) + geom_point() + labs(title = \"PCA Plot\", x = \"PC1\", y = \"PC3\");'\\\n'plot4 &lt;- ggplot(eigenvec, aes(x = PC2, y = PC3, col = X.FID)) + geom_point() + labs(title = \"PCA Plot\", x = \"PC2\", y = \"PC3\");'\\\n'combined_plot &lt;- grid.arrange(plot1, plot2, plot3, plot4, nrow = 2);'\\\n'ggsave(paste(args[1],\"/pca_plot.png\",sep=\"\"), combined_plot, width = 12, height = 8, dpi = 400);' \"$gwas\" \"${target}\"\n</code></pre></p> <p></p> <p>An additional tutorial of possible admixture analysis is here.</p>"},{"location":"5.pheno/#553-assess-distribution-of-cases-in-pca","title":"5.5.3 Assess distribution of cases in PCA","text":"<pre><code>Rscript -e 'args=(commandArgs(TRUE));require(ggplot2);require(gridExtra);'\\\n'eigenvec &lt;- read.table(paste(args[1],\"/AxiomGT1v2.filtered.\",args[2],\".noRelatives.LD_prune.pca.eigenvec\",sep=\"\"), header = TRUE, comment.char=\"\");'\\\n'pheno &lt;- read.table(paste(args[1],\"/\",args[2],\".pheno\",sep=\"\"), header = FALSE, comment.char=\"\");'\\\n'names(pheno) &lt;- c(\"FID\", \"IID\", \"pheno\");'\\\n'pheno$pheno[pheno$pheno == \"1\"] &lt;- \"Unaffected\";pheno$pheno[pheno$pheno == \"2\"] &lt;- \"Affected\";'\\\n'ph_eigenvec &lt;-  merge(pheno, eigenvec, by = \"IID\");'\\\n'ph_eigenvec$pheno &lt;-  as.factor(ph_eigenvec$pheno);'\\\n'plot1 &lt;- ggplot(ph_eigenvec, aes(x = PC1, y = PC2, col = pheno)) + geom_point() + labs(title = \"PCA Plot\", x = \"PC1\", y = \"PC2\");'\\\n'plot2 &lt;- ggplot(ph_eigenvec, aes(x = PC3, y = PC4, col = pheno)) + geom_point() + labs(title = \"PCA Plot\", x = \"PC3\", y = \"PC4\");'\\\n'plot3 &lt;- ggplot(ph_eigenvec, aes(x = PC1, y = PC3, col = pheno)) + geom_point() + labs(title = \"PCA Plot\", x = \"PC1\", y = \"PC3\");'\\\n'plot4 &lt;- ggplot(ph_eigenvec, aes(x = PC2, y = PC3, col = pheno)) + geom_point() + labs(title = \"PCA Plot\", x = \"PC2\", y = \"PC3\");'\\\n'combined_plot &lt;- grid.arrange(plot1, plot2, plot3, plot4, nrow = 2);'\\\n'ggsave(paste(args[1],\"/pca_plot_\",args[2],\".png\",sep=\"\"), combined_plot, width = 12, height = 8, dpi = 400);' \"$gwas\" \"${target}\"\n</code></pre>"},{"location":"6.heritability/","title":"6. Heritability","text":"<p>It is meaningless to perform a genomic association study with a phenotype unless it is heritable. Preceding studies are needed to determine heritability estimates for especially complex traits; however, this is out of scope for this tutorial. By heritability assessment, this means estimating the proportion of variance in the phenotype explained by the genotyped SNPs. Later, it should be calculated how much of this heritability was captured by the selected markers.   </p> <p>GCTA software will be used to perform the GREML analysis for heritability assessment.</p> <p>The <code>--reml</code> command of GCTA estimates the proportion of phenotypic variance that can be explained by SNPs. Here is a more detailed explanation of the [GREML method (https://morrisanimalfoundation.github.io/grGWAS/ext_docs/GREML_analysis/) and the underlying linear mixed model. </p> <p>In brief, GREML utilizes the genetic relationships between individuals in a sample population, captured in a genomic relationship matrix (GRM), to partition the phenotypic variance into its genetic and residual components. By fitting a linear mixed model, GREML estimates the proportion of variance attributable to all SNPs.</p> <p>The summary result of REML analysis will be saved in a plain text file (*.hsq).</p>"},{"location":"6.heritability/#61-gcta-grm","title":"6.1. GCTA-GRM","text":"<ul> <li>This command calculates the genetic relationship matrix (GRM) from all the autosomal SNPs.</li> <li>GCTA receives PLINK binary PED files as input. However, the Plink files have to be tweaked to update the chromosome names into a numerical format and remove all extra chromosomes.  </li> </ul> <pre><code>## a) Prepare the Plink input files\ngcta=\"gcta_${target}\" &amp;&amp; mkdir -p \"$gcta\"\nplink2 --bfile $gwas/AxiomGT1v2.filtered.${target}.noRelatives.LD_prune --chr-set 38 no-xy --allow-extra-chr '0' \\\n      --make-bed --out $gcta/AxiomGT1v2.filtered.${target}.noRelatives.LD_prune.gcta\n\n## b) Run the GCTA-GRM command\ngcta64 --bfile $gcta/AxiomGT1v2.filtered.${target}.noRelatives.LD_prune.gcta --autosome-num 38 --autosome --make-grm \\\n       --out $gcta/AxiomGT1v2.filtered.${target}.noRelatives.LD_prune.gcta_grm --thread-num 10\n</code></pre>"},{"location":"6.heritability/#62-input-phenotype-data","title":"6.2. Input phenotype data","text":"<p>The input phenotype file is a plain text file similar to that of Plink. If the phenotypic value is coded as 0 or 1 (or 1 and 2, compatible with PLINK), then it will be recognized as a case-control study (0 for controls and 1 for cases). Missing value should be represented by \"-9\" or \"NA\". </p> <p>For this tutorial, the file <code>$gwas/atopy.pheno</code> that has 318 cases and 1664 controls will be used</p>"},{"location":"6.heritability/#63-covariates","title":"6.3. Covariates","text":"<p>The data can be adjusted for quantitative and discrete covariates. Previous PCA analysis showed that three principal components explain most of the variance and none of them segregates with the phenotype of interest. Therefore, the GREML analysis for these 3 eigenvectors will be adjusted. Adjustments must also be made for possible gender effect.</p> <p>This information has already been obtained, but it needs to be reformatted to match the GCTA expectations.</p> <pre><code>tail -n+2 $gwas/AxiomGT1v2.filtered.${target}.noRelatives.LD_prune.pca.eigenvec | cut -f1-5 &gt; $gwas/3PCs.txt\ncat $gcta/AxiomGT1v2.filtered.${target}.noRelatives.LD_prune.gcta.fam | awk '{print $1,$2,$5}' &gt; $gwas/gender.txt\n</code></pre>"},{"location":"6.heritability/#64-breeding-value","title":"6.4. Breeding value","text":"<p>A breeding value is an estimate of an animal's genetic merit for a particular trait. The additional command <code>--reml-pred-rand</code> predicts the total genetic effect (i.e. breeding value) of each individual attributed by the aggregative effect of the SNPs used to estimate the GRM. The total genetic effects of all the individuals will be saved in a plain ext file *.indi.blp.</p>"},{"location":"6.heritability/#65-run-gcta-greml","title":"6.5. Run GCTA-GREML","text":"<p>Now that all the required pieces have been obtained, it's time to run the analysis.</p> <p>Note: It is not required to have exactly the same individuals in these files. GCTA will find the individuals in common in the files and sort the order of the individuals.</p> <pre><code>gcta64 --reml --grm $gcta/AxiomGT1v2.filtered.${target}.noRelatives.LD_prune.gcta_grm \\\n       --pheno $gwas/${target}.pheno \\\n       --qcovar $gwas/3PCs.txt --covar $gwas/gender.txt \\\n       --reml-pred-rand \\\n       --out $gwas/${target}_greml --thread-num 10\n</code></pre> <p>Here is the output:</p> <pre><code>...\n\nAccepted options:\n--reml\n--grm gcta_atopy/AxiomGT1v2.filtered.atopy.noRelatives.LD_prune.gcta_grm\n--pheno gwas_atopy/atopy.pheno\n--qcovar gwas_atopy/3PCs.txt\n--covar gender.txt\n--reml-pred-rand\n--out gwas_atopy/atopy_greml\n--thread-num 10\n\nNote: the program will be running on 10 threads.\n\nReading IDs of the GRM from [gcta/AxiomGT1v2.filtered.atopy.noRelatives.LD_prune.gcta_grm.grm.id].\n1989 IDs are read from [gcta/AxiomGT1v2.filtered.atopy.noRelatives.LD_prune.gcta_grm.grm.id].\nReading the GRM from [gcta/AxiomGT1v2.filtered.atopy.noRelatives.LD_prune.gcta_grm.grm.bin].\nGRM for 1989 individuals are included from [gcta/AxiomGT1v2.filtered.atopy.noRelatives.LD_prune.gcta_grm.grm.bin].\nReading phenotypes from [gwas_atopy/atopy.pheno].\nNon-missing phenotypes of 1989 individuals are included from [gwas_atopy/atopy.pheno].\nReading quantitative covariate(s) from [gwas_atopy/3PCs.txt].\n3 quantitative covariate(s) of 1989 individuals are included from [gwas_atopy/3PCs.txt].\nReading discrete covariate(s) from [gwas_atopy/gender.txt].\n1 discrete covariate(s) of 1989 individuals are included from [gwas_atopy/gender.txt].\nAssuming a disease phenotype for a case-control study: 317 cases and 1672 controls \nNote: disease prevalence can be specified by the option --prevalence so that GCTA can transform the variance explained to the underlying liability scale.\n3 quantitative variable(s) included as covariate(s).\n1 discrete variable(s) included as covariate(s).\n1989 individuals are in common in these files.\n\nPerforming  REML analysis ... (Note: may take hours depending on sample size).\n1989 observations, 5 fixed effect(s), and 2 variance component(s)(including residual variance).\nCalculating prior values of variance components by EM-REML ...\nUpdated prior values: 0.0671216 0.0786665\nlogL: 927.007\nRunning AI-REML algorithm ...\nIter.   logL    V(G)    V(e)\n1       948.09  0.04286 0.09394\n2       974.49  0.02871 0.10482\n3       986.91  0.02029 0.11235\n4       992.52  0.01516 0.11746\n5       995.02  0.01198 0.12090\n6       996.11  0.00996 0.12321\n7       996.60  0.00867 0.12475\n8       996.81  0.00602 0.12801\n9       996.98  0.00624 0.12786\n10      996.98  0.00623 0.12787\n11      996.98  0.00623 0.12787\nLog-likelihood ratio converged.\n\nCalculating the logLikelihood for the reduced model ...\n(variance component 1 is dropped from the model)\nCalculating prior values of variance components by EM-REML ...\nUpdated prior values: 0.13387\nlogL: 995.87451\nRunning AI-REML algorithm ...\nIter.   logL    V(e)\n1       995.88  0.13387\n2       995.88  0.13387\nLog-likelihood ratio converged.\n\nSummary result of REML analysis:\nSource  Variance        SE\nV(G)    0.006227        0.004659\nV(e)    0.127868        0.005905\nVp      0.134095        0.004273\nV(G)/Vp 0.046439        0.034585\n\nSampling variance/covariance of the estimates of variance components:\n2.170601e-05    -1.915605e-05\n-1.915605e-05   3.486728e-05\n\nSummary result of REML analysis has been saved in the file [gwas_atopy/atopy_greml.hsq].\n\nBLUP solutions of the genetic effects for 1989 individuals have been saved in the file [gwas_atopy/atopy_greml.indi.blp].\n</code></pre>"},{"location":"6.heritability/#66-interpretation-of-results","title":"6.6. Interpretation of results","text":"<p>a) <code>$gwas/atopy_greml.hsq</code>: The output file of the <code>--reml</code> command.  </p> <ul> <li>V(G), V(e) and Vp for genetic variance, residual variance, and phenotypic variance respectively.     Note that Vp =  V(G) + V(e)</li> <li>V(G)/Vp represents the proportion of phenotypic variance explained by SNPs. The results here indicate that SNPs can explain ~4.6% only of the phenotypic variance.</li> <li>The standard error (SE) is important to judge the reliability of the results. A 95% confidence interval (CI) is approximately h2-SNP estimate +/- 1.96 * SE. If the SE is too large, the 95% CI will cover the whole parameter space (from 0 to 1) so that it won't be possible to make any meaningful inferences from the estimate. Therefore, a value of SE &lt; 0.1 is needed to have reliable results.</li> <li>logL is the log likelihood for the full model (the null hypothesis that \u03c3<sup>2</sup><sub>g</sub> \u2260 0). </li> <li>logL0 is the log likelihood for the reduced model (the null hypothesis that \u03c3<sup>2</sup><sub>g</sub> = 0). </li> <li>LRT is the log-likelihood ratio test statistic. It is calculated as twice the difference in log-likelihood between the full (h<sup>2</sup> \u2260 0) and reduced (h<sup>2</sup> = 0) models. i.e. LRT = 2[logL - logL0].</li> <li>Degree of freedom (df), p-value, and sample size.  For more information about the full and reduced models and the interpretation of log likelihoods and LRT, check here.</li> </ul> <p>b) <code>$gwas/atopy_greml.indi.blp</code>:  The output file of the <code>--reml-pred-rand</code> command. </p> <ul> <li>Columns are family ID, individual ID, an intermediate variable, the total genetic effect, another intermediate variable and the residual effect.</li> </ul> <pre><code># Histogram of the genetic effect.\nawk -v size=0.02 'BEGIN{OFS=\"\\t\";bmin=bmax=0}{ b=int($4/size); a[b]++; bmax=b&gt;bmax?b:bmax; bmin=b&lt;bmin?b:bmin } END { for(i=bmin;i&lt;=bmax;++i){if(i==0) print -1*size,size,a[i]/1;else if(i&lt;0) print (i-1)*size,i*size,a[i]/1;else print i*size,(i+1)*size,a[i]/1 }}' $gwas/${target}_greml.indi.blp &gt; $gwas/${target}_greml.indi.blp_gen_histo\n\n# Histogram of the residual effect.\nawk -v size=0.02 'BEGIN{OFS=\"\\t\";bmin=bmax=0}{ b=int($6/size); a[b]++; bmax=b&gt;bmax?b:bmax; bmin=b&lt;bmin?b:bmin } END { for(i=bmin;i&lt;=bmax;++i){if(i==0) print -1*size,size,a[i]/1;else if(i&lt;0) print (i-1)*size,i*size,a[i]/1;else print i*size,(i+1)*size,a[i]/1 }}' $gwas/${target}_greml.indi.blp &gt; $gwas/${target}_greml.indi.blp_res_histo\n\n# Annotate the report by the phenotype.\nawk 'BEGIN{OFS=\"\\t\"}NR==FNR{a[$2]=$3;next}{print $2,$4,$6,a[$2]}' $gwas/atopy.pheno $gwas/${target}_greml.indi.blp | sort -k2,2g &gt; $gwas/${target}_greml.indi.blp.pheno\n</code></pre> <p> </p> <p>Note:  GCTA has additional valuable options e.g. <code>--gxe</code> to estimate the variance of genotype-environment (GE) interaction and <code>--prevalence</code> to transform the estimate of variance explained, V(1)/Vp, on the observed scale to that on the underlying scale, V(1)/Vp_L. Check GCTA's documentation for details. </p> <p> </p>"},{"location":"7.gwas/","title":"7. GWAS Analysis","text":"<p>2 different software packages will be used to perform the GWAS analysis. Each one uses a different statistical approach to adjust for population stratification. The genomic control \u03bb will be used to assess the efficiency of each. </p>"},{"location":"7.gwas/#71-gwas-by-plink","title":"7.1.  GWAS by Plink","text":""},{"location":"7.gwas/#711-logistic-regression-model","title":"7.1.1.  Logistic regression model","text":"<p>PLINK 2.0 has the new <code>--glm</code> command for association analysis (instead of  <code>--linear</code> and <code>--logistic</code> in Plink 1.9). For quantitative phenotypes, <code>--glm</code> fits a linear model while for binary phenotypes, it fits a logistic or Firth regression model instead.</p> <ul> <li>The model has a fixed-covariate matrix to include covariates loaded by <code>--covar</code>.<ul> <li>It is now standard practice to include top principal components (usually computed by <code>--pca</code>) as covariates in any association analysis, to correct for population stratification.</li> <li>The 'sex' modifier can be added to include \".fam/.psam\" sex as a covariate. If this is not of interest, add the 'no-x-sex' modifier instead. </li> </ul> </li> <li>Dataset precautions:<ul> <li>This method does not properly adjust for small-scale family structure. As a consequence, it is usually necessary to prune close relations.</li> <li>It is advised to exclude variants with very small minor allele count (\"--mac 20\" is a reasonable filter to apply).  The current filtered dataset already fulfill these precautions.</li> </ul> </li> <li>The model uses the minor allele dosages by default. To make it always contain ALT allele dosages instead (the A1 column of the main report), the 'omit-ref' modifier needs to be added.</li> <li>Covariates are typically used to adjust for their effect but their effect is not needed in the output file. The 'hide-covar' modifier can greatly reduce file sizes.</li> <li>--ci causes confidence intervals with the given width to be reported for each beta or odds-ratio.</li> </ul> <p>Here, the data will be adjusted for sex and 3 PCs.</p> <pre><code>plink2 --bfile \"$gwas\"/AxiomGT1v2.filtered.${target}.noRelatives.LD_prune --chr-set 38 no-xy --allow-extra-chr \\\n       --pheno $gwas/${target}.pheno \\\n       --chr 1-38, X \\\n       --glm sex 'hide-covar' --ci 0.95 \\\n       --covar \"$gwas\"/AxiomGT1v2.filtered.${target}.noRelatives.LD_prune.pca.eigenvec --covar-name PC1,PC2,PC3 \\\n       --output-chr 26 --out \"$gwas\"/AxiomGT1v2.filtered.${target}.noRelatives.LD_prune.glm\n</code></pre> <p>Here is the output:</p> <pre><code>...\nOptions in effect:\n  --allow-extra-chr\n  --bfile gwas_atopy/AxiomGT1v2.filtered.atopy.noRelatives.LD_prune\n  --chr 1-38, X\n  --chr-set 38 no-xy\n  --ci 0.95\n  --covar gwas_atopy/AxiomGT1v2.filtered.atopy.noRelatives.LD_prune.pca.eigenvec\n  --covar-name PC1,PC2,PC3\n  --glm sex hide-covar\n  --out gwas_atopy/AxiomGT1v2.filtered.atopy.noRelatives.LD_prune.glm\n  --output-chr 26\n  --pheno gwas_atopy/atopy.pheno\n\n....\n1989 samples (980 females, 1009 males; 1989 founders) loaded from\ngwas_atopy/AxiomGT1v2.filtered.atopy.noRelatives.LD_prune.fam.\n180605 out of 180689 variants loaded from\ngwas_atopy/AxiomGT1v2.filtered.atopy.noRelatives.LD_prune.bim.\n1 binary phenotype loaded (317 cases, 1672 controls).\n3 covariates loaded from gwas_atopy/AxiomGT1v2.filtered.atopy.noRelatives.LD_prune.pca.eigenvec.\nCalculating allele frequencies... done.\n--glm logistic regression on phenotype 'PHENO1': done.\nResults written to gwas_atopy/AxiomGT1v2.filtered.atopy.noRelatives.LD_prune.glm.PHENO1.glm.logistic .\n</code></pre>"},{"location":"7.gwas/#712-genomic-control","title":"7.1.2. Genomic control","text":"<p>The genomic control \u03bb value (often referred to as the \"genomic inflation factor\") is used to measure and correct for population stratification. A \u03bb value close to 1 suggests that the results are not inflated due to population stratification, while values greater than 1 suggest potential inflation. However, values up to 1.10 are generally considered acceptable for a GWAS.  The results of the regression analysis can be used to calculate the genomic control \u03bb value.</p> <pre><code>## \u03bb = observed median chi-square statistic / 0.456\n## Chi-square statistic = Z_stat&lt;sup&gt;2&lt;/sup&gt;\n\ntail -n+2 $gwas/AxiomGT1v2.filtered.${target}.noRelatives.LD_prune.glm.PHENO1.glm.logistic | awk '{print $13*$13}' | sort | awk '{count[NR] = $1;}\\\nEND{\nif(NR % 2){gif = count[(NR + 1) / 2];} else {gif = (count[(NR / 2)] + count[(NR / 2) + 1]) / 2.0;}\nprint \"Genomic inflation factor = \" gif/0.456;}'\n</code></pre> <p>Genomic inflation factor = 1.0748.</p>"},{"location":"7.gwas/#713-plotting","title":"7.1.3. Plotting","text":"<pre><code>input_asc=\"$gwas/AxiomGT1v2.filtered.${target}.noRelatives.LD_prune.glm.PHENO1.glm.logistic\"\noutput_prefix=\"$gwas/${target}.glm.logistic\"\n\nRscript -e 'args=(commandArgs(TRUE));require(qqman);'\\\n'asc &lt;- read.table(args[1],head=TRUE,comment.char=\"\");'\\\n'asc &lt;- na.omit(asc);'\\\n'tiff(paste(args[2],\".qqplot.tif\",sep=\"\"),units=\"in\", width=10, height=10, res=300);'\\\n'qq(asc$P, main = \"Q-Q plot\", col = \"blue4\");'\\\n'dev.off();'\\\n'noOfTests &lt;- dim(asc)[1];bonf &lt;- 0.05/as.numeric(noOfTests);bonfBy200 &lt;- 10/as.numeric(noOfTests);'\\\n'sigSNPs &lt;- asc$ID[which(asc$P&lt;=bonfBy200)];'\\\n'tiff(paste(args[2],\".manh.tif\",sep=\"\"),units=\"in\", width=30, height=10, res=300);'\\\n'manhattan(asc, main = \"Manhattan Plot\", chr = \"X.CHROM\", bp = \"POS\", p = \"P\", snp = \"ID\", ylim = c(0, 7), chrlabs = c(1:38, \"X\"),suggestiveline =  -log10(bonfBy200), genomewideline =  -log10(bonf), highlight = sigSNPs);'\\\n'dev.off();'  \"$input_asc\" \"$output_prefix\"\n</code></pre> <p>Here is the Q-Q plot:</p> <p></p> <p>And the Manhattan plot:</p> <p></p>"},{"location":"7.gwas/#72-gwas-by-gcta","title":"7.2.  GWAS by GCTA","text":""},{"location":"7.gwas/#721-mixed-linear-model","title":"7.2.1.  Mixed linear model","text":"<p>Mixed model association software such as SAIGE, BOLT-LMM, GCTA or FaST-LMM instead; or regenie's whole genome regression can better handle genetic relatedness. In this tutorial, <code>--mlma-loco</code> for mixed linear model-based association analysis will be used. </p> <pre><code>y = a + bx + g + e\n</code></pre> <p>where: </p> <ul> <li>y is the phenotype.</li> <li>a is the mean term (i.e. intercept).</li> <li>b is the additive effect (fixed effect) of the candidate SNP to be tested for association.</li> <li>x is the SNP genotype indicator variable coded as 0, 1 or 2.</li> <li>g is the polygenic effect (random effect) i.e. the accumulated effect of all SNPs (as captured by the GRM calculated using all SNPs).  </li> <li>e is the residual. </li> </ul> <p>The MLM leaving-one-chromosome-out (LOCO) analysis implements the model with the chromosome, on which the candidate SNP is located, excluded from calculating the GRM. This means that g is the accumulated effect of all SNPs except those on the chromosome where the candidate SNP is located. The var(g) will be re-estimated each time when a chromosome is excluded from calculating the GRM. The MLM-LOCO analysis is computationally less efficient but more powerful as compared with the classical MLM analysis.</p> <p>Note1: The mixed linear model incorporates the genetic relationship matrix (GRM) to capture the accumulated effect of all SNPs which accounts for population stratification to a large extent. Therefore, there is no need to adjust for top PCs.</p> <p>Note2: By default, the model includes covariates (if provided) as fixed effects and the phenotype will be adjusted by the mean (i.e. intercept) and covariates before testing for SNP association. However, if SNPs are correlated with the covariates, pre-adjusting the phenotype by the covariates will probably cause loss of power. If the <code>--mlma-no-preadj-covar</code> option is specified, the covariates will be fitted together with the SNP for association test. However, this will significantly reduce computational efficiency.</p> <pre><code>gcta64 --mlma-loco --bfile gcta_atopy/AxiomGT1v2.filtered.${target}.noRelatives.LD_prune.gcta --autosome-num 38 --autosome \\\n       --grm gcta_atopy/AxiomGT1v2.filtered.${target}.noRelatives.LD_prune.gcta_grm \\\n       --pheno $gwas/${target}.pheno \\\n       --covar $gwas/gender.txt --mlma-no-preadj-covar \\\n       --out $gwas/${target}_asc --thread-num 10\n</code></pre>"},{"location":"7.gwas/#722-genomic-control","title":"7.2.2. Genomic control:","text":"<p>The output of the MLM-LOCO analysis does not have chi-square statistic; however, the p-values can be converted to chi-squared statistics for 1 degree of freedom by using the inverse of the cumulative distribution function (CDF) of the chi-squared distribution. This can be easily done using Python.</p> <pre><code>## Prepare the conda environment to run Python.\nmamba install -c conda-forge python=3.11.4 pandas=2.0.3 scipy=1.11.2\n</code></pre> <p>Now, Python can be opened in interactive mode by using the command <code>python</code>. Once analysis is done, interactive mode can be exited by using the <code>exit()</code> function.</p> <pre><code>import pandas as pd\nimport scipy.stats as stats\n\n# Load the GCTA-LOCO results.\ngwas_results = pd.read_table(\"gwas_atopy/atopy_asc.loco.mlma\", delim_whitespace=True)\n\n# Convert p-values to chi-squared statistics.\ngwas_results['CHISQ'] = stats.chi2.ppf(1 - gwas_results['p'], df=1)\n\n# Calculate lambda.\nlambda_value = gwas_results[\"CHISQ\"].median() / 0.456\n\nprint(\"Genomic control \u03bb:\", lambda_value)\n</code></pre> <p>Genomic control \u03bb = 1.0349228106573256 which is GREAT!</p>"},{"location":"7.gwas/#723-plotting","title":"7.2.3.  Plotting","text":"<pre><code>input_asc=\"$gwas/${target}_asc.loco.mlma\"\noutput_prefix=\"$gwas/${target}.loco.mlma\"\n\nRscript -e 'args=(commandArgs(TRUE));require(qqman);'\\\n'asc &lt;- read.table(args[1],head=TRUE,comment.char=\"\");'\\\n'asc &lt;- na.omit(asc);'\\\n'tiff(paste(args[2],\".qqplot.tif\",sep=\"\"),units=\"in\", width=10, height=10, res=300);'\\\n'qq(asc$p, main = \"Q-Q plot\", col = \"blue4\");'\\\n'dev.off();'\\\n'noOfTests &lt;- dim(asc)[1];bonf &lt;- 0.05/as.numeric(noOfTests);bonfBy200 &lt;- 10/as.numeric(noOfTests);'\\\n'sigSNPs &lt;- asc$SNP[which(asc$p&lt;=bonfBy200)];'\\\n'tiff(paste(args[2],\".manh.tif\",sep=\"\"),units=\"in\", width=30, height=10, res=300);'\\\n'manhattan(asc, main = \"Manhattan Plot\", chr = \"Chr\", bp = \"bp\", p = \"p\", snp = \"SNP\", ylim = c(0, 6),suggestiveline =  -log10(bonfBy200), genomewideline =  -log10(bonf), highlight = sigSNPs);'\\\n'dev.off();'  \"$input_asc\" \"$output_prefix\"\n</code></pre> <p>Here is the Q-Q plot:</p> <p></p> <p>And the Manhattan plot</p> <p></p>"},{"location":"ext_docs/GREML_analysis/","title":"GREML analysis","text":""},{"location":"ext_docs/GREML_analysis/#gcta-greml-analysis","title":"GCTA-GREML Analysis","text":"<p>The narrow-sense heritability (h<sup>2</sup>) is defined as the proportion of phenotypic variance due to additive genetic variance. GREML (Genomic-relatedness-based restricted maximum likelihood) is a method used to estimate the proportion of variance in a phenotype that can be explained by SNPs in a population. In other words, GREML calculates the SNP-based heritability.</p> <p>GREML utilizes the genetic relationships between individuals in a sample population, captured in a genomic relationship matrix (GRM), to partition the phenotypic variance into its genetic and residual components. By fitting a linear mixed model, GREML estimates the proportion of variance attributable to all SNPs.</p> <p>Here is a deeper dive into linear mixed models (LMM) and how they are used in the context of this genomic analysis:</p> <p>1. Basics of linear models:  In simple linear regression, the relationship between a dependent variable (phenotype) and one or more independent variables (often genotypic data) is modeled. The model is described as:</p> <p>Y=X\u03b2+\u03f5</p> <p>Where:</p> <ul> <li>Y is the vector of phenotypic values.</li> <li>X is the design matrix for the fixed effects.</li> <li>\u03b2 is a vector of fixed effect coefficients.</li> <li>\u03f5 is the vector of random errors.</li> </ul> <p></p> <p>2. Mixed models add a random component:  In mixed models, besides fixed effects (like the \u03b2 in the linear model), there are random effects which capture variability in the data due to certain groups or clusters.</p> <p>Y=X\u03b2+Zu+\u03f5</p> <p>Where:</p> <ul> <li>Z is the design matrix for the random effects.</li> <li>u is the vector of random effects.</li> </ul> <p></p> <p>3. Application to genomic data:  In the context of GREML and genomic studies:</p> <ul> <li>The fixed effects (\u03b2) might capture known factors influencing the phenotype, like age or gender.</li> <li>The random effects (u) capture the genetic effects of all SNPs. These are assumed to follow a multivariate normal distribution with mean zero and variance-covariance matrix G\u03c3<sup>2</sup><sub>g</sub>, where G is the genomic relationship matrix (GRM) and \u03c3<sup>2</sup><sub>g</sub> is the genetic variance.</li> <li>The residuals \u03f5 are also assumed to be normally distributed with mean zero and a variance-covariance matrix I\u03c3<sup>2</sup><sub>e</sub>, where I is the identity matrix and \u03c3<sup>2</sup><sub>e</sub> is the error variance.</li> </ul> <p></p> <p>4. Estimating the variance components:  The key goal in GREML is to estimate the \u03c3<sup>2</sup><sub>g</sub> (genetic variance) and \u03c3<sup>2</sup><sub>e</sub> (residual variance). From these, the SNP-based heritability can be computed:</p> <p>h<sup>2</sup> = \u03c3<sup>2</sup><sub>g</sub> / (\u03c3<sup>2</sup><sub>g</sub> + \u03c3<sup>2</sup><sub>e</sub>)</p> <p>This quantifies the proportion of the phenotypic variance explained by the SNPs.</p> <p></p> <p>5. Restricted Maximum Likelihood (REML):  The REML approach is used to estimate the variance components in the model. REML provides unbiased estimates of variance components under a wide range of situations.</p> <p>In summary, by using a linear mixed model, the GREML approach leverages both fixed (known factors) and random (genetic effects of SNPs) components to partition and quantify the variability in the observed phenotype. This enables researchers to pinpoint how much of the phenotypic variance can be attributed to genetics as captured by SNPs.</p> <p></p> <p>6. Statistical verification:  For GCTA to assess the importance of the SNPs' effects to the model, it fits and compare 2 models:</p> <p>a) Full Model that includes both the fixed effects and the random effects.  b) Reduced Model that only includes the fixed effects and omits the random effects of SNPs. </p> <p>GCTA calculates the Log Likelihoods for both models. A higher log likelihood indicates a better fit of the model to the data. The difference in log likelihoods between the full and reduced models provides a test statistic for the significance of the random effects (SNP effects). Essentially, if the full model (which includes SNP effects) has a significantly better fit to the data than the reduced model (which excludes SNP effects), it implies that the SNPs are explaining a significant portion of the variance in the phenotype.</p> <p>Formally, the difference in log likelihoods between the two models, multiplied by two, approximately follows a chi-squared distribution. This can be used for hypothesis testing: 2 (LogLikelihood<sub>full</sub> \u2212 LogLikelihood<sub>reduced</sub>).</p> <p>More details about linear mixed models can be found here.</p>"},{"location":"ext_docs/admixture_analysis/","title":"Admixture analysis","text":""},{"location":"ext_docs/admixture_analysis/#admixture-analysis","title":"Admixture Analysis","text":"<p>Admixture analysis is a statistical method used in population genetics to estimate the proportions of ancestry in an individual's genome derived from multiple populations. By analyzing variations in DNA sequences, this method provides insights into historical migrations, inter-population mixing, and the genetic backgrounds of mixed populations. </p> <p>Species with breeds under artificial selection pressure like dogs can make use of admixture analysis in special situations including:</p> <ol> <li>Historical admixture: If there is suspicion or historical evidence that a particular breed was created through the mixing of two or more other breeds, admixture analysis can provide insights into the genetic contributions of each ancestral breed. The Golden Retriever breed has a well-documented origin, having been developed in the Scottish Highlands in the late 19th century from a blend of Yellow Retrievers, Tweed Water Spaniels and other breeds. Therefore, this situation does not seem applicable.</li> <li>Population bottlenecks and diversity: Admixture analysis can help determine if there has been a recent bottleneck (a sharp reduction in the size of a population) in the breed's history. Such events can lead to a decrease in genetic diversity, which can increase susceptibility to diseases. This would be a useful application if the population represented a wide array of Golden Retrievers from different lineages or regions, but this is not the case.</li> <li>Breed purity: Admixture analysis can be used to assess the genetic purity of individual dogs or lines within a breed. If there's unexpected genetic material from another breed, it might be indicative of undisclosed crossbreeding in the past. That seems like a useful application but the studied population would need to include samples from other breeds to identify any unusual genetic signals within the Golden Retriever dogs.</li> <li>Health and genetic disorders: Many pure-bred dogs are prone to specific genetic disorders. Golden Retrievers, like many pure-bred dogs, have specific health concerns, including hip dysplasia, certain cancers and eye issues. While admixture analysis doesn't directly target these, understanding the genetic makeup and potential sources of variation within a breed can help in broader genetic studies aimed at improving breed health. While health-focused studies can be breed-specific, knowing the genetic makeup of related breeds might help identify the origins of certain genetic disorders or traits.</li> </ol> <p>In conclusion, for this analysis to be useful, a population of dogs including more breeds is needed. For now, the data of Golden retrievers only will be used to explore the genetic diversity within the breed. Hopefully, this dataset can be expanded soon to include more dogs from other breeds.     </p>"},{"location":"ext_docs/admixture_analysis/#1-install","title":"1. Install","text":"<pre><code>conda install -c bioconda admixture=1.3.0\n</code></pre>"},{"location":"ext_docs/admixture_analysis/#2-exclude-1st-degree-relatives","title":"2. Exclude 1st degree relatives","text":"<pre><code>mkdir -p admix\n# 0.177 (the geometric mean of 0.25 and 0.125) will be used as cutoff for the KING kinship coeffiecients to identify 1st degree relatives.\nplink2 --bfile AxiomGT1v2.filtered.LD_prune --chr-set 38 no-xy --allow-extra-chr \\\n       --king-cutoff 0.177 \\\n       --out admix/AxiomGT1v2.1st_degree_relatives\n\n# Let's remove those relatives to avoid inflation of false associations in the GWAS\nplink2 --bfile AxiomGT1v2.filtered.LD_prune --chr-set 38 no-xy --allow-extra-chr \\\n       --remove admix/AxiomGT1v2.1st_degree_relatives.king.cutoff.out.id \\\n       --make-bed --output-chr 'chrM' --out admix/AxiomGT1v2.noRelatives.filtered.LD_prune\n</code></pre>"},{"location":"ext_docs/admixture_analysis/#3-remove-non-autosomal-markers-and-change-character-names-to-integers","title":"3. Remove non-autosomal markers and change character names to integers","text":"<pre><code>plink2 --bfile admix/AxiomGT1v2.noRelatives.filtered.LD_prune --chr-set 38 no-xy --allow-extra-chr \\\n       --autosome \\\n       --make-bed -out admix/AxiomGT1v2.noRelatives.filtered.LD_prune.autosomes\n</code></pre>"},{"location":"ext_docs/admixture_analysis/#4-run-admixture-in-the-cross-validation-mode-to-find-out-the-best-number-of-ancestries","title":"4. Run Admixture in the cross-validation mode to find out the best number of ancestries","text":"<pre><code>cd admix\nfor k in {1..10};do echo $k;\n  admixture -j8 --cv AxiomGT1v2.noRelatives.filtered.LD_prune.autosomes.bed $k | tee log${k}.out\ndone\ngrep \"^CV error\" log*.out | cut -d\":\" -f1,3 | sed 's/log//;s/\\.out://' | sort -k1,1n &gt; admix_cv.txt\n\nRscript -e 'val &lt;- read.table(\"admix_cv.txt\");'\\\n'jpeg(file = \"admix_cv.jpg\");'\\\n'plot( x = val$V1, y = val$V2, type = \"o\",xlab = \"K Ancestry\", ylab = \"CV error\");'\\\n'dev.off();'\n</code></pre> <p>There is an output file for each parameter set: Q (the ancestry fractions) and P (the allele frequencies of the inferred ancestral populations). </p>"},{"location":"ext_docs/admixture_analysis/#5-plot-the-q-estimates","title":"5. Plot the Q estimates","text":"<pre><code>sort -k1,3nr AxiomGT1v2.noRelatives.filtered.LD_prune.autosomes.3.Q &gt; AxiomGT1v2.noRelatives.filtered.LD_prune.autosomes.3.Q.sorted\nRscript -e 'tbl=read.table(\"AxiomGT1v2.noRelatives.filtered.LD_prune.autosomes.3.Q.sorted\");'\\\n'jpeg(file = \"ancestries.jpg\");'\\\n'barplot(t(as.matrix(tbl)), col=rainbow(3),xlab=\"Individual #\", ylab=\"Ancestry\", border=NA);'\\\n'dev.off();'\n</code></pre>"},{"location":"ext_docs/admixture_analysis/#6-plot-the-q-estimates-of-a-selected-subset-of-individuals","title":"6. Plot the Q estimates of a selected subset of individuals","text":"<pre><code>tail -n+2 AxiomGT1v2.noRelatives.filtered.LD_prune.pca.eigenvec | awk '{if($3&lt;0.02 &amp;&amp; $4&gt;0.03)print $1,$2}' &gt; pc2_extreme\npaste AxiomGT1v2.noRelatives.filtered.LD_prune.autosomes.3.Q  AxiomGT1v2.noRelatives.filtered.LD_prune.autosomes.fam | grep -wf pc2_extreme &gt; pc2_extreme.Q\necho Population Percent Individual &gt; subset_ancestry.txt\ncat pc2_extreme.Q | awk '{for (a = 1; a &lt;= 3; a++)print \"Pop\"a,$a,$4\".\"$5}' &gt;&gt; subset_ancestry.txt\n\nRscript -e 'data &lt;- read.table(\"subset_ancestry.txt\",header = TRUE);'\\\n'library(ggplot2);'\\\n'bar &lt;- ggplot(data, aes(fill=Population, y=Percent, x=factor(Individual))) +'\\\n'geom_bar(position=\"stack\", stat=\"identity\") + ggtitle(\"Admixture ancestries\");'\\\n'bar2 &lt;- bar + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1, size = 4));'\\\n'ggsave(\"subset_ancestries.png\", bar2, width = 12, height = 6, dpi = 400);'\n</code></pre>"},{"location":"ext_docs/gwas_studies/","title":"Previous GWAS","text":""},{"location":"ext_docs/gwas_studies/#previous-gwas-studies-in-golden-retrievers","title":"Previous GWAS Studies in Golden Retrievers","text":""},{"location":"ext_docs/gwas_studies/#a-cancers","title":"A) Cancers","text":"<ol> <li>Tonomura et al. Genome-wide association study identifies shared risk loci common to two malignancies in golden retrievers. PLoS Genet. 2015 Feb 2;11(2):e1004922. doi: 10.1371/journal.pgen.1004922. eCollection 2015 Feb.  Canine B-cell lymphoma and hemangiosarcoma are both malignancies of the hematologic system. Golden retrievers in the US show significantly elevated lifetime risk for both B-cell lymphoma (6%) and hemangiosarcoma (20%). GWAS for hemangiosarcoma and B-cell lymphoma, identifying two shared predisposing loci. The two associated loci are located on CFA 5, and together contribute ~20% of the risk of developing these cancers. Genome-wide p-values for the top SNP of each locus are 4.6\u00d710-7 and 2.7\u00d710-6, respectively. Whole genome resequencing of nine cases and controls identified three shared and one B-cell lymphoma specific risk haplotypes within the two loci, but no coding changes were associated with the risk haplotypes. Gene expression analysis of B-cell lymphoma tumors revealed that carrying the risk haplotypes at the first locus is associated with down-regulation of several nearby genes including the proximal gene TRPC6, a transient receptor Ca2+-channel involved in T-cell activation, among other functions. The shared risk haplotype in the second locus overlaps the vesicle transport and release gene STX8. Carrying the shared risk haplotype is associated with gene expression changes of 100 genes enriched for pathways involved in immune cell activation. Thus, the predisposing germline mutations in B-cell lymphoma and hemangiosarcoma appear to be regulatory, and affect pathways involved in T-cell mediated immune response in the tumor.   </li> <li>Evans et al. Multi-omics approach identifies germline regulatory variants associated with hematopoietic malignancies in retriever dog breeds. PLoS Genet. 2021 May 13;17(5):e1009543. doi: 10.1371/journal.pgen.1009543. eCollection 2021 May.  Histiocytic sarcoma is an aggressive hematopoietic malignancy of mature tissue histiocytes. Flat-coated retrievers (FCRs) have unusually high frequency (lethal in 20%). GWASs identifying two significant risk loci on CFA 5 (Pwald = 4.83x10-9) and 19 (Pwald = 2.25x10-7). A multi-omics approach generating whole genome, transcriptome, and chromatin immunoprecipitation sequencing highlighted the PI3K pathway gene PIK3R6 on CFA5, and proximal candidate regulatory variants that are strongly associated with histiocytic sarcoma and predicted to impact transcription factor binding. The CFA5 association colocalizes with susceptibility loci for two hematopoietic malignancies, hemangiosarcoma and B-cell lymphoma, in the closely related golden retriever breed, revealing the risk contribution this single locus makes to multiple hematological cancers. By comparison, the CFA19 locus is unique to the FCR and harbors risk alleles associated with upregulation of TNFAIP6, which itself affects cell migration and metastasis. Together, these loci explain ~35% of disease risk.  </li> <li>H\u00e9dan et al. Identification of common predisposing loci to hematopoietic cancers in four dog breeds. PLoS Genet. 2021 Apr 1;17(4):e1009395. doi: 10.1371/journal.pgen.1009395. eCollection 2021 Apr.  Histiocytic sarcoma (HS) is a rare but aggressive cancer in both humans and dogs with specific breed predispositions. This study combined several GWASs in a multi-breed (Bernese mountain dogs, Rottweilers, flat-coated retrievers, and golden retrievers) and multi-cancer (HS, lymphoma, and mast cell tumor). Results confirmed the previously identified HS risk CDKN2A locus on CFA 11.  Also identified new loci on canine chromosomes 2, 5, 14, and 20. Capture and targeted sequencing of specific loci suggested the existence of regulatory variants in non-coding regions and methylation mechanisms linked to risk haplotypes, which lead to strong cancer predisposition in specific dog breeds. We also showed that these canine cancer predisposing loci appeared to be due to the additive effect of several risk haplotypes involved in other hematopoietic cancers such as lymphoma or mast cell tumors as well.  </li> <li>Labadie et al. Genome-wide association analysis of canine T zone lymphoma identifies link to hypothyroidism and a shared association with mast-cell tumors. BMC Genomics. 2020 Jul 6;21(1):464. doi: 10.1186/s12864-020-06872-9.  T zone lymphoma (TZL) represents about 12% of all canine lymphomas. Golden Retrievers appear predisposed, representing over 40% of TZL cases. Asymptomatic aged Golden Retrievers frequently have populations of T zone-like cells (phenotypically identical to TZL) of undetermined significance (TZUS), potentially representing a pre-clinical state. Dogs were categorized as TZL (n = 95), TZUS (n = 142), or control (n = 101) using flow cytometry and genotyped using the Illumina CanineHD BeadChip. Using a mixed linear model adjusting for population stratification, we found association with genome-wide significance in regions on chromosomes 8 and 14. The chromosome 14 peak included four SNPs (Odds Ratio = 1.18-1.19, p = .3 \u00d7 10- 5-5.1 \u00d7 10- 5) near three hyaluronidase genes (SPAM1, HYAL4, and HYALP1). Targeted resequencing identified missense mutations in all three genes; the variant in SPAM1 was predicted to be damaging. These mutations were also associated with risk for mast cell tumors among Golden Retrievers in an unrelated study. The chromosome 8 peak contained 7 SNPs (Odds Ratio = 1.24-1.42, p = 2.7 \u00d7 10- 7-7.5 \u00d7 10- 5) near genes involved in thyroid hormone regulation (DIO2 and TSHR). A prior study from our laboratory found hypothyroidism is inversely associated with TZL risk. No coding mutations were found with targeted resequencing but identified variants may play a regulatory role for all or some of the genes.  </li> <li>Biasoli et al. A synonymous germline variant in a gene encoding a cell adhesion molecule is associated with cutaneous mast cell tumour development in Labrador and Golden Retrievers. PLoS Genet. 2019 Mar 22;15(3):e1007967. doi: 10.1371/journal.pgen.1007967. eCollection 2019 Mar.  Mast cell tumours (MCT) are the most common type of skin cancer in dogs with known breed-predisposition. In in Labrador Retrievers, GWAS combined with targeted next generation sequencing, and TaqMan genotyping identified a synonymous variant in the DSCAM gene on CAF 31. Furthermore, we showed that the variant is also associated with MCT in Golden Retrievers. The variant is common in both Labradors and Golden Retrievers and consequently is likely to be a significant genetic contributor to the increased susceptibility of both breeds to develop mast cell tumours.  </li> <li>Arendt et al. Genome-Wide Association Study of Golden Retrievers Identifies Germ-Line Risk Factors Predisposing to Mast Cell Tumours. PLoS Genet. 2015 Nov 20;11(11):e1005647. doi: 10.1371/journal.pgen.1005647. eCollection 2015 Nov.  ... somatic mutations in the oncogene C-KIT have been detected in a proportion of Canine MCT. GWAS in golden retrievers from two continents identified separate regions in the two populations. Sequence capture of associated regions and subsequent fine mapping in a larger cohort of dogs identified a SNP associated with development of MCT in the GNAI2 gene (p = 2.2x10-16), introducing an alternative splice form of this gene resulting in a truncated protein. In addition, disease associated haplotypes harbouring the hyaluronidase genes HYAL1, HYAL2 and HYAL3 on cfa20 and HYAL4, SPAM1 and HYALP1 on cfa14 were identified as separate risk factors in European and US golden retrievers, respectively, suggesting that turnover of hyaluronan plays an important role in the development of CMCT.  </li> </ol>"},{"location":"ext_docs/gwas_studies/#b-non-cancer","title":"B) Non-cancer","text":"<ol> <li>Arendt et al. The ABCC4 gene is associated with pyometra in golden retriever dogs. Sci Rep. 2021 Aug 17;11(1):16647. doi: 10.1038/s41598-021-95936-1.  Pyometra is inflammation and bacterial infection of the uterus. There is clear breed predisposition (risk ratio: 3.3 in GR). GWAS with mixed model. GWAS comparing 98 cases, and 96 controls identified an associated locus on chromosome 22 (p = 1.2 \u00d7 10-6). This locus contained five significantly associated SNPs positioned within introns of the ATP-binding cassette transporter 4 (ABCC4) gene. NGS and genotyping of cases and controls subsequently identified four missense SNPs within the ABCC4 gene. One missense SNP at chr22:45,893,198 (p.Met787Val) showed complete LD with the associated GWAS SNPs suggesting a potential role in disease development. Another locus on chromosome 18 overlapping the TESMIN gene, is also potentially implicated in the development of the disease.  </li> <li>Brinkmeyer-Langford et al. Genome-wide association study to identify potential genetic modifiers in a canine model for Duchenne muscular dystrophy Candice BMC Genomics. 2016 Aug 22;17(1):665. doi: 10.1186/s12864-016-2948-z.  Duchenne muscular dystrophy (DMD) causes progressive muscle degeneration, cardiomyopathy and respiratory failure in approximately 1/5,000 boys. Golden Retriever muscular dystrophy (GRMD) resembles DMD both clinically and pathologically. The disease exhibits remarkable phenotypic variation among affected dogs, suggesting the influence of modifiers. A linear mixed-model (LMM) analysis using 16 variably-affected dogs from our GRMD colony (8 dystrophic vs 8 non-dystrophic).   </li> <li>Olsson et al. Genome-Wide Analyses Suggest Mechanisms Involving Early B-Cell Development in Canine IgA Deficiency. PLoS One. 2015 Jul 30;10(7):e0133844. doi: 10.1371/journal.pone.0133844. eCollection 2015.  Immunoglobulin A deficiency (IgAD) is the most common primary immune deficiency disorder in both humans and dogs, characterized by recurrent mucosal tract infections and a predisposition for allergic and other immune mediated diseases. A novel percentile groups-approach was used to establish breed-specific cut-offs and to perform analyses in a close to continuous manner. GWAS performed in four breeds prone to low IgA levels (German shepherd, Golden retriever, Labrador retriever and Shar-Pei) identified 35 genomic loci suggestively associated (p &lt;0.0005) to IgA levels. In German shepherd, three genomic regions (candidate genes include KIRREL3 and SERPINA9) were genome-wide significantly associated (p &lt;0.0002) with IgA levels. A ~20kb long haplotype on CFA28, significantly associated (p = 0.0005) to IgA levels in Shar-Pei, was positioned within the first intron of the gene SLIT1. The suggestively associated regions were enriched for genes in Gene Ontology gene sets involving inflammation and early immune cell development.  </li> <li>Downs et al. A novel mutation in TTC8 is associated with progressive retinal atrophy in the golden retriever. Canine Genet Epidemiol. 2014 Apr 16;1:4. doi: 10.1186/2052-6687-1-4. eCollection 2014.  Generalized progressive retinal atrophy (PRA) is a group of inherited eye diseases characterised by progressive retinal degeneration that ultimately leads to blindness in dogs. Mutations in two distinct genes have been reported to cause PRA in Golden Retrievers: prcd-PRA (c.5G &gt; A at the PRCD gene on CFA9) and GR_PRA1 (c.2601_2602insC at the SLC4A3 gene on CFA37), but for approximately 39% of cases in this breed the causal mutation remains unknown. GWAS of 10 PRA cases and 16 controls identified an association on CFA8. Using haplotype analysis we defined a 737 kb critical region. Using targeted NGS, a single nucleotide deletion was identified in exon 8 of the TTC8 gene of affected Golden Retrievers. The frame shift mutation was predicted to cause a premature termination codon.  </li> <li>Grall et al. PNPLA1 mutations cause autosomal recessive congenital ichthyosis in golden retriever dogs and humans. Nat Genet. 2012 Jan 15;44(2):140-7. doi: 10.1038/ng.1056.  Ichthyoses comprise a heterogeneous group of genodermatoses characterized by abnormal desquamation over the whole body. GWAS in golden retrievers affected by a lamellar ichthyosis identified a homozygous insertion-deletion (indel) mutation in PNPLA1 on CFA12 that leads to a premature stop codon in all affected golden retriever dogs.  </li> <li>Wood et al. Genome-wide association analysis of canine atopic dermatitis and identification of disease related SNPs. Immunogenetics. 2009 Dec;61(11-12):765-72. doi: 10.1007/s00251-009-0402-y. Epub 2010 Jan 5.  GWAS of atopic dermatitis (cAD) was done in Golden Retrievers. Further validation studies were performed for potentially associated SNPs using Sequenom genotyping of larger numbers of cases and controls across eight breeds (Boxer, German Shepherd Dog, Labrador, Golden Retriever, Shiba Inu, Shih Tzu, Pit Bull, and West Highland White Terriers). Using meta-analysis, two SNPs were associated with cAD in all breeds tested. RS22114085 was identified as a susceptibility locus (p=0.00014, odds ratio=2) and RS23472497 as a protective locus (p=0.0015, odds ratio=0.6). Both of these SNPs were located in intergenic regions, and their effects have been demonstrated to be independent of each other, highlighting that further fine mapping and resequencing is required of these areas. Further, 12 SNPs were validated by Sequenom genotyping as associated with cAD, but these were not associated with all breeds.  </li> <li>[Review] Ontiveros et al. Genetics of canine subvalvular aortic stenosis (SAS). Canine Med Genet. 2021 May 7;8(1):4. doi: 10.1186/s40575-021-00103-4.  A GWAS analysis was also completed for SAS affected Golden Retrievers [39]. This abstract reported a region on chromosome 13 that was identified in 29 affected and 52 control Golden Retrievers. We have also completed a GWAS analysis for the Newfoundland and Rottweiler breed, both of which also demonstrated a locus on chromosome 13 that exceeded the Bonferroni threshold for significance (unpublished data). Therefore, we completed an across breed GWAS analysis for the Golden Retriever, Newfoundland, and Rottweiler breeds to determine if they shared a common genetic variant on chromosome 13 (unpublished data). Given that these breeds share haplotypes with each other, it is possible that they may all share a genetic variant that predisposes them for SAS [40]. The across breed GWAS analysis identified a locus achieving genome-wide significance on chromosome 13. The aim of these analyses was to decipher the genetic architecture for SAS affected dogs. This candidate region on chromosome 13 requires further evaluation through the use of targeted or whole-genome sequencing approaches. This can result in the identification of distinct or shared genetic variants associated with SAS in the Golden Retriever, Newfoundland, and Rottweiler breed.  </li> </ol>"},{"location":"ext_docs/health_concerns/","title":"Health concerns","text":""},{"location":"ext_docs/health_concerns/#health-concerns-in-golden-retrievers-a-literature-review","title":"Health Concerns in Golden Retrievers: A Literature Review","text":"<p>Golden Retrievers are one of the most popular breeds in the world. However, like many pure-bred dogs, golden retrievers are prone to breed specific and non-breed specific health problems. This review aims to summarize some of the most prevalent health concerns in Golden Retrievers.</p> <p>A) Breed specific:</p> <ol> <li>Hip Dysplasia:    A common concern in many larger dog breeds, hip dysplasia is an abnormal formation of the hip socket. Over time, this can lead to arthritis and pain.  Reference: Smith, G. K., Mayhew, P. D., Kapatkin, A. S., McKelvie, P. J., Shofer, F. S., &amp; Gregor, T. P. (2001). Evaluation of risk factors for degenerative joint disease associated with hip dysplasia in German Shepherd Dogs, Golden Retrievers, and Rottweilers. Journal of the American Veterinary Medical Association, 219(12), 1719-1724. </li> <li>Elbow Dysplasia:    This is a condition affecting the elbow joint and can lead to pain and lameness in affected dogs.  Reference: Burton, N. J., &amp; Owen, M. R. (2008). Elbow dysplasia in the dog: pathophysiology, diagnosis and current treatment recommendations. Veterinary Journal, 175(2), 149-162. </li> <li>Cancer:    Unfortunately, Golden Retrievers have a higher incidence of cancer compared to many other breeds. Common cancers include hemangiosarcoma, osteosarcoma, and lymphoma.  Reference: Priester, W. A., &amp; Mantel, N. (1971). Occurrence of tumors in domestic animals. Data from 12 United States and Canadian colleges of veterinary medicine. Journal of the National Cancer Institute, 47(6), 1333-1344. </li> <li>Eye Disorders:    Cataracts, progressive retinal atrophy, and retinal dysplasia are some of the eye-related issues that Golden Retrievers may face.  Reference: Gelatt, K. N., &amp; Mackay, E. O. (2005). Prevalence of primary breed\u2010related cataracts in the dog in North America. Veterinary ophthalmology, 8(2), 101-111. </li> <li>Cardiac Issues:    Golden Retrievers can suffer from subvalvular aortic stenosis, a congenital heart condition.  Reference: Stern, J. A., Meurs, K. M., Nelson, O. L., Lahmers, S. M., &amp; Lehmkuhl, L. B. (2012). Familial subvalvular aortic stenosis in golden retrievers: inheritance and echocardiographic findings. Journal of Small Animal Practice, 53(4), 213-217. </li> <li>Allergies:    Skin allergies resulting from environmental triggers or food allergies can be a common issue.  Reference: Griffin, C. E., &amp; Hillier, A. (2001). The ACVD task force on canine atopic dermatitis (I): incidence and prevalence. Veterinary Immunology and Immunopathology, 81(3-4), 147-151. </li> <li>Ear Infections:    Their floppy ears make Golden Retrievers more prone to ear infections.  Reference: Saridomichelakis, M. N. (2007). Advances in the pathogenesis of canine otitis externa. Veterinary dermatology, 18(5), 300-306. </li> <li>Thyroid Disorders:    Hypothyroidism is a concern in Golden Retrievers, leading to various symptoms like lethargy, weight gain, and skin problems.  Reference: Dixon, R. M., &amp; Mooney, C. T. (1999). Canine hypothyroidism: a review of aetiology and diagnosis. New Zealand Veterinary Journal, 47(2), 47-52. </li> <li>Osteochondritis Dissecans (OCD):     This is a condition wherein the cartilage in a joint grows improperly and can lead to painful bone spurs. It typically affects the shoulders.  Reference: Olsson, S. E. (1982). Osteochondrosis in domestic animals. Acta Radiologica. Supplementum, 358, 299-306. </li> <li>Von Willebrand's Disease:     This is a blood disorder that affects the clotting process. It can cause excessive bleeding in dogs after surgery or injury.  Reference: Brooks, M. B., Erb, H. N., &amp; Foureman, P. A. (1992). von Willebrand's disease in the golden retriever: a heterogeneous group of disorders. British journal of haematology, 80(2), 251-257. </li> <li>Epilepsy:     Some Golden Retrievers can suffer from epilepsy, a neurological disorder that can cause seizures.  Reference: Berendt, M., Farquhar, R. G., Mandigers, P. J. J., Pakozdy, A., Bhatti, S. F. M., De Risio, L., ... &amp; Haagsman, A. N. (2015). International veterinary epilepsy task force consensus report on epilepsy definition, classification, and terminology in companion animals. BMC veterinary research, 11(1), 1-9. </li> <li>Pyometra:     Being a common issue in many breeds, pyometra is an infection in the uterus that can be life-threatening if not treated promptly.  Reference: Hagman, R. (2017). Pyometra in small animals. Veterinary Clinics: Small Animal Practice, 47(4), 783-805. </li> <li>Gastric Dilation-Volvulus (GDV or bloat):     This is a serious condition where the stomach fills with gas and then twists. It can be fatal if not treated immediately.  Reference: Glickman, L. T., Glickman, N. W., Schellenberg, D. B., Raghavan, M., &amp; Lee, T. L. (2000). Incidence of and breed-related risk factors for gastric dilatation-volvulus in dogs. Journal of the American Veterinary Medical Association, 216(1), 40-45. </li> <li>Skin Disorders:     Apart from allergies, Golden Retrievers can also be prone to various skin disorders, including hot spots or acute moist dermatitis.  Reference: Scott, D. W., Miller Jr, W. H., &amp; Griffin, C. E. (2001). Muller &amp; Kirk's small animal dermatology. Elsevier Health Sciences. </li> </ol> <p>B) Non-breed specific</p> <ol> <li>Heartworms: Golden Retrievers, like all dogs, are susceptible to heartworm disease. Heartworm disease is a serious disease that results in severe lung disease, heart failure, other organ damage, and death in pets, mainly dogs, cats, and ferrets. It is caused by a parasitic worm called Dirofilaria immitis. The worms are spread through the bite of a mosquito.  Reference: Atkins, C. E. (2003). Comparison of results of three commercial heartworm antigen test kits in dogs with low heartworm burdens. Journal of the American Veterinary Medical Association, 222(9), 1221-1223. </li> <li>Dental Diseases: Like other dogs, Golden Retrievers can suffer from periodontal disease, gingivitis, and other dental problems.  Reference: Harvey, C. E. (1998). Management of periodontal disease: understanding the options. Veterinary Clinics of North America: Small Animal Practice, 28(5), 1129-1147. </li> <li>Infectious Diseases: These dogs can be affected by various infectious diseases, such as parvovirus, distemper, and leptospirosis.  Reference: Decaro, N., &amp; Buonavoglia, C. (2012). Canine parvovirus\u2014a review of epidemiological and diagnostic aspects, with emphasis on type 2c. Veterinary Microbiology, 155(1), 1-12. </li> <li>Parasitic Infections: Intestinal parasites such as hookworms, roundworms, and whipworms can affect Golden Retrievers.  Reference: Bowman, D. D., Montgomery, S. P., Zajac, A. M., Eberhard, M. L., &amp; Kazacos, K. R. (2010). Hookworms of dogs and cats as agents of cutaneous larva migrans. Trends in parasitology, 26(4), 162-167. </li> <li>Cushings Disease (Hyperadrenocorticism): This endocrine disorder, where the adrenal glands produce too much cortisol, can affect Golden Retrievers among other breeds.  Reference: Galac, S., Kars, V. J., Voorhout, G., Mol, J. A., &amp; Kooistra, H. S. (2005). ACTH-independent hyperadrenocorticism due to food-dependent hypercortisolism in a dog: a case report. Veterinary Journal, 169(3), 419-422. </li> <li>Diabetes Mellitus: Not exclusive to Golden Retrievers but still a concern for many dog breeds.  Reference: Catchpole, B., Ristic, J. M., Fleeman, L. M., &amp; Davison, L. J. (2005). Canine diabetes mellitus: can old dogs teach us new tricks?. Diabetologia, 48(10), 1948-1956. </li> <li>Panosteitis: An inflammatory bone disease, sometimes referred to as \"growing pains\", can affect rapidly growing large breed dogs like Golden Retrievers.  Reference: Bennett, D., &amp; May, C. (1995). Joint diseases of dogs and cats. In Textbook of Veterinary Internal Medicine (Vol. 2, pp. 2032-2074). WB Saunders Co. </li> <li>Renal Failure: Chronic kidney disease can affect older Golden Retrievers, though it's not exclusive to the breed.  Reference: Polzin, D. J. (2011). Chronic kidney disease in small animals. Veterinary Clinics of North America: Small Animal Practice, 41(1), 15-30. </li> <li>Liver Disease: Canine liver diseases can manifest in various ways and may affect Golden Retrievers.  Reference: Center, S. A. (2007). Diseases of the gallbladder and biliary tree. Veterinary Clinics of North America: Small Animal Practice, 37(3), 537-552. </li> </ol>"},{"location":"ext_docs/sample_distance/","title":"Sample-distance","text":""},{"location":"ext_docs/sample_distance/#sample-distance-and-similarity-matrices","title":"Sample-Distance and Similarity Matrices","text":"<p>Assessment of similarity between studied individuals is useful to identify sample duplications or unexpected outliers. It is critical to adjust for hidden population structure. A pairwise similarity can be calculated by counting the alleles descended from a common ancestor (i.e. identity by descent; IBD) and/or alleles that are the same, irrespective of whether they are inherited from a recent ancestor (i.e. identity by state; IBS).</p> <p>Pedigree information allows us to figure out the expected proportion of shared alleles by descent and thus IBD distances within families. However, it is not uncommon for the proposed pedigree to be wrong. With genotyping arrays and sequencing, marker information can be used to calculate IBS or IBD similarity matrices and predict the actual pedigree structure.</p> <p>VanRaden (2008) and Yang et al. (2010) described the genomic relationship matrix (GRM) as a a covariance matrix which uses identical by state (IBS) information scaled by the allele frequencies, as shared rare alleles are more likely to be IBD than common alleles. These methods do not explicitly differentiate between IBD and IBS information Clark et al. (2012).</p> <p>GRM uses the minor allele frequencies (MAFs) of genotyped SNPs assuming a homogeneous population structure which is not always a true assumption. KING-robust estimation is an alternative approach that does not need MAFs. This technique is more trusted in mixed-population datasets (unless the parents are from very different populations).</p> <p>In the GRLS study, use either technique can be used safely. Therefore, the KING-robust kinship estimator will be used in this tutorial. According to the PLINK2 documentation, the KING kinship coefficients are scaled such that duplicate samples have a kinship of 0.5.  Accordingly, first-degree relations (parent-child, full siblings) correspond to ~0.25, second-degree relations correspond to ~0.125, etc.  It is conventional to use a cutoff of ~0.354 (the geometric mean of 0.5 and 0.25) to screen for monozygotic twins and duplicate samples, ~0.177 to add first-degree relations, etc.</p>"}]}