{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"GRLS GWAS Tutorial","text":"<p>Golden Retrievers are one of the most popular breeds in the world, known for their friendly demeanor and beautiful golden coats. However, as with any breed, they are prone to specific health problems. Several GWAS studies were already done to uncover the underlying genetics of many disorders. Many of these studies need to be confirmed and many other phenotypes still need to be studied  </p> <p>The Golden Retriever Lifetime Study (GRLS) has a vast amount of phenotypic data collected from veterinarian records, and dog owners\u2019 questioners over years for 3,000+ dogs. In addition, the study has genotyped ~ 1.1 Million genetic markers using Axiom\u2122 Canine Genotyping Array Sets A and B. This reposatory should provide tutorials for handling of the GRLS phenotypic and genotypic data to produce successful GWAS studies. Also, we are building a growing list of resources to support these studies. </p>"},{"location":"#how-to-acess-the-grls-data","title":"How to acess the GRLS data?","text":""},{"location":"#21-genotyping-data","title":"2.1. Genotyping data","text":"<p>Affymetrix (thermofisher) Axiom Canine HD Array sets A and B were used to genotype the GRLS dogs. The data is avalible in PLINK and VCF formats. Instructions about geting access to the data will be announced soon.</p>"},{"location":"#22-phenotype-data","title":"2.2. Phenotype data","text":"<p>Morris Animal Foundation Data Commons provides open access to most of the data collected by the Golden Retriever Lifetime Study. An overview description of the study data can be found here. To download data tables, you need to register at the Data Commons.</p> <p></p> <p>Let's start the journey &gt;&gt;&gt;</p>"},{"location":"1.install/","title":"1. Environment Setup","text":""},{"location":"1.install/#11-install-conda","title":"1.1. Install conda","text":"<p>We are using conda to install software needed to run this tutorial. Here are the steps we used to install conda on a 64-bit computer with a Linux system using Mambaforge. For other operating systems, you can find detailed instructions here</p> <pre><code>wget https://github.com/conda-forge/miniforge/releases/latest/download/Mambaforge-Linux-x86_64.sh\nbash Mambaforge-Linux-x86_64.sh -b -p \"${HOME}/conda\"\n~/conda/bin/mamba init\nsource ~/.bashrc  # if you are using zsh then do `source ~/.zshrc`\n</code></pre>"},{"location":"1.install/#12-create-a-new-environment-and-install-software-packages","title":"1.2. Create a new environment and install software packages","text":"<p><pre><code>mamba create -n grGWAS\nmamba activate grGWAS\nmamba install -c bioconda plink plink2 bcftools gcta\nmamba install -c conda-forge r-base=4.3.1 r-ggplot2=3.4.2 r-gridextra=2.3 r-qqman=0.1.8\n</code></pre> </p>"},{"location":"2.Input_files/","title":"2. Input Description","text":""},{"location":"2.Input_files/#21-genotyping-data","title":"2.1. Genotyping data","text":"<ol> <li> <p>In this tutorial, we have the GRLS genotyping data of each array in a binary PLINK file format. You may use the PLINK documentation to read more about this file format. </p> <ul> <li>The files of array A have the prefix \"output/setA/export_plink/AxiomGT1.bin\"</li> <li>The files of array B have the prefix \"output/setB/export_plink/AxiomGT1.bin\".</li> </ul> <p>The genotyping files are accompanied by <code>genotyping_analysis_notes.docx</code> which has detailed information on the bioinformatic pipeline used for genotyping and all notes that should be considered before any further analysis. You can download this file separately from here</p> <p>Note: These PLINK files have the gender as predicted by the Axiom genotyping analysis tools which was not always consistant with the gender in the dog records. Check the genotyping analysis notes for details</p> </li> <li> <p>A text file that maps between sample IDs in the genotyping files, biological sample IDs, and the public IDs used in phenotype data files. Moreover, the file has gender information of the dogs as reported by their owners: <code>map_id_sex.tab</code></p> </li> </ol>"},{"location":"2.Input_files/#22-phenotype-data","title":"2.2. Phenotype data","text":"<p>In this tutorial, all phenotypes tables are located in a folder named <code>phenotypes</code>. We are using the Conditions - Neoplasia dataset as an example.</p> <p></p>"},{"location":"3.prep_arrays/","title":"3. Prep Array Sets","text":"<p>Genotyping data are provided as 2 datasets for Affymetrix (thermofisher) Axiom Canine HD Array sets A and B. We have to merge both datasets into one final dataset but this requires resolving replicate SNPs, known technical replicates, and gender conflicts. Moreover, we have to make sure that sample IDs in the genotyping files are matching to those in the phenotype files.     </p>"},{"location":"3.prep_arrays/#31-replicate-snps","title":"3.1. replicate SNPs","text":"<p>Both arrays has a number of replicate SNPs which are usefull for QC but also require special attention for proper merging of the files of both arrays. We are using a QC merging mode of PLINK to identify mismatching non-missing calls between the 2 arrays</p> <pre><code>plink --bfile output/setB/export_plink/AxiomGT1.bin --chr-set 38 no-xy --allow-no-sex --allow-extra-chr \\\n      --bmerge output/setA/export_plink/AxiomGT1.bin --merge-mode 7 \\\n      --output-chr 'chrM' --out AxiomGT1.mismatching7\n</code></pre> <p>Here is the output of this command</p> <p>3339 samples loaded from output/setB/export_plink/AxiomGT1.bin.fam.   3355 samples to be merged from output/setA/export_plink/AxiomGT1.bin.fam.   Of these, 17 are new, while 3338 are present in the base dataset.   547232 markers loaded from output/setB/export_plink/AxiomGT1.bin.bim.   397685 markers to be merged from output/setA/export_plink/AxiomGT1.bin.bim.   Of these, 368215 are new, while 29470 are present in the base dataset.   Warning: Variants 'Affx-206088448' and 'Affx-205939940' have the same position.   Warning: Variants 'Affx-205859745' and 'Affx-205344060' have the same position.   Warning: Variants 'Affx-206706550' and 'Affx-205359377' have the same position.   1460 more same-position warnings: see log file.   Performing 1-pass diff (mode 7), writing results to AxiomGT1.mismatching7.diff   98370860 overlapping calls, 97897061 non-missing in both filesets.   97593330 concordant, for a concordance rate of 0.996897.  </p> <p>The concordance rate of non-missing genotypes is pretty good (99.7%). However, we still have to handle two issues: </p> <ol> <li> <p>Mismatching genotypes: Let us have a closer look on the mismatching genotypes to see if they are uniformly distributed among the samples or not     <pre><code>tail -n+2 AxiomGT1.mismatching7.diff | awk '{print $2,$3}' | sort | uniq -c | sort -k1,1nr &gt; AxiomGT1.mismatching7.diff.samples\n</code></pre></p> <p>It seems that two samples show exceptional higher rate of mismatching (<code>GRLS S007258</code> and <code>GRLS S019740</code> have 11676 and 11440 mistmatches respectively. The latter sample is the only sample that was predicted to be female on Array A and male on array B according to the genotyping analysis notes). This likely indicates that these samples had something wrong. According to the the genotyping analysis notes, swapping the 2 samples on array B did not fix the issue. Therefore, we will exclude both samples from further analysis during the merging step. </p> </li> <li> <p>Variants having the same position: The mismatching analysis reveals 1463 markers that has the same position on both arrays but with different SNP IDs. Further digging in the array annotation showed that most of these markers are identical with minor differences in the flanking sequences. To avoid genotyping errors, we will exclude these SNPs from array B.</p> <pre><code>grep \"Warning: Variants .* have the same position\" AxiomGT1.mismatching7.log | awk -F\"'\" 'BEGIN{OFS=\"\\n\";}{print $2,$4}' &gt; same_pos.arrB.lst\nplink --bfile output/setB/export_plink/AxiomGT1.bin --chr-set 38 no-xy --allow-no-sex --allow-extra-chr \\\n  --exclude same_pos.arrB.lst \\\n  --make-bed --output-chr 'chrM' --out output/setB/export_plink/AxiomGT1.bin_noSamePos\n</code></pre> </li> </ol>"},{"location":"3.prep_arrays/#32-merging-of-array-sets-a-and-b-genotyping-data","title":"3.2. Merging of Array sets A and B Genotyping data","text":"<p>Now, we will merge the genotyping data of both arrays. For SNPs shared between the arrays, the genotypes of array A will overwrite the nonmissing calls in array B. Also, we will exclude the 2 samples with higher rates of non-concordance</p> <pre><code>echo \"GRLS S007258|GRLS S019740\" | tr '|' '\\n' &gt; swap_samples.lst\nplink --bfile output/setB/export_plink/AxiomGT1.bin_noSamePos --chr-set 38 no-xy --allow-no-sex --allow-extra-chr \\\n      --bmerge output/setA/export_plink/AxiomGT1.bin --merge-mode 3 \\\n      --remove swap_samples.lst \\\n      --make-bed --output-chr 'chrM' --out AxiomGT1v2.comp_merge\n</code></pre> <p>The output of the merging command gives some useful stastics</p> <p>...  Warning: 1355 het. haploid genotypes present (see AxiomGT1v2.comp_merge.hh );  Warning: Nonmissing nonmale Y chromosome genotype(s) present;  ...  Total genotyping rate in remaining samples is 0.994631.  913984 variants and 3354 samples pass filters and QC.  ...</p> <p>The first warning is is usually caused by male heterozygous calls in the X chromosome pseudo-autosomal region. Looking at <code>AxiomGT1v2.comp_merge.hh</code> shows that all the 1355 heterozygous haploid genotypes belong to sample <code>GRLS S005865</code>. According to the genotyping analysis notes, this sample is reported male in metadata as well as by the genotyping algorithm on Array B but the algorithm failed to predict its gender on array A. We will handle this sample later during the check for gender accuracy</p> <p>The second warning indicate that some nonmale samples have Y chromosome genotypes. Most PLINK commands treat these genotypes as missing. This behaviour is intended for safty however it makes it tricky to identify these markers. Here is some workaround to find these markers</p> <p><pre><code>mkdir -p temp_nonmale\ncat AxiomGT1v2.comp_merge.fam | awk '{if($5==\"2\")print}' &gt; temp_nonmale/female.lst\nplink --bfile AxiomGT1v2.comp_merge --chr-set 38 no-xy --allow-no-sex --allow-extra-chr \\\n      --keep temp_nonmale/female.lst --chr y \\\n      --recode --output-chr 'chrM' --out temp_nonmale/AxiomGT1v2.comp_merge.fe\n\nsed -i 's/chrY/chr_notY/' temp_nonmale/AxiomGT1v2.comp_merge.fe.map\n\nplink --file temp_nonmale/AxiomGT1v2.comp_merge.fe --chr-set 38 no-y --allow-no-sex --allow-extra-chr \\\n      --freq counts \\\n      --output-chr 'chrM' --out temp_nonmale/AxiomGT1v2.comp_merge.fe.explore\ntail -n+2 temp_nonmale/AxiomGT1v2.comp_merge.fe.explore.frq.counts | awk '{if($5!=0 || $6!=0)print}' | wc -l\n</code></pre> We were able to identify 37 markers nonmissing Y chromosome genotypes in females. These markers could be in the psudoautosomal region but unfortunately we do not have known boundries to those regions in dogs. As mentioned above, it is safe to ignore these markers in PLINK </p>"},{"location":"3.prep_arrays/#33-identification-and-removal-of-duplicate-samples","title":"3.3. Identification and removal of duplicate samples","text":"<p>Plink2 has an efficient function to calculate the KING-robust knickship estimator and filter duplicate samples as well. Duplicate samples have kinship coefficients ~0.5, first-degree relations (parent-child, full siblings) correspond to ~0.25, second-degree relations correspond to ~0.125, etc. Here, we are using the conventional cufoff ~0.354 (the geometric mean of 0.5 and 0.25) to identify and filter duplicate samples</p> <pre><code>plink2 --bfile AxiomGT1v2.comp_merge --chr-set 38 no-xy --allow-no-sex --allow-extra-chr \\\n       --king-cutoff 0.354 \\\n       --out AxiomGT1v2.comp_merge.nodup\n</code></pre> <p>Now, let us compare the files selected to be removed by Plink2 knickship versus the list of samples planned to run in duplicates. This code will identify all the samples planned to run in duplicates then find those remaining after exlcusion of the samples selected by the Plink2 knickship filter. We are expecting one replicate to remain from each group of replicate samples  <pre><code>awk 'BEGIN{FS=OFS=\"\\t\"}FNR==NR{a[$3]+=1;next}/^Family_ID/{print}{if(a[$3]&gt;1)print}' map_id_sex.tab map_id_sex.tab &gt; dup_samples.tab\nawk 'BEGIN{FS=OFS=\"\\t\"}FNR==NR{a[$1 FS $2]=1;next}{if(!a[$1 FS $2])print $0}' AxiomGT1v2.comp_merge.nodup.king.cutoff.out.id dup_samples.tab &gt; dup_samples_remain.tab\ntail -n+2 dup_samples_remain.tab | cut -f3 | sort | uniq -c | sort -k1,1nr\n</code></pre> Hear is the list of the remaining duplicates and their counts</p> <p>2 \u00a0\u00a0\u00a0 094-027376    1 \u00a0\u00a0\u00a0 094-002188    1 \u00a0\u00a0\u00a0 094-002396    1 \u00a0\u00a0\u00a0 094-002995    .    . </p> <p>It seems that 2 duplicates of sample <code>094-027376</code> are still remaining! Let's try to calculate their KING knickship to see how similar they are: <pre><code>grep 094-027376 dup_samples.tab &gt; failed_deDup.lst\nplink2 --bfile AxiomGT1v2.comp_merge --chr-set 38 no-xy --allow-no-sex --allow-extra-chr \\\n       --keep failed_deDup.lst --make-king-table \\\n       --out AxiomGT1v2.comp_merge.failed_deDup\ncat AxiomGT1v2.comp_merge.failed_deDup.kin0\n</code></pre></p> <p>Here is the output.</p> FID1 ID1 FID2 ID2 NSNP HETHET IBS0 KINSHIP GRLS S027376_2 GRLS S027376_1 879956 0.0645396 0.0414475 -0.0559478 <p>It is obvious that these two samples are unlrelated. Therefore, we will exclude both of them with the duplicate samples selected by the Plink2 knickship filter. These are 120 samples in total so we will end up having 3234 samples in our output PLINK file <pre><code>plink2 --bfile AxiomGT1v2.comp_merge --chr-set 38 no-xy --allow-no-sex --allow-extra-chr \\\n       --remove &lt;(cat AxiomGT1v2.comp_merge.nodup.king.cutoff.out.id failed_deDup.lst) \\\n       --make-bed --output-chr 'chrM' --out AxiomGT1v2.comp_merge.deDup\n</code></pre></p>"},{"location":"3.prep_arrays/#34-check-for-gender-accuracy-remove-samples-with-wrong-gender-identities","title":"3.4. Check for gender accuracy &amp; remove samples with wrong gender identities","text":"<p>According to the genotyping analysis notes, there are two samples <code>GRLS S019740</code> and <code>GRLS S005865</code> that had discordant computed gender on the two arrays. The former was removed already because of the high rate of mismatching genotypes between the 2 arrays (see 3.1. replicate SNPs). The latter showed high rate heterozygous haploid genotypes despite being reported as male in metadata (see 3.2. Merging of Array sets). We will discard this sample from further analysis.</p> <p>Moreover, there are additional 9 samples with concordant gender on both arrays but different from the metadata. We can reproduce this information by known gender in metadata versus the computed gender based on genotyping data <pre><code>echo \"Family_ID Individual_ID computed_sex metadata_sex\" | tr ' ' '\\t' &gt; gender_conflict.lst\nawk 'BEGIN{FS=OFS=\"\\t\"}FNR==NR{a[$1 FS $2]=$5;next}{if(a[$1 FS $2] &amp;&amp; a[$1 FS $2]!=$5)print $1,$2,$5,a[$1 FS $2]}' map_id_sex.tab AxiomGT1v2.comp_merge.deDup.fam &gt;&gt; gender_conflict.lst\n</code></pre></p> <p>Wrong gender could be a mistake in the metadata or an indication for sample swap. Therefore, it is safer to exclude these samples from our genotyping data <pre><code>echo \"GRLS S005865\" | tr ' ' '\\t' &gt;&gt; gender_conflict.lst\nplink2 --bfile AxiomGT1v2.comp_merge.deDup --chr-set 38 no-xy --allow-no-sex --allow-extra-chr \\\n       --remove gender_conflict.lst \\\n       --make-bed --output-chr 'chrM' --out AxiomGT1v2.comp_merge.deDup.sexConfirm\n</code></pre> The output of our last PLINK command indeicate that our final file has 3224 samples (1615 females, 1609 males; 3224 founders)</p>"},{"location":"3.prep_arrays/#35-update-sample-ids-in-the-genotyping-files-to-match-the-phenotyping-files","title":"3.5. Update sample IDs in the genotyping files to match the phenotyping files","text":"<p>The data tables at Morris Animal Foundation Data Commons are using grls_ids (e.g. 094-000019) or public_ids (e.g. grlsH764T844). In this step, we will upadate the sample IDs in our genotyping files to match the grls_ids using the <code>map_id_sex.tab</code> file that maps between different types of IDs <pre><code>tail -n+2 map_id_sex.tab | awk 'BEGIN{FS=OFS=\"\\t\"}{print $1,$2,$1,$3}' &gt; grls_id.update.lst \nplink2 --bfile AxiomGT1v2.comp_merge.deDup.sexConfirm --chr-set 38 no-xy --allow-no-sex --allow-extra-chr \\\n       --update-ids grls_id.update.lst \\\n       --make-bed --output-chr 'chrM' --out AxiomGT1v2.comp_merge.deDup.sexConfirm.grls_ids\n</code></pre></p> <p>We can also do the same to upadate the sample IDs in our genotyping files to match the public_ids <pre><code>tail -n+2 map_id_sex.tab | awk 'BEGIN{FS=OFS=\"\\t\"}{print $1,$2,$1,$4}' &gt; public_ids.update.lst \nplink2 --bfile AxiomGT1v2.comp_merge.deDup.sexConfirm --chr-set 38 no-xy --allow-no-sex --allow-extra-chr \\\n       --update-ids public_ids.update.lst \\\n       --make-bed --output-chr 'chrM' --out AxiomGT1v2.comp_merge.deDup.sexConfirm.public_ids\n</code></pre></p>"},{"location":"4.qc_filter/","title":"4. QC & filtration","text":"<p>Careful QC of genotyping data is an important step toward a successful GWAS. We need to exclude samples and/or variants that does not meet our quality expectations. </p>"},{"location":"4.qc_filter/#41-identifcation-of-1st-degree-relatives","title":"4.1. Identifcation of 1st degree relatives","text":"<p>Genotyping data can be used to assess sample-distances and thus identify sample duplications.  We will use 0.177 (the geometric mean of 0.25 and 0.125) as cutoff for the KING knickship  coeffiecients to identify 1st degree relatives.</p> <pre><code>plink2 --bfile AxiomGT1v2.comp_merge.deDup.sexConfirm.grls_ids --chr-set 38 no-xy --allow-extra-chr \\\n       --king-cutoff 0.177 \\\n       --out AxiomGT1v2.1st_degree_relatives\n</code></pre> <p>Let us remove those relatives to avoid inflation of false associations in our GWAS</p> <pre><code>plink2 --bfile AxiomGT1v2.comp_merge.deDup.sexConfirm.grls_ids --chr-set 38 no-xy --allow-extra-chr \\\n       --remove AxiomGT1v2.1st_degree_relatives.king.cutoff.out.id \\\n       --make-bed --output-chr 'chrM' --out AxiomGT1v2.noRelatives\n</code></pre>"},{"location":"4.qc_filter/#42-explore","title":"4.2. Explore","text":"<p>We use Plink commands to assess heterozygosity, missing genotyping, allele frequency, and hardy-weinberg equilibrium (HWE). The output are the files ending in \".het\", \".imiss (Per-individual)/.lmiss (per-variant)\", \".frq\", and \".hwe\" </p> <pre><code>mkdir -p inspect\nplink --bfile AxiomGT1v2.noRelatives --chr-set 38 no-xy --allow-extra-chr \\\n      --het --missing --freq --hardy 'midp'  \\\n      --output-chr 'chrM' --out inspect/AxiomGT1v2.noRelatives.explore\n\n# We currentlky have:\n# 913984 variants loaded from .bim file.\n# 2519 samples (1279 males, 1240 females) loaded from .fam.\n</code></pre> <p>Note: The 'midp' modifier of the command <code>--hardy</code> applies the mid-p adjustment described here. The mid-p adjustment tends to bring the null rejection rate in line with the nominal p-value, and also reduces the filter's tendency to favor retention of variants with missing data</p>"},{"location":"4.qc_filter/#421-extreme-cases-of-heterozygosity","title":"4.2.1. Extreme cases of heterozygosity:","text":"<p><pre><code>awk -v size=0.02 'BEGIN{OFS=\"\\t\";bmin=bmax=0}{ b=int($6/size); a[b]++; bmax=b&gt;bmax?b:bmax; bmin=b&lt;bmin?b:bmin } END { for(i=bmin;i&lt;=bmax;++i){if(i==0) print -1*size,size,a[i]/1;else if(i&lt;0) print (i-1)*size,i*size,a[i]/1;else print i*size,(i+1)*size,a[i]/1 }}'  &lt;(tail -n+2 inspect/AxiomGT1v2.noRelatives.explore.het) &gt; inspect/AxiomGT1v2.noRelatives.explore.het.histo \n\ncat inspect/AxiomGT1v2.noRelatives.explore.het | awk '{if($6&gt;0.3)print}' &gt;  inspect/AxiomGT1v2.noRelatives.explore.het.high ## high homozygosity\n\ncat inspect/AxiomGT1v2.noRelatives.explore.het | awk '{if(NR==1)print}{if($6&lt;-0.3)print}' &gt;  inspect/AxiomGT1v2.noRelatives.explore.het.low ## low homozygosity\n</code></pre> We can see at least 2 extreme cases. High heterozygosity may indicate sample contamination, however high homozygosity might just indicate higher inbreeding</p>"},{"location":"4.qc_filter/#422-genotype-missingness-in-samples-and-variants","title":"4.2.2. Genotype Missingness in samples and variants:","text":"<p><pre><code>awk -v size=0.02 'BEGIN{OFS=\"\\t\";bmin=bmax=0}{ b=int($6/size); a[b]++; bmax=b&gt;bmax?b:bmax; bmin=b&lt;bmin?b:bmin } END { for(i=bmin;i&lt;=bmax;++i) print i*size,(i+1)*size,a[i]/1 }'  &lt;(tail -n+2 inspect/AxiomGT1v2.noRelatives.explore.imiss) &gt; inspect/AxiomGT1v2.noRelatives.explore.imiss.histo \n\nawk -v size=0.02 'BEGIN{OFS=\"\\t\";bmin=bmax=0}{ b=int($5/size); a[b]++; bmax=b&gt;bmax?b:bmax; bmin=b&lt;bmin?b:bmin } END { for(i=bmin;i&lt;=bmax;++i) print i*size,(i+1)*size,a[i]/1 }'  &lt;(tail -n+2 inspect/AxiomGT1v2.noRelatives.explore.lmiss) &gt; inspect/AxiomGT1v2.noRelatives.explore.lmiss.histo \n</code></pre> Missingness per individual shows 13 samples with about ~57% genotyping rates. These samples were genotyped on one array but not the other. While missingness per variant shows 36 extreme variants with about 50% genotyping rates</p>"},{"location":"4.qc_filter/#423-variants-with-very-low-maf","title":"4.2.3. Variants with very low MAF:","text":"<p><pre><code>awk -v size=0.01 'BEGIN{OFS=\"\\t\";bmin=bmax=0}{ b=int($5/size); a[b]++; bmax=b&gt;bmax?b:bmax; bmin=b&lt;bmin?b:bmin } END { for(i=bmin;i&lt;=bmax;++i) print i*size,(i+1)*size,a[i]/1 }'  &lt;(tail -n+2 inspect/AxiomGT1v2.noRelatives.explore.frq) &gt; inspect/AxiomGT1v2.noRelatives.explore.frq.histo \n\nawk -v size=0.001 'BEGIN{OFS=\"\\t\";bmin=bmax=0}{ b=int($5/size); a[b]++; bmax=b&gt;bmax?b:bmax; bmin=b&lt;bmin?b:bmin } END { for(i=bmin;i&lt;=bmax;++i) print i*size,(i+1)*size,a[i]/1 }'  &lt;(tail -n+2 inspect/AxiomGT1v2.noRelatives.explore.frq) &gt; inspect/AxiomGT1v2.noRelatives.explore.frq.histo2 \n</code></pre> There are 331344 markers that have &lt; 1% MAF, 278461 markers have &lt; 0.1% MAF &amp; 314175 markers have &lt; 0.5% MAF</p>"},{"location":"4.qc_filter/#424-markers-with-significant-diviation-from-hwe","title":"4.2.4. Markers with significant diviation from HWE","text":"<pre><code>awk 'BEGIN{OFS=\"\\t\";}{ if($9&lt;1e-50)a[\"1e-50 or less\"]++;\n                       else if($9&lt;1e-40)a[\"1e-40:1e-50\"]++; else if($9&lt;1e-30)a[\"1e-30:1e-40\"]++; \\\n                       else if($9&lt;1e-20)a[\"1e-20:1e-30\"]++; else if($9&lt;1e-10)a[\"1e-10:1e-20\"]++; \\\n                       else if($9&lt;1e-9)a[\"1e-9:1e-10\"]++; else if($9&lt;1e-8)a[\"1e-8:1e-9\"]++; \\\n                       else if($9&lt;1e-7)a[\"1e-7:1e-8\"]++; else if($9&lt;1e-6)a[\"1e-6:1e-7\"]++; \\\n                       else if($9&lt;1e-5)a[\"1e-5:1e-6\"]++; else if($9&lt;1e-4)a[\"1e-4:1e-5\"]++; \\\n                       else if($9&lt;0.001)a[\"1e-3:1e-4\"]++; else if($9&lt;0.01)a[\"1e-2:1e-3\"]++; } \\\n                 END { for(i in a) print i,a[i] }'  &lt;(tail -n+2 inspect/AxiomGT1v2.noRelatives.explore.hwe) | sort -g &gt; inspect/AxiomGT1v2.noRelatives.explore.hwe.histo\n\n## Let's have a look on those variants with extreme diviation from HWE\ncat inspect/AxiomGT1v2.noRelatives.explore.hwe | awk '{if(NR==1)print}{if($9&lt;1e-50 )print}' &gt;  inspect/AxiomGT1v2.noRelatives.explore.hwe.low \n</code></pre> <p>Serious genotyping errors often yield extreme p-values, therefore a cut-off like 1e-50 is usually advised to exclude these variants. However, I believe this is ok in populations where reasonable random mating is expected. Dog breeds are subjected to high selective breeding and artificial selection and thus I prefer excluding cases with extreme heterozygosity instead of apply any HWE-based filtering </p>"},{"location":"4.qc_filter/#43-filter","title":"4.3. Filter","text":"<p><pre><code>echo \"Oldies 094-040059\" &gt; het_excess.lst\nplink --bfile AxiomGT1v2.noRelatives --chr-set 38 no-xy --allow-extra-chr \\\n      --geno 0.05 --mind 0.05 --maf 0.01 \\\n      --remove het_excess.lst\\\n      --make-bed --output-chr 'chrM' --out AxiomGT1v2.noRelatives.filtered\n</code></pre> Now, we have 582519 variants and 2505 samples that passed filters and QC.</p>"},{"location":"4.qc_filter/#44-linkage-disequilibrium-ld-analysis","title":"4.4. linkage disequilibrium (LD) analysis","text":""},{"location":"4.qc_filter/#441-ld-estimation","title":"4.4.1 LD estimation","text":"<ul> <li>--r2 reports squared inter-variant allele count correlations</li> <li>'in-phase' adds a column with in-phase allele pairs</li> <li>'dprime' adds the absolute value of Lewontin's D-prime statistic</li> </ul> <pre><code>plink --bfile AxiomGT1v2.noRelatives.filtered --chr-set 38 no-xy --allow-extra-chr \\\n      --r2 'in-phase' 'dprime' \\\n      --output-chr 'chrM' --out inspect/AxiomGT1v2.noRelatives.filtered.stats\n\nawk -v size=0.01 'BEGIN{OFS=\"\\t\";bmin=bmax=0}{ b=int($8/size); a[b]++; bmax=b&gt;bmax?b:bmax; bmin=b&lt;bmin?b:bmin } END { for(i=bmin;i&lt;=bmax;++i) print i*size,(i+1)*size,a[i]/1 }'  &lt;(tail -n+2 inspect/AxiomGT1v2.noRelatives.filtered.stats.ld) &gt; inspect/AxiomGT1v2.noRelatives.filtered.stats.ld.r2_histo ## 128035 sequential markers have complete linkage\nawk -v size=0.01 'BEGIN{OFS=\"\\t\";bmin=bmax=0}{ b=int($9/size); a[b]++; bmax=b&gt;bmax?b:bmax; bmin=b&lt;bmin?b:bmin } END { for(i=bmin;i&lt;=bmax;++i) print i*size,(i+1)*size,a[i]/1 }'  &lt;(tail -n+2 inspect/AxiomGT1v2.noRelatives.filtered.stats.ld) &gt; inspect/AxiomGT1v2.noRelatives.filtered.stats.ld.dprime_histo\n</code></pre>"},{"location":"4.qc_filter/#442-ld-pruning","title":"4.4.2 LD pruning","text":"<p>We will prune pairwise SNPs with R2 &gt;\u2009 0.2 (using windows of 100 SNPs and step size of 10 SNPs)</p> <pre><code>plink --bfile AxiomGT1v2.noRelatives.filtered --chr-set 38 no-xy --allow-extra-chr \\\n      --indep-pairwise 100 10 0.2 \\\n      --output-chr 'chrM' --out AxiomGT1v2.noRelatives.filtered.LD_lst ## 567586 of 582519 variants to be removed.\n\nplink --bfile AxiomGT1v2.noRelatives.filtered --chr-set 38 no-xy --allow-extra-chr \\\n      --extract AxiomGT1v2.noRelatives.filtered.LD_lst.prune.in \\\n      --make-bed --output-chr 'chrM' --out AxiomGT1v2.noRelatives.filtered.LD_prune ## 14933 variants remaining\n</code></pre>"},{"location":"4.qc_filter/#443-ld-re-evaluation","title":"4.4.3 LD re-evaluation","text":"<pre><code>plink --bfile AxiomGT1v2.noRelatives.filtered.LD_prune --chr-set 38 no-xy --allow-extra-chr \\\n      --freq --r2 'in-phase' 'dprime' \\\n      --output-chr 'chrM' --out inspect/AxiomGT1v2.noRelatives.filtered.LD_prune.stats\n\nawk -v size=0.01 'BEGIN{OFS=\"\\t\";bmin=bmax=0}{ b=int($8/size); a[b]++; bmax=b&gt;bmax?b:bmax; bmin=b&lt;bmin?b:bmin } END { for(i=bmin;i&lt;=bmax;++i) print i*size,(i+1)*size,a[i]/1 }'  &lt;(tail -n+2 inspect/AxiomGT1v2.noRelatives.filtered.LD_prune.stats.ld) &gt; inspect/AxiomGT1v2.noRelatives.filtered.LD_prune.stats.ld.r2_histo\n\nawk -v size=0.01 'BEGIN{OFS=\"\\t\";bmin=bmax=0}{ b=int($9/size); a[b]++; bmax=b&gt;bmax?b:bmax; bmin=b&lt;bmin?b:bmin } END { for(i=bmin;i&lt;=bmax;++i) print i*size,(i+1)*size,a[i]/1 }'  &lt;(tail -n+2 inspect/AxiomGT1v2.noRelatives.filtered.LD_prune.stats.ld) &gt; inspect/AxiomGT1v2.noRelatives.filtered.LD_prune.stats.ld.dprime_histo\n\nawk -v size=0.001 'BEGIN{OFS=\"\\t\";bmin=bmax=0}{ b=int($5/size); a[b]++; bmax=b&gt;bmax?b:bmax; bmin=b&lt;bmin?b:bmin } END { for(i=bmin;i&lt;=bmax;++i) print i*size,(i+1)*size,a[i]/1 }'  &lt;(tail -n+2 inspect/AxiomGT1v2.noRelatives.filtered.LD_prune.stats.frq) &gt; inspect/AxiomGT1v2.noRelatives.filtered.LD_prune.stats.frq.histo2 ## 278461 markers have &lt; 0.1% MAF &amp; 314175 markers have &lt; 0.5% MAF\n\npaste inspect/AxiomGT1v2.noRelatives.filtered.stats.ld.r2_histo inspect/AxiomGT1v2.noRelatives.filtered.LD_prune.stats.ld.r2_histo | less\n</code></pre>"},{"location":"4.qc_filter/#45-pca","title":"4.5. PCA","text":"<p>The <code>--pca</code> function in Plink2, similar to GCTA, extracts top principal components from the variance-standardized relationship matrix (i.e. genomic relationship matrix)</p> <pre><code>plink2 --bfile AxiomGT1v2.noRelatives.filtered.LD_prune --chr-set 38 no-xy --allow-extra-chr \\\n       --autosome --pca \\\n       --output-chr 'chrM' --out inspect/AxiomGT1v2.noRelatives.filtered.LD_prune.pca\n</code></pre> <p>I dentify the principle components that explain most of the variance:  <pre><code>Rscript -e 'val &lt;- read.table(\"inspect/AxiomGT1v2.noRelatives.filtered.LD_prune.pca.eigenval\");'\\\n'val$varPerc &lt;- val$V1/sum(val$V1);'\\\n'jpeg(file = \"inspect/Var_PCs.jpg\");'\\\n'plot( x = seq(1:length(val$varPerc)), y = val$varPerc, type = \"o\",xlab = \"Principle Component\", ylab = \"Variance explained in %\");'\\\n'dev.off();'\n</code></pre></p> <p></p> <p>Plot the main principle components: <pre><code>Rscript -e 'require(ggplot2);require(gridExtra);'\\\n'eigenvec &lt;- read.table(\"inspect/AxiomGT1v2.noRelatives.filtered.LD_prune.pca.eigenvec\", header = TRUE, comment.char=\"\");'\\\n'eigenvec$X.FID &lt;-  as.factor(eigenvec$X.FID);'\\\n'plot1 &lt;- ggplot(eigenvec, aes(x = PC1, y = PC2, col = X.FID)) + geom_point() + labs(title = \"PCA Plot\", x = \"PC1\", y = \"PC2\");'\\\n'plot2 &lt;- ggplot(eigenvec, aes(x = PC3, y = PC4, col = X.FID)) + geom_point() + labs(title = \"PCA Plot\", x = \"PC3\", y = \"PC4\");'\\\n'plot3 &lt;- ggplot(eigenvec, aes(x = PC1, y = PC3, col = X.FID)) + geom_point() + labs(title = \"PCA Plot\", x = \"PC1\", y = \"PC3\");'\\\n'plot4 &lt;- ggplot(eigenvec, aes(x = PC2, y = PC3, col = X.FID)) + geom_point() + labs(title = \"PCA Plot\", x = \"PC2\", y = \"PC3\");'\\\n'combined_plot &lt;- grid.arrange(plot1, plot2, plot3, plot4, nrow = 2);'\\\n'ggsave(\"inspect/pca_plot.png\", combined_plot, width = 12, height = 8, dpi = 400);'\n</code></pre></p> <p></p> <p>An additional tutorial of possible admixture analysis is here </p>"},{"location":"5.pheno/","title":"5. Study design","text":"<p>Our phenotype of interest will define the GWAS design. Some phenotypes are quantitative like body mass index or fasting blood glucose while other are qualitative, binary phenotypes (e.g., Case/Control studies). Each type requires special preparation of the input data, proper selection of the statistical tests, and mindful interpretation of the final results. In this tutorial, we have an example for a Case/Control study.  </p> <p>To start, we have to select our cases and control based on the inclusion and exclusion criteria in our project. Accordingly, we should subset our genotypic and phenotypic data. Then, we need to assess the possible correlation of our phenotype with the genetic principal components in the studied population.  Also, we have to identify the possible covarites that might affect our phenotype of interest but we will do it during the assessment of heritability of out phenotype in the studied population. </p>"},{"location":"5.pheno/#51-identify-affected-cases-until-last-year","title":"5.1. Identify affected cases until last year","text":"<p>Most of the input files are designed to have 2 rows for each new year of study. The 1st row records the new phenotypes diagnosed only in that study year while the 2nd row records all phenotypes diagnosed from baseline through that study year. The column <code>to_date</code> is encoded 0 for the former and 1 for the latter. You can read more about the design of each table in the Data Commons of Morris Animal Foundation.</p> <pre><code># Define and create the GWAS output folder\ngwas=\"gwas_output\" &amp;&amp; mkdir -p \"$gwas\"\n\n# Identify the 2nd row of the last year of study for each dog\ncat phenotypes/conditions_skin.csv | awk 'BEGIN{FS=\",\"}\\\n    NR==1{print $0;next}{if ($5==1) {\\\n    if (!($1 in max_year) || $3 &gt; max_year[$1]) {\n        max_year[$1] = $3;\n        line[$1] = $0;\n    }}}END{for (id in line) {print line[id];}}' | tr ',' '\\t' &gt; \"$gwas\"/conditions_skin_lastYear.tab\n</code></pre>"},{"location":"5.pheno/#52-explore-the-numbers-of-cases-for-each-phenotype","title":"5.2. Explore the numbers of cases for each phenotype","text":"<pre><code># Get the number of columns in the header\nnum_columns=$(head -n 1 \"$gwas/conditions_skin_lastYear.tab\" | awk -F\"\\t\" '{print NF}')\n\n# Loop over each column from the third till the last, and print the sum\nfor ((i=7; i&lt;=$num_columns; i++)); do\n    awk -v col=\"$i\" 'BEGIN{FS=OFS=\"\\t\"}NR==1{dis=$col;next}{sum+=$col} END {print dis,sum}' \"$gwas\"/conditions_skin_lastYear.tab\ndone &gt; \"$gwas\"/conditions_skin.no_of_cases\n</code></pre>"},{"location":"5.pheno/#53-sample-selection","title":"5.3. Sample selection","text":""},{"location":"5.pheno/#531-select-cases-of-a-target-phenotype","title":"5.3.1 Select \"cases\" of a target phenotype","text":"<pre><code>target=\"atopy\"\nTcol=$(head -n 1 \"$gwas/conditions_skin_lastYear.tab\" | awk -F\"\\t\" -v pheno=\"$target\" '{for (i=7; i&lt;=NF; i++){if($i==pheno)print i}}')\nawk -v Tcol=\"$Tcol\" 'BEGIN{FS=OFS=\"\\t\"}NR==1{print;next}{if($Tcol==\"1\")print}' \"$gwas\"/conditions_skin_lastYear.tab &gt; \"$gwas\"/conditions_${target}_lastYear.tab\n\ntail -n+2 \"$gwas\"/conditions_${target}_lastYear.tab | cut -f1 &gt; \"$gwas\"/${target}_cases.ids\n</code></pre>"},{"location":"5.pheno/#532-check-for-co-existing-conditions","title":"5.3.2 Check for co-existing conditions","text":"<p><pre><code>for ((i=7; i&lt;=$num_columns; i++)); do\n    awk -v col=\"$i\" 'BEGIN{FS=OFS=\"\\t\"}NR==1{dis=$col;next}{sum+=$col} END {if(sum)print dis,sum}' \"$gwas\"/conditions_${target}_lastYear.tab\ndone\n</code></pre> For now, we will not exclude any samples from cases</p>"},{"location":"5.pheno/#533-identify-individuals-to-be-excluded-from-controls","title":"5.3.3. Identify individuals to be excluded from controls","text":"<pre><code>grep 'allergic_reaction\\|seasonal_allergy\\|angioedema\\|facial_edema\\|.*_dermatitis\\|r_o_atopy\\|vaccine_reaction' \"$gwas\"/conditions_skin.no_of_cases &gt; \"$gwas\"/${target}.to_be_excluded.lst\nwhile read offTarget;do\n  echo $offTarget\n  offTcol=$(head -n 1 \"$gwas\"/conditions_skin_lastYear.tab | awk -F\"\\t\" -v pheno=\"$offTarget\" '{for (i=7; i&lt;=NF; i++){if($i==pheno)print i}}')\n  awk -F\"\\t\" -v Tcol=\"$Tcol\" -v offTcol=\"$offTcol\" 'NR&gt;1{if($Tcol!=\"1\" &amp;&amp; $offTcol==\"1\")print $1}' \"$gwas\"/conditions_skin_lastYear.tab\ndone &lt; &lt;(cut -f1 \"$gwas\"/${target}.to_be_excluded.lst) | sort | uniq &gt; \"$gwas\"/${target}.to_be_excluded.ids\n</code></pre>"},{"location":"5.pheno/#54-remove-the-excluded-samples-from-the-genotyping-dataset","title":"5.4. Remove the excluded samples from the genotyping dataset","text":"<p><pre><code>cat \"$gwas\"/${target}.to_be_excluded.ids | grep -Fwf - AxiomGT1v2.noRelatives.filtered.LD_prune.fam &gt; \"$gwas\"/${target}.to_be_excluded.samples\nplink --bfile AxiomGT1v2.noRelatives.filtered.LD_prune --chr-set 38 no-xy --allow-extra-chr \\\n      --remove \"$gwas\"/${target}.to_be_excluded.samples --maf 0.01 \\\n      --make-bed --output-chr 'chrM' --out \"$gwas\"/AxiomGT1v2.noRelatives.filtered.LD_prune.${target}\n</code></pre> There are 14885 variants and 2093 samples that passed filters and QC.</p>"},{"location":"5.pheno/#55-generate-the-phenotype-file","title":"5.5. generate the phenotype file","text":"<pre><code>awk 'FNR==NR{a[$1]=1;next}{if(!a[$2])print $1,$2,\"1\";else print $1,$2,\"2\";}' \"$gwas\"/${target}_cases.ids \"$gwas\"/AxiomGT1v2.noRelatives.filtered.LD_prune.${target}.fam &gt; \"$gwas\"/${target}.pheno\ncat \"$gwas\"/${target}.pheno | cut -d\" \" -f3 | sort | uniq -c ## we have 326 cases and 1767 controls\n</code></pre>"},{"location":"5.pheno/#56-assess-distribution-of-cases-in-pca","title":"5.6. Assess distribution of cases in PCA","text":"<pre><code>plink2 --bfile \"$gwas\"/AxiomGT1v2.noRelatives.filtered.LD_prune.${target} --chr-set 38 no-xy --allow-extra-chr \\\n       --autosome --pca \\\n       --output-chr 'chrM' --out \"$gwas\"/AxiomGT1v2.noRelatives.filtered.LD_prune.${target}.pca\n\nRscript -e 'args=(commandArgs(TRUE));require(ggplot2);require(gridExtra);'\\\n'eigenvec &lt;- read.table(paste(args[1],\"/AxiomGT1v2.noRelatives.filtered.LD_prune.\",args[2],\".pca.eigenvec\",sep=\"\"), header = TRUE, comment.char=\"\");'\\\n'pheno &lt;- read.table(paste(args[1],\"/\",args[2],\".pheno\",sep=\"\"), header = FALSE, comment.char=\"\");'\\\n'names(pheno) &lt;- c(\"FID\", \"IID\", \"pheno\");'\\\n'pheno$pheno[pheno$pheno == \"1\"] &lt;- \"Unaffected\";pheno$pheno[pheno$pheno == \"2\"] &lt;- \"Affected\";'\\\n'ph_eigenvec &lt;-  merge(pheno, eigenvec, by = \"IID\");'\\\n'ph_eigenvec$pheno &lt;-  as.factor(ph_eigenvec$pheno);'\\\n'plot1 &lt;- ggplot(ph_eigenvec, aes(x = PC1, y = PC2, col = pheno)) + geom_point() + labs(title = \"PCA Plot\", x = \"PC1\", y = \"PC2\");'\\\n'plot2 &lt;- ggplot(ph_eigenvec, aes(x = PC3, y = PC4, col = pheno)) + geom_point() + labs(title = \"PCA Plot\", x = \"PC3\", y = \"PC4\");'\\\n'plot3 &lt;- ggplot(ph_eigenvec, aes(x = PC1, y = PC3, col = pheno)) + geom_point() + labs(title = \"PCA Plot\", x = \"PC1\", y = \"PC3\");'\\\n'plot4 &lt;- ggplot(ph_eigenvec, aes(x = PC2, y = PC3, col = pheno)) + geom_point() + labs(title = \"PCA Plot\", x = \"PC2\", y = \"PC3\");'\\\n'combined_plot &lt;- grid.arrange(plot1, plot2, plot3, plot4, nrow = 2);'\\\n'ggsave(paste(args[1],\"/pca_plot_\",args[2],\".png\",sep=\"\"), combined_plot, width = 12, height = 8, dpi = 400);' \"$gwas\" \"${target}\"\n</code></pre>"},{"location":"6.heritability/","title":"6. Heritability","text":"<p>It is meaningless to perform a genomic association study with a phenotype unless it is heritable. Preceding studies are needed to determine heritability estimates specially for complex traits; however, this is out of our scope here. By heritability assessment, we mean estimating the proportion of variance in our phenotype explained by the genotyped SNPs. Later, we should calculate how much of this heritability was captured by the selected markers.   </p> <p>We are using GCTA software to perform the GREML analysis for heritability assessment </p> <p>The <code>--reml</code> command of GCTA estimates the proportion of phenotypic variance that can be explained by SNPs. Here is a more detailed explaination of the GREML method and the undelying linear mixed model. </p> <p>In brief, GREML utilizes the genetic relationships between individuals in a sample population, captured in a genomic relationship matrix (GRM), to partition the phenotypic variance into its genetic and residual components. By fitting a linear mixed model, GREML estimates the proportion of variance attributable to all SNPs.</p> <p>The summary result of REML analysis will be saved in a plain text file (*.hsq).</p>"},{"location":"6.heritability/#61-gcta-grm","title":"6.1. GCTA-GRM","text":"<ul> <li>This command calculates the genetic relationship matrix (GRM) from all the autosomal SNPs.</li> <li>GCTA receives PLINK binary PED files as input. However, we have to tweak our Plink files to update the chromosome names into a numerical format and remove all extra chromosmes.  </li> <li>Data needs to be filtered to remove rare SNPs (e.g. --maf 0.01), and cryptic relatedness (e.g. --grm-cutoff 0.025). Our dataset does not need any further filtration</li> </ul> <pre><code>## a) Prepare the Plink input files\nmkdir -p gcta\nplink --bfile AxiomGT1v2.noRelatives.filtered.LD_prune --chr-set 38 no-xy --allow-extra-chr '0' \\\n      --make-bed --out gcta/AxiomGT1v2.noRelatives.filtered.LD_prune.gcta\n\n## b) Run the GCTA-GRM command\ngcta64 --bfile gcta/AxiomGT1v2.noRelatives.filtered.LD_prune.gcta --autosome-num 38 --autosome --make-grm \\\n       --out gcta/AxiomGT1v2.noRelatives.filtered.LD_prune.gcta_grm --thread-num 10\n</code></pre>"},{"location":"6.heritability/#62-input-phenotype-data","title":"6.2. Input phenotype data","text":"<p>The input phenotype file is a plain text file similar to that of Plink. If the phenotypic value is coded as 0 or 1 (or 1 and 2, compatible with PLINK), then it will be recognized as a case-control study (0 for controls and 1 for cases). Missing value should be represented by \"-9\" or \"NA\". </p> <p>For this tutorial, we will use the file <code>$gwas/atopy.pheno</code> that has 240 atopy cases and 1645 controls</p>"},{"location":"6.heritability/#63-covariates","title":"6.3. Covariates","text":"<p>We can adjust for quantitative and discrete covariates. Previous PCA analysis showed that three principle components explain most of the variance and non of them segregates with our phenotype of interest. Therfore, we will adjust the GREML analysis for these 3 eigenvectors. Also, we will adjust for possible gender effect.</p> <p>We already have this information but we need to reformat to match the GCTA expectations:</p> <pre><code>tail -n+2 $gwas/AxiomGT1v2.noRelatives.filtered.LD_prune.${target}.pca.eigenvec | cut -f1-5 &gt; $gwas/3PCs.txt\ncat gcta/AxiomGT1v2.noRelatives.filtered.LD_prune.gcta.fam | awk '{print $1,$2,$5}' &gt; gender.txt\n</code></pre>"},{"location":"6.heritability/#64-breeding-value","title":"6.4. Breeding value","text":"<p>A breeding value is an estimate of an animal's genetic merit for a particular trait. The additional command <code>--reml-pred-rand</code> predicts the total genetic effect (i.e. breeding value) of each individual attributed by the aggregative effect of the SNPs used to estimate the GRM. The total genetic effects of all the individuals will be saved in a plain ext file *.indi.blp.</p>"},{"location":"6.heritability/#65-run-gcta-greml","title":"6.5. Run GCTA-GREML","text":"<p>Now, we have all the pieces we need to run the analysis </p> <p>Note: You do not have to have exactly the same individuals in these files. GCTA will find the individuals in common in the files and sort the order of the individuals.</p> <pre><code>gcta64 --reml --grm gcta/AxiomGT1v2.noRelatives.filtered.LD_prune.gcta_grm \\\n       --pheno $gwas/${target}.pheno \\\n       --qcovar $gwas/3PCs.txt --covar gender.txt \\\n       --reml-pred-rand \\\n       --out $gwas/${target}_greml --thread-num 10\n</code></pre> <p>Here is the ouput:</p> <pre><code>*******************************************************************\n* Genome-wide Complex Trait Analysis (GCTA)\n* version v1.94.1 Linux\n* Built at Nov 15 2022 21:14:25, by GCC 8.5\n* (C) 2010-present, Yang Lab, Westlake University\n* Please report bugs to Jian Yang &lt;jian.yang@westlake.edu.cn&gt;\n*******************************************************************\nAnalysis started at 11:59:45 PDT on Mon Aug 28 2023.\nHostname: farm\n\nAccepted options:\n--reml\n--grm gcta/AxiomGT1v2.noRelatives.filtered.LD_prune.gcta_grm\n--pheno gwas_output/atopy.pheno\n--qcovar gwas_output/3PCs.txt\n--covar gender.txt\n--reml-pred-rand\n--out gwas_output/atopy_greml\n--thread-num 10\n\nNote: the program will be running on 10 threads.\n\nReading IDs of the GRM from [gcta/AxiomGT1v2.noRelatives.filtered.LD_prune.gcta_grm.grm.id].\n2505 IDs are read from [gcta/AxiomGT1v2.noRelatives.filtered.LD_prune.gcta_grm.grm.id].\nReading the GRM from [gcta/AxiomGT1v2.noRelatives.filtered.LD_prune.gcta_grm.grm.bin].\nGRM for 2505 individuals are included from [gcta/AxiomGT1v2.noRelatives.filtered.LD_prune.gcta_grm.grm.bin].\nReading phenotypes from [gwas_output/atopy.pheno].\nNon-missing phenotypes of 2093 individuals are included from [gwas_output/atopy.pheno].\nReading quantitative covariate(s) from [gwas_output/3PCs.txt].\n3 quantitative covariate(s) of 2093 individuals are included from [gwas_output/3PCs.txt].\nReading discrete covariate(s) from [gender.txt].\n1 discrete covariate(s) of 2505 individuals are included from [gender.txt].\nAssuming a disease phenotype for a case-control study: 326 cases and 1767 controls \nNote: you can specify the disease prevalence by the option --prevalence so that GCTA can transform the variance explained to the underlying liability scale.\n3 quantitative variable(s) included as covariate(s).\n1 discrete variable(s) included as covariate(s).\n2093 individuals are in common in these files.\n\nPerforming  REML analysis ... (Note: may take hours depending on sample size).\n2093 observations, 5 fixed effect(s), and 2 variance component(s)(including residual variance).\nCalculating prior values of variance components by EM-REML ...\nUpdated prior values: 0.0656036 0.0771283\nlogL: 1007.95\nRunning AI-REML algorithm ...\nIter.   logL    V(G)    V(e)\n1       1029.75 0.04497 0.08988\n2       1053.42 0.03276 0.09908\n3       1064.48 0.02537 0.10551\n4       1069.51 0.02080 0.10992\n5       1071.76 0.01791 0.11292\n6       1072.76 0.01606 0.11495\n7       1073.21 0.01486 0.11632\n8       1073.41 0.01237 0.11923\n9       1073.57 0.01255 0.11912\n10      1073.57 0.01254 0.11912\n11      1073.57 0.01254 0.11912\nLog-likelihood ratio converged.\n\nCalculating the logLikelihood for the reduced model ...\n(variance component 1 is dropped from the model)\nCalculating prior values of variance components by EM-REML ...\nUpdated prior values: 0.13133\nlogL: 1068.40296\nRunning AI-REML algorithm ...\nIter.   logL    V(e)\n1       1068.40 0.13133\n2       1068.40 0.13133\nLog-likelihood ratio converged.\n\nSummary result of REML analysis:\nSource  Variance        SE\nV(G)    0.012540        0.004591\nV(e)    0.119124        0.005468\nVp      0.131664        0.004110\nV(G)/Vp 0.095240        0.034359\n\nSampling variance/covariance of the estimates of variance components:\n2.108168e-05    -1.704270e-05\n-1.704270e-05   2.989700e-05\n\nSummary result of REML analysis has been saved in the file [gwas_output/atopy_greml.hsq].\n\nBLUP solutions of the genetic effects for 2093 individuals have been saved in the file [gwas_output/atopy_greml.indi.blp].\n\nAnalysis finished at 11:59:58 PDT on Mon Aug 28 2023\nOverall computational time: 13.00 sec.\n</code></pre>"},{"location":"6.heritability/#66-interpretation-of-results","title":"6.6. Interpretation of results","text":"<p>a) <code>$gwas/atopy_greml.hsq</code>: The output file of the <code>--reml</code> command  </p> <ul> <li>V(G), V(e) and Vp for genetic variance, residual variance, and phenotypic variance respectively.     Note that Vp =  V(G) + V(e)</li> <li>V(G)/Vp represents the proportion of phenotypic variance explained by SNPs. Our results here indicate that SNPs can explain 3% only of the phenotypic variance </li> <li>The standard error (SE) is importnat to judge the reliability of the results. A 95% confidence interval (CI) is approximately h2-SNP estimate +/- 1.96 * SE. If the SE is too large, the 95% CI will cover the whole parameter space (from 0 to 1) so that you won't be able to make any meaningful inference from the estimate. Therefore, a value of SE &lt; 0.1 is needed to have reliable results</li> <li>logL is the log likelihood for the full model (the null hypothesis that \u03c3<sup>2</sup><sub>g</sub> \u2260 0). </li> <li>logL0 is the log likelihood for the reduced model (the null hypothesis that \u03c3<sup>2</sup><sub>g</sub> = 0). </li> <li>LRT is the log-likelihood ratio test statistic. It is calculated as twice the difference in log-likelihood between the full (h<sup>2</sup> \u2260 0) and reduced (h<sup>2</sup> = 0) models. i.e. LRT = 2[logL - logL0] </li> <li>Degree of freedom (df), p-value, and sample size  For more information about the full and reduced models and the interpretation of log likelihoods and LRT, check here</li> </ul> <p>b) <code>$gwas/atopy_greml.indi.blp</code>:  The output file of the <code>--reml-pred-rand</code> command </p> <ul> <li>columns are family ID, individual ID, an intermediate variable, the total genetic effect, another intermediate variable and the residual effect.</li> </ul> <pre><code>awk -v size=0.02 'BEGIN{OFS=\"\\t\";bmin=bmax=0}{ b=int($6/size); a[b]++; bmax=b&gt;bmax?b:bmax; bmin=b&lt;bmin?b:bmin } END { for(i=bmin;i&lt;=bmax;++i){if(i==0) print -1*size,size,a[i]/1;else if(i&lt;0) print (i-1)*size,i*size,a[i]/1;else print i*size,(i+1)*size,a[i]/1 }}' $gwas/${target}_greml.indi.blp &gt; $gwas/${target}_greml.indi.blp_histo\n</code></pre> <p> </p> <p>Note:  GCTA has additional valuble options e.g. <code>--gxe</code> to estimate the variance of genotype-environment (GE) interaction and <code>--prevalence</code> to transform the estimate of variance explained, V(1)/Vp, on the observed scale to that on the underlying scale, V(1)/Vp_L. Check GCTA's documentation for details </p> <p> </p>"},{"location":"7.gwas/","title":"7. GWAS Analysis","text":"<p>We will use 2 different software packages to perform the GWAS analysis. Each one use a different stastical approach to adjust for population stratification. We will use the genomic control \u03bb to assess the efficiency of each. </p>"},{"location":"7.gwas/#71-gwas-by-plink","title":"7.1.  GWAS by Plink","text":""},{"location":"7.gwas/#711-linear-model","title":"7.1.1.  linear model","text":"<p>PLINK 2.0 has the new <code>--glm</code> command for association analysis (instead of  <code>--linear</code> and <code>--logistic</code> in Plink 1.9). For quantitative phenotypes, <code>--glm</code> fits a linear model while for binary phenotypes, it fits a logistic or Firth regression model instead.</p> <ul> <li>The model has a fixed-covariate matrix to include covariates loaded by <code>--covar</code>.<ul> <li>It is now standard practice to include top principal components (usually computed by <code>--pca</code>) as covariates in any association analysis, to correct for population stratification </li> <li>You can add the 'sex' modifier to include .fam/.psam sex as a covariate </li> </ul> </li> <li>Dataset precautions:<ul> <li>This method does not properly adjust for small-scale family structure. As a consequence, it is usually necessary to prune close relations</li> <li>It is advised to exlcude variants with very small minor allele count (\"--mac 20\" is a reasonable filter to apply).  Our filtered dataset already fullfill these precautions</li> </ul> </li> <li>The model uses the minor allele dosages by default. To make it always contain ALT allele dosages instead (the A1 column of the main report), we need to add the 'omit-ref' modifier. </li> </ul> <p>Here, we will adjust for sex and 3 PCs </p> <pre><code>plink2 --bfile $gwas/AxiomGT1v2.noRelatives.filtered.LD_prune.${target} --chr-set 38 no-xy --allow-extra-chr \\\n       --pheno $gwas/${target}.pheno \\\n       --chr 1-38, X \\\n       --glm sex 'hide-covar' --ci 0.95 \\\n       --covar $gwas/AxiomGT1v2.noRelatives.filtered.LD_prune.${target}.pca.eigenvec --covar-name PC1,PC2,PC3 \\\n       --output-chr 26 --out $gwas/AxiomGT1v2.noRelatives.filtered.LD_prune.${target}.glm\n</code></pre> <p>Here is the output</p> <pre><code>PLINK v2.00a2.3LM 64-bit Intel (24 Jan 2020)   www.cog-genomics.org/plink/2.0/\n(C) 2005-2020 Shaun Purcell, Christopher Chang   GNU General Public License v3\nLogging to gwas_output/AxiomGT1v2.noRelatives.filtered.LD_prune.atopy.glm.log.\nOptions in effect:\n  --allow-extra-chr\n  --bfile gwas_output/AxiomGT1v2.noRelatives.filtered.LD_prune.atopy\n  --chr 1-38, X\n  --chr-set 38 no-xy\n  --ci 0.95\n  --covar gwas_output/AxiomGT1v2.noRelatives.filtered.LD_prune.atopy.pca.eigenvec\n  --covar-name PC1,PC2,PC3\n  --glm sex hide-covar\n  --out gwas_output/AxiomGT1v2.noRelatives.filtered.LD_prune.atopy.glm\n  --output-chr 26\n  --pheno gwas_output/atopy.pheno\n\nStart time: Mon Aug 28 12:02:53 2023\n64289 MiB RAM detected; reserving 32144 MiB for main workspace.\nUsing up to 32 threads (change this with --threads).\n2093 samples (1038 females, 1055 males; 2093 founders) loaded from\ngwas_output/AxiomGT1v2.noRelatives.filtered.LD_prune.atopy.fam.\n14825 out of 14885 variants loaded from\ngwas_output/AxiomGT1v2.noRelatives.filtered.LD_prune.atopy.bim.\n1 binary phenotype loaded (326 cases, 1767 controls).\n3 covariates loaded from gwas_output/AxiomGT1v2.noRelatives.filtered.LD_prune.atopy.pca.eigenvec.\nCalculating allele frequencies... done.\n--glm logistic regression on phenotype 'PHENO1': done.\nResults written to gwas_output/AxiomGT1v2.noRelatives.filtered.LD_prune.atopy.glm.PHENO1.glm.logistic .\n</code></pre>"},{"location":"7.gwas/#712-genomic-control","title":"7.1.2. genomic control","text":"<p>The genomic control \u03bb value (often referred to as the \"genomic inflation factor\") is used to measure and correct for population stratification. A \u03bb value close to 1 suggests that the results are not inflated due to population stratification, while values greater than 1 suggest potential inflation. However, values up to 1.10 are generally considered acceptable for a GWAS  We can use the results of our regression analysis to calculate the genomic control \u03bb value:</p> <pre><code>## \u03bb = observed median chi-square statistic / 0.456\n## Chi-square statistic = Z_stat&lt;sup&gt;2&lt;/sup&gt;\n\ntail -n+2 $gwas/AxiomGT1v2.noRelatives.filtered.LD_prune.${target}.glm.PHENO1.glm.logistic | awk '{print $13*$13}' | sort | awk '{count[NR] = $1;}\\\nEND{\nif(NR % 2){gif = count[(NR + 1) / 2];} else {gif = (count[(NR / 2)] + count[(NR / 2) + 1]) / 2.0;}\nprint \"Genomic inflation factor = \" gif/0.456;}'\n</code></pre> <p>Genomic inflation factor = 1.13221 </p>"},{"location":"7.gwas/#713-plotting","title":"7.1.3. Plotting","text":"<pre><code>input_asc=\"$gwas/AxiomGT1v2.noRelatives.filtered.LD_prune.${target}.glm.PHENO1.glm.logistic\"\noutput_prefix=\"$gwas/${target}.glm.logistic\"\n\nRscript -e 'args=(commandArgs(TRUE));require(qqman);'\\\n'asc &lt;- read.table(args[1],head=TRUE,comment.char=\"\");'\\\n'asc &lt;- na.omit(asc);'\\\n'tiff(paste(args[2],\".qqplot.tif\",sep=\"\"),units=\"in\", width=10, height=10, res=300);'\\\n'qq(asc$P, main = \"Q-Q plot\", col = \"blue4\");'\\\n'dev.off();'\\\n'noOfTests &lt;- dim(asc)[1];bonf &lt;- 0.05/as.numeric(noOfTests);bonfBy200 &lt;- 10/as.numeric(noOfTests);'\\\n'sigSNPs &lt;- asc$ID[which(asc$P&lt;=bonfBy200)];'\\\n'tiff(paste(args[2],\".manh.tif\",sep=\"\"),units=\"in\", width=30, height=10, res=300);'\\\n'manhattan(asc, main = \"Manhattan Plot\", chr = \"X.CHROM\", bp = \"POS\", p = \"P\", snp = \"ID\", ylim = c(0, 6), chrlabs = c(1:38, \"X\"),suggestiveline =  -log10(bonfBy200), genomewideline =  -log10(bonf), highlight = sigSNPs);'\\\n'dev.off();'  \"$input_asc\" \"$output_prefix\"\n</code></pre> <p>Here is the Q-Q plot</p> <p></p> <p>And the Manhaten plot</p> <p></p>"},{"location":"7.gwas/#72-gwas-by-gcta","title":"7.2.  GWAS by GCTA","text":""},{"location":"7.gwas/#721-mixed-linear-model","title":"7.2.1.  Mixed linear model","text":"<p>Mixed model association software such as SAIGE, BOLT-LMM, GCTA, or FaST-LMM instead; or regenie's whole genome regression can better handel genetic relatedness. In this tutroial, we will use <code>--mlma-loco</code> for mixed linear model based association analysis. </p> <pre><code>y = a + bx + g + e\n</code></pre> <p>where:  *  y is the phenotype *  a is the mean term (i.e. intercept) *  b is the additive effect (fixed effect) of the candidate SNP to be tested for association *  x is the SNP genotype indicator variable coded as 0, 1 or 2 *  g is the polygenic effect (random effect) i.e. the accumulated effect of all SNPs (as captured by the GRM calculated using all SNPs) *  e is the residual. </p> <p>The MLM leaving-one-chromosome-out (LOCO) analysis implements the model with the chromosome, on which the candidate SNP is located, excluded from calculating the GRM. This means that g is the accumulated effect of all SNPs except those on the chromosome where the candidate SNP is located. The var(g) will be re-estimated each time when a chromosome is excluded from calculating the GRM. The MLM-LOCO analysis is computationally less efficient but more powerful as compared with the classical MLM analysis.</p> <p>Note1: The mixed linear model incorporates the genetic relationship matrix (GRM) to capture the accumulated effect of all SNPs which accounts for population stratification to a large extent. Therefore, there is no need to adjust for top PCs.</p> <p>Note2: By default, the model include covariates (if provided) as fixed effects and the phenotype will be adjusted by the mean (i.e. intercept) and covariates before testing for SNP association. However, if SNPs are correlated with the covariates, pre-adjusting the phenotype by the covariates will probably cause loss of power. If the <code>--mlma-no-preadj-covar</code> option is specified, the covariates will be fitted together with the SNP for association test. However, this will significantly reduce computational efficiency.</p> <pre><code>gcta64 --mlma-loco --bfile gcta/AxiomGT1v2.noRelatives.filtered.LD_prune.gcta --autosome-num 38 --autosome \\\n       --grm gcta/AxiomGT1v2.noRelatives.filtered.LD_prune.gcta_grm \\\n       --pheno $gwas/${target}.pheno \\\n       --covar gender.txt --mlma-no-preadj-covar \\\n       --out $gwas/${target}_asc --thread-num 10\n</code></pre>"},{"location":"7.gwas/#722-genomic-control","title":"7.2.2. genomic control:","text":"<p>The output of the MLM-LOCO analysis does not have chi-square statistic, however the p-values can be converted to chi-squared statistics for 1 degree of freedom by using the inverse of the cumulative distribution function (CDF) of the chi-squared distribution. This can be easily done using python</p> <pre><code>## Let us prepaper our conda environmnet to run Python\nmamba install -c conda-forge python=3.11.4 pandas=2.0.3 scipy=1.11.2\n</code></pre> <p>Now, we can open python in interactive mode by using the command <code>python</code>. Once we are dome, we can exit the interactive mode by using the <code>exit()</code> function</p> <pre><code>import pandas as pd\nimport scipy.stats as stats\n# Load the GCTA-LOCO results\ngwas_results = pd.read_table(\"gwas_output/atopy_asc.loco.mlma\", delim_whitespace=True)\n# Convert p-values to chi-squared statistics\ngwas_results['CHISQ'] = stats.chi2.ppf(1 - gwas_results['p'], df=1)\n# Calculate lambda\nlambda_value = gwas_results[\"CHISQ\"].median() / 0.456\nprint(\"Genomic control \u03bb:\", lambda_value)\n</code></pre> <p>Genomic control \u03bb: 1.0218973008189114 which is GREAT!</p>"},{"location":"7.gwas/#723-plotting","title":"7.2.3.  Plotting","text":"<pre><code>input_asc=\"$gwas/atopy_asc.loco.mlma\"\noutput_prefix=\"$gwas/${target}.loco.mlma\"\n\nRscript -e 'args=(commandArgs(TRUE));require(qqman);'\\\n'asc &lt;- read.table(args[1],head=TRUE,comment.char=\"\");'\\\n'asc &lt;- na.omit(asc);'\\\n'tiff(paste(args[2],\".qqplot.tif\",sep=\"\"),units=\"in\", width=10, height=10, res=300);'\\\n'qq(asc$p, main = \"Q-Q plot\", col = \"blue4\");'\\\n'dev.off();'\\\n'noOfTests &lt;- dim(asc)[1];bonf &lt;- 0.05/as.numeric(noOfTests);bonfBy200 &lt;- 10/as.numeric(noOfTests);'\\\n'sigSNPs &lt;- asc$SNP[which(asc$p&lt;=bonfBy200)];'\\\n'tiff(paste(args[2],\".manh.tif\",sep=\"\"),units=\"in\", width=30, height=10, res=300);'\\\n'manhattan(asc, main = \"Manhattan Plot\", chr = \"Chr\", bp = \"bp\", p = \"p\", snp = \"SNP\", ylim = c(0, 6),suggestiveline =  -log10(bonfBy200), genomewideline =  -log10(bonf), highlight = sigSNPs);'\\\n'dev.off();'  \"$input_asc\" \"$output_prefix\"\n</code></pre> <p>Here is the Q-Q plot</p> <p></p> <p>And the Manhaten plot</p> <p></p>"},{"location":"ext_docs/GREML_analysis/","title":"GREML analysis","text":""},{"location":"ext_docs/GREML_analysis/#gcta-greml-analysis","title":"GCTA-GREML analysis","text":"<p>The narrow-sense heritability (h<sup>2</sup>) is defined as the proportion of phenotypic variance due to additive genetic variance. GREML (Genomic-relatedness-based restricted maximum likelihood) is a method used to estimate the proportion of variance in a phenotype that can be explained by SNPs in a population. In other words, GREML calculates the SNP-based heritability.</p> <p>GREML utilizes the genetic relationships between individuals in a sample population, captured in a genomic relationship matrix (GRM), to partition the phenotypic variance into its genetic and residual components. By fitting a linear mixed model, GREML estimates the proportion of variance attributable to all SNPs.</p> <p>Let us dive deeper into linear mixed models (LMM) and how they are used in the context of this genomic analysis:</p> <p>1. Basics of Linear Models:  In simple linear regression, we model the relationship between a dependent variable (phenotype) and one or more independent variables (often genotypic data). The model is described as:</p> <p>Y=X\u03b2+\u03f5</p> <p>Where:</p> <ul> <li>Y is the vector of phenotypic values.</li> <li>X is the design matrix for the fixed effects.</li> <li>\u03b2 is a vector of fixed effect coefficients.</li> <li>\u03f5 is the vector of random errors.</li> </ul> <p></p> <p>2. Mixed Models Add a Random Component:  In mixed models, besides fixed effects (like the \u03b2 in the linear model), there are random effects which capture variability in the data due to certain groups or clusters.</p> <p>Y=X\u03b2+Zu+\u03f5</p> <p>Where:</p> <ul> <li>Z is the design matrix for the random effects.</li> <li>u is the vector of random effects.</li> </ul> <p></p> <p>3. Application to Genomic Data:  In the context of GREML and genomic studies:</p> <ul> <li>The fixed effects (\u03b2) might capture known factors influencing the phenotype, like age or gender.</li> <li>The random effects (u) capture the genetic effects of all SNPs. These are assumed to follow a multivariate normal distribution with mean zero and variance-covariance matrix G\u03c3<sup>2</sup><sub>g</sub>, where G is the genomic relationship matrix (GRM) and \u03c3<sup>2</sup><sub>g</sub> is the genetic variance.</li> <li>The residuals \u03f5 are also assumed to be normally distributed with mean zero and a variance-covariance matrix I\u03c3<sup>2</sup><sub>e</sub>, where I is the identity matrix and \u03c3<sup>2</sup><sub>e</sub> is the error variance.</li> </ul> <p></p> <p>4. Estimating the Variance Components:  The key goal in GREML is to estimate the \u03c3<sup>2</sup><sub>g</sub> (genetic variance) and \u03c3<sup>2</sup><sub>e</sub> (residual variance). From these, we can compute the SNP-based heritability as:</p> <p>h<sup>2</sup> = \u03c3<sup>2</sup><sub>g</sub> / (\u03c3<sup>2</sup><sub>g</sub> + \u03c3<sup>2</sup><sub>e</sub>)</p> <p>This quantifies the proportion of the phenotypic variance explained by the SNPs.</p> <p></p> <p>5. Restricted Maximum Likelihood (REML):  The REML approach is used to estimate the variance components in the model. REML provides unbiased estimates of variance components under a wide range of situations.</p> <p>In summary, by using a linear mixed model, the GREML approach leverages both fixed (known factors) and random (genetic effects of SNPs) components to partition and quantify the variability in the observed phenotype. This enables researchers to pinpoint how much of the phenotypic variance can be attributed to genetics as captured by SNPs.</p> <p></p> <p>6. statistical varification:  For GCTA to assess the importance of the SNPs' effects to the model, it fits and compare 2 models:</p> <p>a) Full Model that includes both the fixed effects and the random effects.  b) Reduced Model that only includes the fixed effects and omits the random effects of SNPs. </p> <p>GCTA calculate the Log Likelihoods for both models. A higher log likelihood indicates a better fit of the model to the data. The difference in log likelihoods between the full and reduced models provides a test statistic for the significance of the random effects (SNP effects). Essentially, if the full model (which includes SNP effects) has a significantly better fit to the data than the reduced model (which excludes SNP effects), it implies that the SNPs are explaining a significant portion of the variance in the phenotype.</p> <p>Formally, the difference in log likelihoods between the two models, multiplied by two, approximately follows a chi-squared distribution. This can be used for hypothesis testing: 2 (LogLikelihood<sub>full</sub> \u2212 LogLikelihood<sub>reduced</sub>)</p> <p>You can learn more about linear mixed models here</p>"},{"location":"ext_docs/admixture_analysis/","title":"Admixture analysis","text":""},{"location":"ext_docs/admixture_analysis/#admixture-analysis","title":"Admixture Analysis","text":"<p>Admixture analysis is a statistical method used in population genetics to estimate the proportions of ancestry in an individual's genome derived from multiple populations. By analyzing variations in DNA sequences, this method provides insights into historical migrations, inter-population mixing, and the genetic backgrounds of mixed populations. </p> <p>Species with breeds under artificial selection pressure like dogs can make use of admixture analysis in special situations including:</p> <ol> <li>Historical Admixture: If there is suspicion or historical evidence that a particular breed was created through the mixing of two or more other breeds, admixture analysis can provide insights into the genetic contributions of each ancestral breed. The Golden Retriever breed has a well-documented origin, having been developed in the Scottish Highlands in the late 19th century from a blend of Yellow Retrievers, Tweed Water Spaniels, and other breeds. Therefore, this situation does not seem applicable </li> <li>Population Bottlenecks and Diversity: Admixture analysis can help determine if there's been a recent bottleneck (a sharp reduction in the size of a population) in the breed's history. Such events can lead to a decrease in genetic diversity, which can increase susceptibility to diseases. This would be a useful application if our population represents a wide array of Golden Retrievers from different lineages or regions but this is not the case</li> <li>Breed Purity: Admixture analysis can be used to assess the genetic purity of individual dogs or lines within a breed. If there's unexpected genetic material from another breed, it might be indicative of undisclosed crossbreeding in the past. That seems as a useful application but we need our studied population to include samples from other breeds to identify any unusual genetic signals within the Golden Retriever dogs.</li> <li>Health and Genetic Disorders: Many purebred dogs are prone to specific genetic disorders. Golden Retrievers, like many purebred dogs, have specific health concerns, including hip dysplasia, certain cancers, and eye issues. While admixture analysis doesn't directly target these, understanding the genetic makeup and potential sources of variation within a breed can help in broader genetic studies aimed at improving breed health. While health-focused studies can be breed-specific, knowing the genetic makeup of related breeds might help identify the origins of certain genetic disorders or traits.</li> </ol> <p>In conclusion, for this analysis to be useful, we need a population of dogs the include more breeds. For now, we will use the data of Golden retrievers only to explore the genetic diversity within the breed but hopefully we will expand this dataset soon to include more dogs from other breeds.     </p>"},{"location":"ext_docs/admixture_analysis/#1-install","title":"1. install","text":"<pre><code>conda install -c bioconda admixture=1.3.0\n</code></pre>"},{"location":"ext_docs/admixture_analysis/#2-remove-non-autosomal-markers-and-change-chr-names-to-intigers","title":"2. remove non-autosomal markers and change chr names to intigers","text":"<pre><code>mkdir -p admix\nplink --bfile AxiomGT1v2.noRelatives.filtered.LD_prune --chr-set 38 no-xy --allow-extra-chr \\\n      --autosome \\\n      --make-bed -out admix/AxiomGT1v2.noRelatives.filtered.LD_prune.autosomes\n</code></pre>"},{"location":"ext_docs/admixture_analysis/#3-run-admixture-in-the-cross-validation-mode-to-find-out-the-best-number-of-ancestries","title":"3. Run Admixture in the cross validation mode to find out the best number of ancestries","text":"<pre><code>cd admix\nfor k in {1..10};do echo $k;\n  admixture -j8 --cv AxiomGT1v2.noRelatives.filtered.LD_prune.autosomes.bed $k | tee log${k}.out\ndone\ngrep \"^CV error\" log*.out | cut -d\":\" -f1,3 | sed 's/log//;s/\\.out://' | sort -k1,1n &gt; admix_cv.txt\n\nRscript -e 'val &lt;- read.table(\"admix_cv.txt\");'\\\n'jpeg(file = \"admix_cv.jpg\");'\\\n'plot( x = val$V1, y = val$V2, type = \"o\",xlab = \"K Ancestry\", ylab = \"CV error\");'\\\n'dev.off();'\n</code></pre> <p>There is an output file for each parameter set: Q (the ancestry fractions), and P (the allele frequencies of the inferred ancestral populations). </p>"},{"location":"ext_docs/admixture_analysis/#4-plot-the-q-estimates","title":"4. plot the Q estimates","text":"<pre><code>sort -k1,3nr AxiomGT1v2.noRelatives.filtered.LD_prune.autosomes.3.Q &gt; AxiomGT1v2.noRelatives.filtered.LD_prune.autosomes.3.Q.sorted\nRscript -e 'tbl=read.table(\"AxiomGT1v2.noRelatives.filtered.LD_prune.autosomes.3.Q.sorted\");'\\\n'jpeg(file = \"ancestries.jpg\");'\\\n'barplot(t(as.matrix(tbl)), col=rainbow(3),xlab=\"Individual #\", ylab=\"Ancestry\", border=NA);'\\\n'dev.off();'\n</code></pre>"},{"location":"ext_docs/admixture_analysis/#5-plot-the-q-estimates-of-a-selected-subset-of-individuals","title":"5. plot the Q estimates of a selected subset of individuals","text":"<pre><code>tail -n+2 AxiomGT1v2.noRelatives.filtered.LD_prune.pca.eigenvec | awk '{if($3&lt;0.02 &amp;&amp; $4&gt;0.03)print $1,$2}' &gt; pc2_extreme\npaste AxiomGT1v2.noRelatives.filtered.LD_prune.autosomes.3.Q  AxiomGT1v2.noRelatives.filtered.LD_prune.autosomes.fam | grep -wf pc2_extreme &gt; pc2_extreme.Q\necho Population Percent Individual &gt; subset_ancestry.txt\ncat pc2_extreme.Q | awk '{for (a = 1; a &lt;= 3; a++)print \"Pop\"a,$a,$4\".\"$5}' &gt;&gt; subset_ancestry.txt\n\nRscript -e 'data &lt;- read.table(\"subset_ancestry.txt\",header = TRUE);'\\\n'library(ggplot2);'\\\n'bar &lt;- ggplot(data, aes(fill=Population, y=Percent, x=factor(Individual))) +'\\\n'geom_bar(position=\"stack\", stat=\"identity\") + ggtitle(\"Admixture ancestries\");'\\\n'bar2 &lt;- bar + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1, size = 4));'\\\n'ggsave(\"subset_ancestries.png\", bar2, width = 12, height = 6, dpi = 400);'\n</code></pre>"},{"location":"ext_docs/gwas_studies/","title":"Previous GWAS","text":""},{"location":"ext_docs/gwas_studies/#gwass-in-golden-retrievers","title":"GWASs in Golden Retrievers","text":""},{"location":"ext_docs/gwas_studies/#a-cancers","title":"A) Cancers","text":"<ol> <li>Tonomura et al. Genome-wide association study identifies shared risk loci common to two malignancies in golden retrievers. PLoS Genet. 2015 Feb 2;11(2):e1004922. doi: 10.1371/journal.pgen.1004922. eCollection 2015 Feb.  Canine B-cell lymphoma and hemangiosarcoma are both malignancies of the hematologic system. Golden retrievers in the US show significantly elevated lifetime risk for both B-cell lymphoma (6%) and hemangiosarcoma (20%). GWAS for hemangiosarcoma and B-cell lymphoma, identifying two shared predisposing loci. The two associated loci are located on CFA 5, and together contribute ~20% of the risk of developing these cancers. Genome-wide p-values for the top SNP of each locus are 4.6\u00d710-7 and 2.7\u00d710-6, respectively. Whole genome resequencing of nine cases and controls identified three shared and one B-cell lymphoma specific risk haplotypes within the two loci, but no coding changes were associated with the risk haplotypes. Gene expression analysis of B-cell lymphoma tumors revealed that carrying the risk haplotypes at the first locus is associated with down-regulation of several nearby genes including the proximal gene TRPC6, a transient receptor Ca2+-channel involved in T-cell activation, among other functions. The shared risk haplotype in the second locus overlaps the vesicle transport and release gene STX8. Carrying the shared risk haplotype is associated with gene expression changes of 100 genes enriched for pathways involved in immune cell activation. Thus, the predisposing germline mutations in B-cell lymphoma and hemangiosarcoma appear to be regulatory, and affect pathways involved in T-cell mediated immune response in the tumor.   </li> <li>Evans et al. Multi-omics approach identifies germline regulatory variants associated with hematopoietic malignancies in retriever dog breeds. PLoS Genet. 2021 May 13;17(5):e1009543. doi: 10.1371/journal.pgen.1009543. eCollection 2021 May.  Histiocytic sarcoma is an aggressive hematopoietic malignancy of mature tissue histiocytes. Flat-coated retrievers (FCRs) have unusually high frequency (lethal in 20%). GWASs identifying two significant risk loci on CFA 5 (Pwald = 4.83x10-9) and 19 (Pwald = 2.25x10-7). A multi-omics approach generating whole genome, transcriptome, and chromatin immunoprecipitation sequencing highlighted the PI3K pathway gene PIK3R6 on CFA5, and proximal candidate regulatory variants that are strongly associated with histiocytic sarcoma and predicted to impact transcription factor binding. The CFA5 association colocalizes with susceptibility loci for two hematopoietic malignancies, hemangiosarcoma and B-cell lymphoma, in the closely related golden retriever breed, revealing the risk contribution this single locus makes to multiple hematological cancers. By comparison, the CFA19 locus is unique to the FCR and harbors risk alleles associated with upregulation of TNFAIP6, which itself affects cell migration and metastasis. Together, these loci explain ~35% of disease risk.  </li> <li>H\u00e9dan et al. Identification of common predisposing loci to hematopoietic cancers in four dog breeds. PLoS Genet. 2021 Apr 1;17(4):e1009395. doi: 10.1371/journal.pgen.1009395. eCollection 2021 Apr.  Histiocytic sarcoma (HS) is a rare but aggressive cancer in both humans and dogs with specific breed predispositions. This study combined several GWASs in a multi-breed (Bernese mountain dogs, Rottweilers, flat-coated retrievers, and golden retrievers) and multi-cancer (HS, lymphoma, and mast cell tumor). Results confirmed the previously identified HS risk CDKN2A locus on CFA 11.  Also identified new loci on canine chromosomes 2, 5, 14, and 20. Capture and targeted sequencing of specific loci suggested the existence of regulatory variants in non-coding regions and methylation mechanisms linked to risk haplotypes, which lead to strong cancer predisposition in specific dog breeds. We also showed that these canine cancer predisposing loci appeared to be due to the additive effect of several risk haplotypes involved in other hematopoietic cancers such as lymphoma or mast cell tumors as well.  </li> <li>Labadie et al. Genome-wide association analysis of canine T zone lymphoma identifies link to hypothyroidism and a shared association with mast-cell tumors. BMC Genomics. 2020 Jul 6;21(1):464. doi: 10.1186/s12864-020-06872-9.  T zone lymphoma (TZL) represents about 12% of all canine lymphomas. Golden Retrievers appear predisposed, representing over 40% of TZL cases. Asymptomatic aged Golden Retrievers frequently have populations of T zone-like cells (phenotypically identical to TZL) of undetermined significance (TZUS), potentially representing a pre-clinical state. Dogs were categorized as TZL (n = 95), TZUS (n = 142), or control (n = 101) using flow cytometry and genotyped using the Illumina CanineHD BeadChip. Using a mixed linear model adjusting for population stratification, we found association with genome-wide significance in regions on chromosomes 8 and 14. The chromosome 14 peak included four SNPs (Odds Ratio = 1.18-1.19, p = .3 \u00d7 10- 5-5.1 \u00d7 10- 5) near three hyaluronidase genes (SPAM1, HYAL4, and HYALP1). Targeted resequencing identified missense mutations in all three genes; the variant in SPAM1 was predicted to be damaging. These mutations were also associated with risk for mast cell tumors among Golden Retrievers in an unrelated study. The chromosome 8 peak contained 7 SNPs (Odds Ratio = 1.24-1.42, p = 2.7 \u00d7 10- 7-7.5 \u00d7 10- 5) near genes involved in thyroid hormone regulation (DIO2 and TSHR). A prior study from our laboratory found hypothyroidism is inversely associated with TZL risk. No coding mutations were found with targeted resequencing but identified variants may play a regulatory role for all or some of the genes.  </li> <li>Biasoli et al. A synonymous germline variant in a gene encoding a cell adhesion molecule is associated with cutaneous mast cell tumour development in Labrador and Golden Retrievers. PLoS Genet. 2019 Mar 22;15(3):e1007967. doi: 10.1371/journal.pgen.1007967. eCollection 2019 Mar.  Mast cell tumours (MCT) are the most common type of skin cancer in dogs with known breed-predisposition. In in Labrador Retrievers, GWAS combined with targeted next generation sequencing, and TaqMan genotyping identified a synonymous variant in the DSCAM gene on CAF 31. Furthermore, we showed that the variant is also associated with MCT in Golden Retrievers. The variant is common in both Labradors and Golden Retrievers and consequently is likely to be a significant genetic contributor to the increased susceptibility of both breeds to develop mast cell tumours.  </li> <li>Arendt et al. Genome-Wide Association Study of Golden Retrievers Identifies Germ-Line Risk Factors Predisposing to Mast Cell Tumours. PLoS Genet. 2015 Nov 20;11(11):e1005647. doi: 10.1371/journal.pgen.1005647. eCollection 2015 Nov.  ... somatic mutations in the oncogene C-KIT have been detected in a proportion of Canine MCT. GWAS in golden retrievers from two continents identified separate regions in the two populations. Sequence capture of associated regions and subsequent fine mapping in a larger cohort of dogs identified a SNP associated with development of MCT in the GNAI2 gene (p = 2.2x10-16), introducing an alternative splice form of this gene resulting in a truncated protein. In addition, disease associated haplotypes harbouring the hyaluronidase genes HYAL1, HYAL2 and HYAL3 on cfa20 and HYAL4, SPAM1 and HYALP1 on cfa14 were identified as separate risk factors in European and US golden retrievers, respectively, suggesting that turnover of hyaluronan plays an important role in the development of CMCT.  </li> </ol>"},{"location":"ext_docs/gwas_studies/#b-non-cancer","title":"B) Non-cancer","text":"<ol> <li>Arendt et al. The ABCC4 gene is associated with pyometra in golden retriever dogs. Sci Rep. 2021 Aug 17;11(1):16647. doi: 10.1038/s41598-021-95936-1.  Pyometra is inflammation and bacterial infection of the uterus. There is clear breed predisposition (risk ratio: 3.3 in GR). GWAS with mixed model. GWAS comparing 98 cases, and 96 controls identified an associated locus on chromosome 22 (p = 1.2 \u00d7 10-6). This locus contained five significantly associated SNPs positioned within introns of the ATP-binding cassette transporter 4 (ABCC4) gene. NGS and genotyping of cases and controls subsequently identified four missense SNPs within the ABCC4 gene. One missense SNP at chr22:45,893,198 (p.Met787Val) showed complete LD with the associated GWAS SNPs suggesting a potential role in disease development. Another locus on chromosome 18 overlapping the TESMIN gene, is also potentially implicated in the development of the disease.  </li> <li>Brinkmeyer-Langford et al. Genome-wide association study to identify potential genetic modifiers in a canine model for Duchenne muscular dystrophy Candice BMC Genomics. 2016 Aug 22;17(1):665. doi: 10.1186/s12864-016-2948-z.  Duchenne muscular dystrophy (DMD) causes progressive muscle degeneration, cardiomyopathy and respiratory failure in approximately 1/5,000 boys. Golden Retriever muscular dystrophy (GRMD) resembles DMD both clinically and pathologically. The disease exhibits remarkable phenotypic variation among affected dogs, suggesting the influence of modifiers. A linear mixed-model (LMM) analysis using 16 variably-affected dogs from our GRMD colony (8 dystrophic vs 8 non-dystrophic).   </li> <li>Olsson et al. Genome-Wide Analyses Suggest Mechanisms Involving Early B-Cell Development in Canine IgA Deficiency. PLoS One. 2015 Jul 30;10(7):e0133844. doi: 10.1371/journal.pone.0133844. eCollection 2015.  Immunoglobulin A deficiency (IgAD) is the most common primary immune deficiency disorder in both humans and dogs, characterized by recurrent mucosal tract infections and a predisposition for allergic and other immune mediated diseases. A novel percentile groups-approach was used to establish breed-specific cut-offs and to perform analyses in a close to continuous manner. GWAS performed in four breeds prone to low IgA levels (German shepherd, Golden retriever, Labrador retriever and Shar-Pei) identified 35 genomic loci suggestively associated (p &lt;0.0005) to IgA levels. In German shepherd, three genomic regions (candidate genes include KIRREL3 and SERPINA9) were genome-wide significantly associated (p &lt;0.0002) with IgA levels. A ~20kb long haplotype on CFA28, significantly associated (p = 0.0005) to IgA levels in Shar-Pei, was positioned within the first intron of the gene SLIT1. The suggestively associated regions were enriched for genes in Gene Ontology gene sets involving inflammation and early immune cell development.  </li> <li>Downs et al. A novel mutation in TTC8 is associated with progressive retinal atrophy in the golden retriever. Canine Genet Epidemiol. 2014 Apr 16;1:4. doi: 10.1186/2052-6687-1-4. eCollection 2014.  Generalized progressive retinal atrophy (PRA) is a group of inherited eye diseases characterised by progressive retinal degeneration that ultimately leads to blindness in dogs. Mutations in two distinct genes have been reported to cause PRA in Golden Retrievers: prcd-PRA (c.5G &gt; A at the PRCD gene on CFA9) and GR_PRA1 (c.2601_2602insC at the SLC4A3 gene on CFA37), but for approximately 39% of cases in this breed the causal mutation remains unknown. GWAS of 10 PRA cases and 16 controls identified an association on CFA8. Using haplotype analysis we defined a 737 kb critical region. Using targeted NGS, a single nucleotide deletion was identified in exon 8 of the TTC8 gene of affected Golden Retrievers. The frame shift mutation was predicted to cause a premature termination codon.  </li> <li>Grall et al. PNPLA1 mutations cause autosomal recessive congenital ichthyosis in golden retriever dogs and humans. Nat Genet. 2012 Jan 15;44(2):140-7. doi: 10.1038/ng.1056.  Ichthyoses comprise a heterogeneous group of genodermatoses characterized by abnormal desquamation over the whole body. GWAS in golden retrievers affected by a lamellar ichthyosis identified a homozygous insertion-deletion (indel) mutation in PNPLA1 on CFA12 that leads to a premature stop codon in all affected golden retriever dogs.  </li> <li>Wood et al. Genome-wide association analysis of canine atopic dermatitis and identification of disease related SNPs. Immunogenetics. 2009 Dec;61(11-12):765-72. doi: 10.1007/s00251-009-0402-y. Epub 2010 Jan 5.  GWAS of atopic dermatitis (cAD) was done in Golden Retrievers. Further validation studies were performed for potentially associated SNPs using Sequenom genotyping of larger numbers of cases and controls across eight breeds (Boxer, German Shepherd Dog, Labrador, Golden Retriever, Shiba Inu, Shih Tzu, Pit Bull, and West Highland White Terriers). Using meta-analysis, two SNPs were associated with cAD in all breeds tested. RS22114085 was identified as a susceptibility locus (p=0.00014, odds ratio=2) and RS23472497 as a protective locus (p=0.0015, odds ratio=0.6). Both of these SNPs were located in intergenic regions, and their effects have been demonstrated to be independent of each other, highlighting that further fine mapping and resequencing is required of these areas. Further, 12 SNPs were validated by Sequenom genotyping as associated with cAD, but these were not associated with all breeds.  </li> <li>[Review] Ontiveros et al. Genetics of canine subvalvular aortic stenosis (SAS). Canine Med Genet. 2021 May 7;8(1):4. doi: 10.1186/s40575-021-00103-4.  A GWAS analysis was also completed for SAS affected Golden Retrievers [39]. This abstract reported a region on chromosome 13 that was identified in 29 affected and 52 control Golden Retrievers. We have also completed a GWAS analysis for the Newfoundland and Rottweiler breed, both of which also demonstrated a locus on chromosome 13 that exceeded the Bonferroni threshold for significance (unpublished data). Therefore, we completed an across breed GWAS analysis for the Golden Retriever, Newfoundland, and Rottweiler breeds to determine if they shared a common genetic variant on chromosome 13 (unpublished data). Given that these breeds share haplotypes with each other, it is possible that they may all share a genetic variant that predisposes them for SAS [40]. The across breed GWAS analysis identified a locus achieving genome-wide significance on chromosome 13. The aim of these analyses was to decipher the genetic architecture for SAS affected dogs. This candidate region on chromosome 13 requires further evaluation through the use of targeted or whole-genome sequencing approaches. This can result in the identification of distinct or shared genetic variants associated with SAS in the Golden Retriever, Newfoundland, and Rottweiler breed.  </li> </ol>"},{"location":"ext_docs/health_concerns/","title":"Health concerns","text":""},{"location":"ext_docs/health_concerns/#health-concerns-in-golden-retrievers-a-literature-review","title":"Health Concerns in Golden Retrievers: A Literature Review","text":"<p>Golden Retrievers are one of the most popular breeds in the world, known for their friendly demeanor and beautiful golden coats. However, as with any breed, they are prone to specific health problems. This review aims to summarize some of the most prevalent health concerns in Golden Retrievers.</p> <p>A) Breed-specific:</p> <ol> <li>Hip Dysplasia:    A common concern in many larger dog breeds, hip dysplasia is an abnormal formation of the hip socket. Over time, this can lead to arthritis and pain.  Reference: Smith, G. K., Mayhew, P. D., Kapatkin, A. S., McKelvie, P. J., Shofer, F. S., &amp; Gregor, T. P. (2001). Evaluation of risk factors for degenerative joint disease associated with hip dysplasia in German Shepherd Dogs, Golden Retrievers, and Rottweilers. Journal of the American Veterinary Medical Association, 219(12), 1719-1724. </li> <li>Elbow Dysplasia:    This is a condition affecting the elbow joint and can lead to pain and lameness in affected dogs.  Reference: Burton, N. J., &amp; Owen, M. R. (2008). Elbow dysplasia in the dog: pathophysiology, diagnosis and current treatment recommendations. Veterinary Journal, 175(2), 149-162. </li> <li>Cancer:    Unfortunately, Golden Retrievers have a higher incidence of cancer compared to many other breeds. Common cancers include hemangiosarcoma, osteosarcoma, and lymphoma.  Reference: Priester, W. A., &amp; Mantel, N. (1971). Occurrence of tumors in domestic animals. Data from 12 United States and Canadian colleges of veterinary medicine. Journal of the National Cancer Institute, 47(6), 1333-1344. </li> <li>Eye Disorders:    Cataracts, progressive retinal atrophy, and retinal dysplasia are some of the eye-related issues that Golden Retrievers may face.  Reference: Gelatt, K. N., &amp; Mackay, E. O. (2005). Prevalence of primary breed\u2010related cataracts in the dog in North America. Veterinary ophthalmology, 8(2), 101-111. </li> <li>Cardiac Issues:    Golden Retrievers can suffer from subvalvular aortic stenosis, a congenital heart condition.  Reference: Stern, J. A., Meurs, K. M., Nelson, O. L., Lahmers, S. M., &amp; Lehmkuhl, L. B. (2012). Familial subvalvular aortic stenosis in golden retrievers: inheritance and echocardiographic findings. Journal of Small Animal Practice, 53(4), 213-217. </li> <li>Allergies:    Skin allergies resulting from environmental triggers or food allergies can be a common issue.  Reference: Griffin, C. E., &amp; Hillier, A. (2001). The ACVD task force on canine atopic dermatitis (I): incidence and prevalence. Veterinary Immunology and Immunopathology, 81(3-4), 147-151. </li> <li>Ear Infections:    Their floppy ears make Golden Retrievers more prone to ear infections.  Reference: Saridomichelakis, M. N. (2007). Advances in the pathogenesis of canine otitis externa. Veterinary dermatology, 18(5), 300-306. </li> <li>Thyroid Disorders:    Hypothyroidism is a concern in Golden Retrievers, leading to various symptoms like lethargy, weight gain, and skin problems.  Reference: Dixon, R. M., &amp; Mooney, C. T. (1999). Canine hypothyroidism: a review of aetiology and diagnosis. New Zealand Veterinary Journal, 47(2), 47-52. </li> <li>Osteochondritis Dissecans (OCD):     This is a condition wherein the cartilage in a joint grows improperly and can lead to painful bone spurs. It typically affects the shoulders.  Reference: Olsson, S. E. (1982). Osteochondrosis in domestic animals. Acta Radiologica. Supplementum, 358, 299-306. </li> <li>Von Willebrand's Disease:     This is a blood disorder that affects the clotting process. It can cause excessive bleeding in dogs after surgery or injury.  Reference: Brooks, M. B., Erb, H. N., &amp; Foureman, P. A. (1992). von Willebrand's disease in the golden retriever: a heterogeneous group of disorders. British journal of haematology, 80(2), 251-257. </li> <li>Epilepsy:     Some Golden Retrievers can suffer from epilepsy, a neurological disorder that can cause seizures.  Reference: Berendt, M., Farquhar, R. G., Mandigers, P. J. J., Pakozdy, A., Bhatti, S. F. M., De Risio, L., ... &amp; Haagsman, A. N. (2015). International veterinary epilepsy task force consensus report on epilepsy definition, classification, and terminology in companion animals. BMC veterinary research, 11(1), 1-9. </li> <li>Pyometra:     Being a common issue in many breeds, pyometra is an infection in the uterus that can be life-threatening if not treated promptly.  Reference: Hagman, R. (2017). Pyometra in small animals. Veterinary Clinics: Small Animal Practice, 47(4), 783-805. </li> <li>Gastric Dilation-Volvulus (GDV or bloat):     This is a serious condition where the stomach fills with gas and then twists. It can be fatal if not treated immediately.  Reference: Glickman, L. T., Glickman, N. W., Schellenberg, D. B., Raghavan, M., &amp; Lee, T. L. (2000). Incidence of and breed-related risk factors for gastric dilatation-volvulus in dogs. Journal of the American Veterinary Medical Association, 216(1), 40-45. </li> <li>Skin Disorders:     Apart from allergies, Golden Retrievers can also be prone to various skin disorders, including hot spots or acute moist dermatitis.  Reference: Scott, D. W., Miller Jr, W. H., &amp; Griffin, C. E. (2001). Muller &amp; Kirk's small animal dermatology. Elsevier Health Sciences. </li> </ol> <p>B) Not breed-specific</p> <ol> <li>Heartworms: Golden Retrievers, like all dogs, are susceptible to heartworm disease. Heartworm disease is a serious disease that results in severe lung disease, heart failure, other organ damage, and death in pets, mainly dogs, cats, and ferrets. It is caused by a parasitic worm called Dirofilaria immitis. The worms are spread through the bite of a mosquito.  Reference: Atkins, C. E. (2003). Comparison of results of three commercial heartworm antigen test kits in dogs with low heartworm burdens. Journal of the American Veterinary Medical Association, 222(9), 1221-1223. </li> <li>Dental Diseases: Like other dogs, Golden Retrievers can suffer from periodontal disease, gingivitis, and other dental problems.  Reference: Harvey, C. E. (1998). Management of periodontal disease: understanding the options. Veterinary Clinics of North America: Small Animal Practice, 28(5), 1129-1147. </li> <li>Infectious Diseases: These dogs can be affected by various infectious diseases, such as parvovirus, distemper, and leptospirosis.  Reference: Decaro, N., &amp; Buonavoglia, C. (2012). Canine parvovirus\u2014a review of epidemiological and diagnostic aspects, with emphasis on type 2c. Veterinary Microbiology, 155(1), 1-12. </li> <li>Parasitic Infections: Intestinal parasites such as hookworms, roundworms, and whipworms can affect Golden Retrievers.  Reference: Bowman, D. D., Montgomery, S. P., Zajac, A. M., Eberhard, M. L., &amp; Kazacos, K. R. (2010). Hookworms of dogs and cats as agents of cutaneous larva migrans. Trends in parasitology, 26(4), 162-167. </li> <li>Cushings Disease (Hyperadrenocorticism): This endocrine disorder, where the adrenal glands produce too much cortisol, can affect Golden Retrievers among other breeds.  Reference: Galac, S., Kars, V. J., Voorhout, G., Mol, J. A., &amp; Kooistra, H. S. (2005). ACTH-independent hyperadrenocorticism due to food-dependent hypercortisolism in a dog: a case report. Veterinary Journal, 169(3), 419-422. </li> <li>Diabetes Mellitus: Not exclusive to Golden Retrievers but still a concern for many dog breeds.  Reference: Catchpole, B., Ristic, J. M., Fleeman, L. M., &amp; Davison, L. J. (2005). Canine diabetes mellitus: can old dogs teach us new tricks?. Diabetologia, 48(10), 1948-1956. </li> <li>Panosteitis: An inflammatory bone disease, sometimes referred to as \"growing pains\", can affect rapidly growing large breed dogs like Golden Retrievers.  Reference: Bennett, D., &amp; May, C. (1995). Joint diseases of dogs and cats. In Textbook of Veterinary Internal Medicine (Vol. 2, pp. 2032-2074). WB Saunders Co. </li> <li>Renal Failure: Chronic kidney disease can affect older Golden Retrievers, though it's not exclusive to the breed.  Reference: Polzin, D. J. (2011). Chronic kidney disease in small animals. Veterinary Clinics of North America: Small Animal Practice, 41(1), 15-30. </li> <li>Liver Disease: Canine liver diseases can manifest in various ways and may affect Golden Retrievers.  Reference: Center, S. A. (2007). Diseases of the gallbladder and biliary tree. Veterinary Clinics of North America: Small Animal Practice, 37(3), 537-552. </li> </ol>"},{"location":"ext_docs/sample_distance/","title":"Sample-distance","text":""},{"location":"ext_docs/sample_distance/#sample-distance-and-similarity-matrices","title":"Sample-distance and similarity matrices","text":"<p>Assessemnt of similairty between studied individual is useful to identify sample duplications or unexpected outliers. Moreover, it is critical to adjust for hidden population structure. A pairwise similarity can be calculated by counting the alleles descended from a common ancestor (i.e. Identity by descent; IBD) and/or alleles that are the same, irrespective of whether they are inherited from a recent ancestor (i.e. Identity by state; IBS).</p> <p>Pedigree information allow us to figure out the expected proportion of shared alleles by descent and thus IBD distances within families. However, the proposed pedigree is not uncommon to be wrong. With genotyping arrays and sequecning, marker information can be used to calculate IBS or IBD similarity matrices and predict the actual pedigree structure </p> <p>VanRaden (2008) and Yang et al. (2010) described the genomic relationship matrix (GRM) as a a covariance matrix which uses identical by state (IBS) information scaled by the allele frequencies, as shared rare alleles are more likely to be IBD than common alleles. These methods do not explicitly differentiate between IBD and IBS information Clark et al. (2012).</p> <p>GRM uses the minor allele frequencies (MAFs) of genotyped SNPs assuming a homogeneous population structure which is not always a true assumption. KING-robust estimation is an alternative approach that does not need MAFs. This techqniue is more trusted in mixed-population datasets (unless the parents are from very different populations).</p> <p>In the GRLS study, we can use either techqniues safely. Therefore, we will use the KING-robust kinship estimator in this tutorial. According to the PLINK2 documentation, the KING kinship coefficients are scaled such that duplicate samples have kinship 0.5.  Accordingly, first-degree relations (parent-child, full siblings) correspond to ~0.25, second-degree relations correspond to ~0.125, etc.  It is conventional to use a cutoff of ~0.354 (the geometric mean of 0.5 and 0.25) to screen for monozygotic twins and duplicate samples, ~0.177 to add first-degree relations, etc.</p>"}]}